{"ast":null,"code":"import { useState, useLayoutEffect, useEffect } from 'react';\nfunction getMentionNodes(root) {\n  if (root) {\n    const mentions = root.querySelectorAll(\"[data-sb-mention='true']\");\n    const mentionsArray = Array.from(mentions);\n    return mentionsArray;\n  }\n  return [];\n}\n\n/**\n * This is a dirty way to get the mentions given DOM node\n */\nfunction useDirtyGetMentions(_ref, _ref2) {\n  let {\n    ref\n  } = _ref;\n  let {\n    logger\n  } = _ref2;\n  // Select the node that will be observed for mutations\n  const targetNode = ref.current;\n  const [mentionNodes, setMentionNodes] = useState([]);\n\n  // to get the initial mentions\n  useLayoutEffect(() => {\n    if (targetNode) {\n      const mentions = getMentionNodes(targetNode);\n      setMentionNodes(mentions);\n    }\n  }, [targetNode]);\n  useEffect(() => {\n    // Options for the observer (which mutations to observe)\n    const config = {\n      childList: true,\n      subtree: true\n    };\n\n    // Callback function to execute when mutations are observed\n    const callback = mutationList => {\n      const hasMutation = mutationList.length > 0;\n      if (hasMutation) {\n        setMentionNodes(getMentionNodes(targetNode));\n      }\n    };\n\n    // Create an observer instance linked to the callback function\n    const observer = new MutationObserver(callback);\n    if (targetNode) {\n      // Start observing the target node for configured mutations\n      observer.observe(targetNode, config);\n      logger.info('useDirtyGetMentions: observer started', {\n        observer,\n        config\n      });\n    }\n    return () => {\n      try {\n        observer.disconnect();\n        logger.info('useDirtyGetMentions: observer disconnected', {\n          observer\n        });\n      } catch (error) {\n        logger.error('useDirtyGetMentions: observer disconnect failed', {\n          observer\n        });\n      }\n    };\n  }, [targetNode]);\n  return mentionNodes;\n}\nexport { useDirtyGetMentions as u };","map":{"version":3,"mappings":";AAAO,SAASA,eAAeA,CAACC,IAAiB,EAAa;EAC5D,IAAIA,IAAI,EAAE;IACR,MAAMC,QAAQ,GAAGD,IAAI,CAACE,gBAAgB,CAAC,0BAA0B,CAAC;IAClE,MAAMC,aAAa,GAAGC,KAAK,CAACC,IAAI,CAACJ,QAAQ,CAAC;IAC1C,OAAOE,aAAa;EACtB;EACA,OAAO,EAAE;AACX;;ACMA;AACA;AACA;AACO,SAASG,mBAAmBA,cAIlB;EAAA,IAJmB;IAClCC;EACa,CAAC;EAAA,IAAE;IAChBC;EACY,CAAC;EACb;EACA,MAAMC,UAAU,GAAGF,GAAG,CAACG,OAAsB;EAC7C,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAGC,QAAQ,CAAY,EAAE,CAAC;;EAE/D;EACAC,eAAe,CAAC,MAAM;IACpB,IAAIL,UAAU,EAAE;MACd,MAAMR,QAAQ,GAAGF,eAAe,CAACU,UAAU,CAAC;MAC5CG,eAAe,CAACX,QAAQ,CAAC;IAC3B;EACF,CAAC,EAAE,CAACQ,UAAU,CAAC,CAAC;EAEhBM,SAAS,CAAC,MAAM;IACd;IACA,MAAMC,MAAM,GAAG;MAAEC,SAAS,EAAE,IAAI;MAAEC,OAAO,EAAE;KAAM;;IAEjD;IACA,MAAMC,QAAQ,GAAIC,YAA8B,IAAW;MACzD,MAAMC,WAAW,GAAGD,YAAY,CAACE,MAAM,GAAG,CAAC;MAC3C,IAAID,WAAW,EAAE;QACfT,eAAe,CAACb,eAAe,CAACU,UAAU,CAAC,CAAC;MAC9C;KACD;;IAED;IACA,MAAMc,QAAQ,GAAG,IAAIC,gBAAgB,CAACL,QAAQ,CAAC;IAE/C,IAAIV,UAAU,EAAE;MACd;MACAc,QAAQ,CAACE,OAAO,CAAChB,UAAU,EAAEO,MAAM,CAAC;MACpCR,MAAM,CAACkB,IAAI,CAAC,uCAAuC,EAAE;QAAEH,QAAQ;QAAEP;MAAO,CAAC,CAAC;IAC5E;IAEA,OAAO,MAAM;MACX,IAAI;QACFO,QAAQ,CAACI,UAAU,EAAE;QACrBnB,MAAM,CAACkB,IAAI,CAAC,4CAA4C,EAAE;UAAEH;QAAS,CAAC,CAAC;OACxE,CAAC,OAAOK,KAAK,EAAE;QACdpB,MAAM,CAACoB,KAAK,CAAC,iDAAiD,EAAE;UAAEL;QAAS,CAAC,CAAC;MAC/E;KACD;EACH,CAAC,EAAE,CAACd,UAAU,CAAC,CAAC;EAChB,OAAOE,YAAY;AACrB","names":["getMentionNodes","root","mentions","querySelectorAll","mentionsArray","Array","from","useDirtyGetMentions","ref","logger","targetNode","current","mentionNodes","setMentionNodes","useState","useLayoutEffect","useEffect","config","childList","subtree","callback","mutationList","hasMutation","length","observer","MutationObserver","observe","info","disconnect","error"],"sources":["C:\\Users\\이경민\\IdeaProjects\\sendbird-uikit-whatsapp-sample\\node_modules\\@sendbird\\src\\modules\\Message\\utils\\getMentionNodes.ts","C:\\Users\\이경민\\IdeaProjects\\sendbird-uikit-whatsapp-sample\\node_modules\\@sendbird\\src\\modules\\Message\\hooks\\useDirtyGetMentions.ts"],"sourcesContent":["export function getMentionNodes(root: HTMLElement): Element[] {\n  if (root) {\n    const mentions = root.querySelectorAll(\"[data-sb-mention='true']\");\n    const mentionsArray = Array.from(mentions);\n    return mentionsArray;\n  }\n  return [];\n}\n","import { useEffect, useLayoutEffect, useState } from 'react';\n\nimport { Logger } from '../../../lib/SendbirdState';\nimport { getMentionNodes } from '../utils/getMentionNodes';\n\ninterface DynamicParams {\n  ref: React.RefObject<HTMLElement>;\n}\n\ninterface StaticParams {\n  logger: Logger;\n}\n\n/**\n * This is a dirty way to get the mentions given DOM node\n */\nexport function useDirtyGetMentions({\n  ref,\n}: DynamicParams, {\n  logger,\n}: StaticParams) {\n  // Select the node that will be observed for mutations\n  const targetNode = ref.current as HTMLElement;\n  const [mentionNodes, setMentionNodes] = useState<Element[]>([]);\n\n  // to get the initial mentions\n  useLayoutEffect(() => {\n    if (targetNode) {\n      const mentions = getMentionNodes(targetNode);\n      setMentionNodes(mentions);\n    }\n  }, [targetNode]);\n\n  useEffect(() => {\n    // Options for the observer (which mutations to observe)\n    const config = { childList: true, subtree: true };\n\n    // Callback function to execute when mutations are observed\n    const callback = (mutationList: MutationRecord[]): void => {\n      const hasMutation = mutationList.length > 0;\n      if (hasMutation) {\n        setMentionNodes(getMentionNodes(targetNode));\n      }\n    };\n\n    // Create an observer instance linked to the callback function\n    const observer = new MutationObserver(callback);\n\n    if (targetNode) {\n      // Start observing the target node for configured mutations\n      observer.observe(targetNode, config);\n      logger.info('useDirtyGetMentions: observer started', { observer, config });\n    }\n\n    return () => {\n      try {\n        observer.disconnect();\n        logger.info('useDirtyGetMentions: observer disconnected', { observer });\n      } catch (error) {\n        logger.error('useDirtyGetMentions: observer disconnect failed', { observer });\n      }\n    };\n  }, [targetNode]);\n  return mentionNodes;\n}\n"]},"metadata":{},"sourceType":"module"}