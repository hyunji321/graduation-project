{"ast":null,"code":"import { useState, useEffect } from 'react';\nimport { u as useVoicePlayerContext, A as AudioUnitDefaultValue } from '../index-5c985608.js';\nimport { g as VOICE_PLAYER_AUDIO_ID } from '../consts-95d8566e.js';\nimport { useVoiceRecorderContext } from '../VoiceRecorder/context.js';\nimport '../_rollupPluginBabelHelpers-6bb0305c.js';\nimport '../useSendbirdStateContext.js';\nimport '../withSendbird.js';\nconst generateGroupKey = function () {\n  let channelUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  let key = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  return `${channelUrl}-${key}`;\n};\nconst useVoicePlayer = _ref => {\n  var _voicePlayerStore$aud;\n  let {\n    key = '',\n    channelUrl = '',\n    audioFile = null,\n    audioFileUrl = ''\n  } = _ref;\n  const [groupKey] = useState(generateGroupKey(channelUrl, key));\n  const {\n    play,\n    pause,\n    stop,\n    voicePlayerStore\n  } = useVoicePlayerContext();\n  const {\n    isRecordable\n  } = useVoiceRecorderContext();\n  const currentAudioUnit = (voicePlayerStore === null || voicePlayerStore === void 0 ? void 0 : (_voicePlayerStore$aud = voicePlayerStore.audioStorage) === null || _voicePlayerStore$aud === void 0 ? void 0 : _voicePlayerStore$aud[groupKey]) || AudioUnitDefaultValue();\n  const playVoicePlayer = () => {\n    if (!isRecordable) {\n      play === null || play === void 0 ? void 0 : play({\n        groupKey,\n        audioFile,\n        audioFileUrl\n      });\n    }\n  };\n  const pauseVoicePlayer = () => {\n    pause === null || pause === void 0 ? void 0 : pause(groupKey);\n  };\n  const stopVoicePlayer = function () {\n    let text = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    stop === null || stop === void 0 ? void 0 : stop(text);\n  };\n  useEffect(() => {\n    return () => {\n      if (audioFile || audioFileUrl) {\n        var _pause, _ref2;\n        // Can't get the current AudioPlayer through the React hooks(useReducer or useState) in this scope\n        const voiceAudioPlayerElement = document.getElementById(VOICE_PLAYER_AUDIO_ID);\n        voiceAudioPlayerElement === null || voiceAudioPlayerElement === void 0 ? void 0 : (_pause = (_ref2 = voiceAudioPlayerElement).pause) === null || _pause === void 0 ? void 0 : _pause.call(_ref2);\n      }\n    };\n  }, []);\n  return {\n    play: playVoicePlayer,\n    pause: pauseVoicePlayer,\n    stop: stopVoicePlayer,\n    playbackTime: currentAudioUnit.playbackTime * 1000,\n    duration: currentAudioUnit.duration * 1000,\n    // the unit of playbackTime and duration should be millisecond\n    playingStatus: currentAudioUnit.playingStatus\n  };\n};\nexport { useVoicePlayer };","map":{"version":3,"mappings":";;;;;;;AACO,MAAMA,gBAAgB,GAAG;EAAA,IAACC,UAAU,uEAAG,EAAE;EAAA,IAAEC,GAAG,uEAAG,EAAE;EAAA,OAAmBD,aAAcC,OAAK;AAAA,CAAC;ACuBpFC,oBAAc,GAAGC,QAKoB;EAAA;EAAA,IALnB;IAC7BF,GAAG,GAAG,EAAE;IACRD,UAAU,GAAG,EAAE;IACfI,SAAS,GAAG,IAAI;IAChBC,YAAY,GAAG;EACI,CAAC;EACpB,MAAM,CAACC,QAAQ,CAAC,GAAGC,QAAQ,CAASR,gBAAgB,CAACC,UAAU,EAAEC,GAAG,CAAC,CAAC;EACtE,MAAM;IACJO,IAAI;IACJC,KAAK;IACLC,IAAI;IACJC;GACD,GAAGC,qBAAqB,EAAE;EAC3B,MAAM;IAAEC;GAAc,GAAGC,uBAAuB,EAAE;EAClD,MAAMC,gBAAgB,GAAG,iBAAgB,aAAhBJ,gBAAgB,gDAAhBA,gBAAgB,CAAEK,YAAY,wCAA9BC,wCAAiCX,QAAQ,CAAC,KAAIY,qBAAqB,EAAE;EAE9F,MAAMC,eAAe,GAAGA,MAAM;IAC5B,IAAI,CAACN,YAAY,EAAE;MACjBL,IAAI,KAAJA,YAAI,KAAJA,sBAAI,CAAG;QACLF,QAAQ;QACRF,SAAS;QACTC;MACF,CAAC,CAAC;IACJ;GACD;EAED,MAAMe,gBAAgB,GAAGA,MAAM;IAC7BX,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAGH,QAAQ,CAAC;GAClB;EAED,MAAMe,eAAe,GAAG,YAAe;IAAA,IAAdC,IAAI,uEAAG,EAAE;IAChCZ,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAGY,IAAI,CAAC;GACb;EAEDC,SAAS,CAAC,MAAM;IACd,OAAO,MAAM;MACX,IAAInB,SAAS,IAAIC,YAAY,EAAE;QAAA;QAC7B;QACA,MAAMmB,uBAAuB,GAAGC,QAAQ,CAACC,cAAc,CAACC,qBAAqB,CAAC;QAC7EH,uBAAuB,aAAvBA,uBAAuB,iCAAxB,SAACA,uBAAuB,EAAuBf,KAAK,yBAApDmB,oCAAwD;MAC1D;KACD;GACF,EAAE,EAAE,CAAC;EAEN,OAAQ;IACNpB,IAAI,EAAEW,eAAe;IACrBV,KAAK,EAAEW,gBAAgB;IACvBV,IAAI,EAAEW,eAAe;IACrBQ,YAAY,EAAEd,gBAAgB,CAACc,YAAY,GAAG,IAAI;IAClDC,QAAQ,EAAEf,gBAAgB,CAACe,QAAQ,GAAG,IAAI;IAC1C;IACAC,aAAa,EAAEhB,gBAAgB,CAACgB;GACjC;AACH","names":["generateGroupKey","channelUrl","key","useVoicePlayer","_ref","audioFile","audioFileUrl","groupKey","useState","play","pause","stop","voicePlayerStore","useVoicePlayerContext","isRecordable","useVoiceRecorderContext","currentAudioUnit","audioStorage","_voicePlayerStore$aud","AudioUnitDefaultValue","playVoicePlayer","pauseVoicePlayer","stopVoicePlayer","text","useEffect","voiceAudioPlayerElement","document","getElementById","VOICE_PLAYER_AUDIO_ID","_pause","playbackTime","duration","playingStatus"],"sources":["C:\\Users\\이경민\\IdeaProjects\\sendbird-uikit-whatsapp-sample\\node_modules\\@sendbird\\src\\hooks\\VoicePlayer\\utils.ts","C:\\Users\\이경민\\IdeaProjects\\sendbird-uikit-whatsapp-sample\\node_modules\\@sendbird\\src\\hooks\\VoicePlayer\\useVoicePlayer.tsx"],"sourcesContent":["export type GroupKey = string;\nexport const generateGroupKey = (channelUrl = '', key = ''): GroupKey => (`${channelUrl}-${key}`);\n","import { useEffect, useState } from 'react';\nimport { useVoicePlayerContext } from '.';\nimport { VOICE_PLAYER_AUDIO_ID } from '../../utils/consts';\nimport { useVoiceRecorderContext } from '../VoiceRecorder';\n\nimport { AudioUnitDefaultValue, VoicePlayerStatusType } from './dux/initialState';\nimport { generateGroupKey } from './utils';\n\nexport interface UseVoicePlayerProps {\n  key: string;\n  channelUrl: string;\n  audioFile?: File;\n  audioFileUrl?: string;\n}\n\nexport interface UseVoicePlayerContext {\n  play: () => void;\n  pause: () => void;\n  stop: (text?: string) => void;\n  playbackTime: number;\n  duration: number;\n  playingStatus: VoicePlayerStatusType;\n}\n\nexport const useVoicePlayer = ({\n  key = '',\n  channelUrl = '',\n  audioFile = null,\n  audioFileUrl = '',\n}: UseVoicePlayerProps): UseVoicePlayerContext => {\n  const [groupKey] = useState<string>(generateGroupKey(channelUrl, key));\n  const {\n    play,\n    pause,\n    stop,\n    voicePlayerStore,\n  } = useVoicePlayerContext();\n  const { isRecordable } = useVoiceRecorderContext();\n  const currentAudioUnit = voicePlayerStore?.audioStorage?.[groupKey] || AudioUnitDefaultValue();\n\n  const playVoicePlayer = () => {\n    if (!isRecordable) {\n      play?.({\n        groupKey,\n        audioFile,\n        audioFileUrl,\n      });\n    }\n  };\n\n  const pauseVoicePlayer = () => {\n    pause?.(groupKey);\n  };\n\n  const stopVoicePlayer = (text = '') => {\n    stop?.(text);\n  };\n\n  useEffect(() => {\n    return () => {\n      if (audioFile || audioFileUrl) {\n        // Can't get the current AudioPlayer through the React hooks(useReducer or useState) in this scope\n        const voiceAudioPlayerElement = document.getElementById(VOICE_PLAYER_AUDIO_ID);\n        (voiceAudioPlayerElement as HTMLAudioElement)?.pause?.();\n      }\n    };\n  }, []);\n\n  return ({\n    play: playVoicePlayer,\n    pause: pauseVoicePlayer,\n    stop: stopVoicePlayer,\n    playbackTime: currentAudioUnit.playbackTime * 1000,\n    duration: currentAudioUnit.duration * 1000,\n    // the unit of playbackTime and duration should be millisecond\n    playingStatus: currentAudioUnit.playingStatus,\n  });\n};\n"]},"metadata":{},"sourceType":"module"}