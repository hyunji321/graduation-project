var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};function t(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};function r(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function i(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function o(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function s(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function a(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function c(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var u,l="4.9.0",h=function(){function e(){}return Object.defineProperty(e,"OS_VERSION",{get:function(){return"undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"noAgent"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_VERSION",{get:function(){return l},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_MAJOR_VERSION",{get:function(){return e.SDK_VERSION.split(".")[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL",{get:function(){return 100},enumerable:!1,configurable:!0}),Object.defineProperty(e,"INTERNAL_CALL",{get:function(){return"ic"},enumerable:!1,configurable:!0}),e}();!function(e){e[e.STAT_LOG_NOT_ALLOWED=400108]="STAT_LOG_NOT_ALLOWED",e[e.NON_AUTHORIZED=400108]="NON_AUTHORIZED",e[e.INVALID_TOKEN=400111]="INVALID_TOKEN",e[e.NOT_FOUND_IN_DATABASE=400201]="NOT_FOUND_IN_DATABASE",e[e.SESSION_TOKEN_EXPIRED=400302]="SESSION_TOKEN_EXPIRED",e[e.SESSION_KEY_EXPIRED=400309]="SESSION_KEY_EXPIRED",e[e.SESSION_REVOKED=400310]="SESSION_REVOKED",e[e.STAT_UPLOAD_NOT_ALLOWED=403200]="STAT_UPLOAD_NOT_ALLOWED",e[e.INTERNAL_SERVER_ERROR=500901]="INTERNAL_SERVER_ERROR",e[e.RATE_LIMIT_EXCEEDED=500910]="RATE_LIMIT_EXCEEDED",e[e.UNKNOWN_SERVER_ERROR=900200]="UNKNOWN_SERVER_ERROR",e[e.DEBUG_MODE_REQUIRED=7e5]="DEBUG_MODE_REQUIRED",e[e.LOST_INSTANCE=700100]="LOST_INSTANCE",e[e.CONNECTION_RENEW=700102]="CONNECTION_RENEW",e[e.INVALID_CONNECTION_STATE_TRANSITION=700200]="INVALID_CONNECTION_STATE_TRANSITION",e[e.INVALID_INITIALIZATION=800100]="INVALID_INITIALIZATION",e[e.CONNECTION_REQUIRED=800101]="CONNECTION_REQUIRED",e[e.CONNECTION_CANCELED=800102]="CONNECTION_CANCELED",e[e.INVALID_PARAMETER=800110]="INVALID_PARAMETER",e[e.NOT_SUPPORTED_ERROR=800111]="NOT_SUPPORTED_ERROR",e[e.NETWORK_ERROR=800120]="NETWORK_ERROR",e[e.NETWORK_ROUTING_ERROR=800121]="NETWORK_ROUTING_ERROR",e[e.MALFORMED_DATA=800130]="MALFORMED_DATA",e[e.MALFORMED_ERROR_DATA=800140]="MALFORMED_ERROR_DATA",e[e.WRONG_CHANNEL_TYPE=800150]="WRONG_CHANNEL_TYPE",e[e.MARK_AS_READ_RATE_LIMIT_EXCEEDED=800160]="MARK_AS_READ_RATE_LIMIT_EXCEEDED",e[e.QUERY_IN_PROGRESS=800170]="QUERY_IN_PROGRESS",e[e.ACK_TIMEOUT=800180]="ACK_TIMEOUT",e[e.LOGIN_TIMEOUT=800190]="LOGIN_TIMEOUT",e[e.WEBSOCKET_CONNECTION_CLOSED=800200]="WEBSOCKET_CONNECTION_CLOSED",e[e.WEBSOCKET_CONNECTION_FAILED=800210]="WEBSOCKET_CONNECTION_FAILED",e[e.REQUEST_FAILED=800220]="REQUEST_FAILED",e[e.FILE_UPLOAD_CANCEL_FAILED=800230]="FILE_UPLOAD_CANCEL_FAILED",e[e.REQUEST_CANCELED=800240]="REQUEST_CANCELED",e[e.REQUEST_DUPLICATED=800250]="REQUEST_DUPLICATED",e[e.FILE_SIZE_LIMIT_EXCEEDED=800260]="FILE_SIZE_LIMIT_EXCEEDED",e[e.SESSION_TOKEN_REQUEST_FAILED=800500]="SESSION_TOKEN_REQUEST_FAILED",e[e.SESSION_TOKEN_REFRESHED=800501]="SESSION_TOKEN_REFRESHED",e[e.SESSION_TOKEN_REFRESH_FAILED=800502]="SESSION_TOKEN_REFRESH_FAILED",e[e.COLLECTION_DISPOSED=800600]="COLLECTION_DISPOSED",e[e.DATABASE_ERROR=800700]="DATABASE_ERROR"}(u||(u={}));var d,_,f,p,g,v=function(e){return!(e instanceof E&&!e.shouldThrowOutside)},E=function(e){function n(t){var r=t.code,i=void 0===r?0:r,o=t.message,s=void 0===o?"":o,a=e.call(this,s)||this;return a.shouldThrowOutside=!1,a.name="SendbirdError",a.code=i,Object.setPrototypeOf(a,n.prototype),a}return t(n,e),Object.defineProperty(n.prototype,"isInvalidTokenError",{get:function(){return this.code===u.INVALID_TOKEN},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSessionTokenExpiredError",{get:function(){return this.code===u.SESSION_TOKEN_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSessionKeyExpiredError",{get:function(){return this.code===u.SESSION_KEY_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSessionRevokedError",{get:function(){return this.code===u.SESSION_REVOKED},enumerable:!1,configurable:!0}),Object.defineProperty(n,"debugModeRequired",{get:function(){return new n({code:u.DEBUG_MODE_REQUIRED,message:"Cannot run this operation in production mode."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"lostInstance",{get:function(){return new n({code:u.LOST_INSTANCE,message:"Instance ID is missing. It should belong to an instance."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"connectionRenew",{get:function(){return new n({code:u.CONNECTION_RENEW,message:"Connection restarts."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"invalidConnectionStateTransition",{get:function(){return new n({code:u.INVALID_CONNECTION_STATE_TRANSITION,message:"Invalid connection state transition."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"connectionRequired",{get:function(){return new n({code:u.CONNECTION_REQUIRED,message:"Connection is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"connectionCanceled",{get:function(){return new n({code:u.CONNECTION_CANCELED,message:"Connection is canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"invalidParameters",{get:function(){return new n({code:u.INVALID_PARAMETER,message:"Invalid parameters."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"notSupportedError",{get:function(){return new n({code:u.NOT_SUPPORTED_ERROR,message:"Given parameters are not supported."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"networkError",{get:function(){return new n({code:u.NETWORK_ERROR,message:"There was a network error."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"markAsReadAllRateLimitExceeded",{get:function(){return new n({code:u.MARK_AS_READ_RATE_LIMIT_EXCEEDED,message:"markAsRead rate limit exceeded."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"queryInProgress",{get:function(){return new n({code:u.QUERY_IN_PROGRESS,message:"Query in progress."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"noAckTimeout",{get:function(){return new n({code:u.ACK_TIMEOUT,message:"Command received no ack."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"loginTimeout",{get:function(){return new n({code:u.LOGIN_TIMEOUT,message:"Connection timeout."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"connectionClosed",{get:function(){return new n({code:u.WEBSOCKET_CONNECTION_CLOSED,message:"Connection is closed. Please reconnect."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"requestFailed",{get:function(){return new n({code:u.REQUEST_FAILED,message:"Request failed."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"fileUploadCanceled",{get:function(){return new n({code:u.FILE_UPLOAD_CANCEL_FAILED,message:"File upload has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"requestCanceled",{get:function(){return new n({code:u.REQUEST_CANCELED,message:"Request has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"sessionTokenRefreshFailed",{get:function(){return new n({code:u.SESSION_TOKEN_REFRESH_FAILED,message:"Failed to refresh the session key."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"sessionTokenRequestFailed",{get:function(){return new n({code:u.SESSION_TOKEN_REQUEST_FAILED,message:"Failed to get the session token."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"databaseError",{get:function(){return new n({code:u.DATABASE_ERROR,message:"Database error."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"fileSizeLimitExceededError",{get:function(){return new n({code:u.FILE_SIZE_LIMIT_EXCEEDED,message:"File size exceeds the file size limit."})},enumerable:!1,configurable:!0}),n.prototype.throwOutside=function(){throw this.shouldThrowOutside=!0,this},n}(Error),b=[u.CONNECTION_REQUIRED,u.NETWORK_ERROR,u.ACK_TIMEOUT,u.WEBSOCKET_CONNECTION_CLOSED,u.WEBSOCKET_CONNECTION_FAILED,u.FILE_UPLOAD_CANCEL_FAILED,u.REQUEST_CANCELED,u.INTERNAL_SERVER_ERROR,u.RATE_LIMIT_EXCEEDED,u.UNKNOWN_SERVER_ERROR],m=[u.WEBSOCKET_CONNECTION_CLOSED,u.WEBSOCKET_CONNECTION_FAILED,u.CONNECTION_REQUIRED],y=function(e,t){if(e!==t){var r=n({},e),i=n({},t);return(!r.hasOwnProperty("messageId")||!i.hasOwnProperty("messageId")||r.messageId===i.messageId)&&((!r.hasOwnProperty("reqId")||!i.hasOwnProperty("reqId")||r.reqId===i.reqId)&&(r.hasOwnProperty("messageId")&&delete r.messageId,r.hasOwnProperty("reqId")&&delete r.reqId,i.hasOwnProperty("messageId")&&delete i.messageId,i.hasOwnProperty("reqId")&&delete i.reqId,JSON.stringify(r)===JSON.stringify(i)))}return!0},w=function(e,t,n){return void 0===n&&(n=!1),!(!n||null!=t)||("string"!=typeof e?"object"==typeof e?S(e,t):k(e,t):typeof t===e)},S=function(e,t,n){return void 0===n&&(n=!1),!(!n||null!=t)||Object.values(e).includes(t)},k=function(e,t){return t instanceof e},T=function(e,t,n){return void 0===n&&(n=!1),!(!n||null!=t)||Array.isArray(t)&&t.every((function(t){return w(e,t)}))},C=function(e){return e>0&&b.indexOf(e)>=0},O=function(e){return e>0&&m.indexOf(e)>=0},A=function(e,t){if(void 0===t&&(t=!1),t&&null===e)return!0;var n=w("object",e)&&null!==e&&e.hasOwnProperty("name")&&"string"==typeof e.name&&e.hasOwnProperty("uri")&&"string"==typeof e.uri&&e.hasOwnProperty("type")&&"string"==typeof e.type;if(!n){if("undefined"!=typeof Blob)return e instanceof Blob;if("undefined"!=typeof File)return e instanceof File}return n},N=function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=c([],a(e),!1).sort(),r=c([],a(t),!1).sort(),i=0;i<n.length;++i)if(n[i]!==r[i])return!1;return!0},I=function(){function e(e){var t=void 0===e?{}:e,n=t.useMemberInfoInMessage,r=void 0===n||n,i=t.typingIndicatorInvalidateTime,o=void 0===i?1e4:i,s=t.typingIndicatorThrottle,a=void 0===s?1e3:s,c=t.websocketResponseTimeout,u=void 0===c?1e4:c,l=t.websocketPayloadDecompression,h=void 0===l||l,d=t.sessionTokenRefreshTimeout,_=void 0===d?60:d;this._useMemberInfoInMessage=!0,this._typingIndicatorInvalidateTime=1e4,this._typingIndicatorThrottle=1e3,this._websocketResponseTimeout=1e4,this._sessionTokenRefreshTimeout=60,this._useMemberInfoInMessage=r,this._typingIndicatorInvalidateTime=o,this._typingIndicatorThrottle=a,this._websocketResponseTimeout=u,this._sessionTokenRefreshTimeout=_,this.websocketPayloadDecompression=h}return Object.defineProperty(e.prototype,"useMemberInfoInMessage",{get:function(){return this._useMemberInfoInMessage},set:function(e){w("boolean",e)&&(this._useMemberInfoInMessage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typingIndicatorInvalidateTime",{get:function(){return this._typingIndicatorInvalidateTime},set:function(e){w("number",e)&&(this._typingIndicatorInvalidateTime=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typingIndicatorThrottle",{get:function(){return this._typingIndicatorThrottle},set:function(e){w("number",e)&&e>=1e3&&e<=9e3&&(this._typingIndicatorThrottle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"websocketResponseTimeout",{get:function(){return this._websocketResponseTimeout},set:function(e){w("number",e)&&e>=5e3&&e<=3e4&&(this._websocketResponseTimeout=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionTokenRefreshTimeout",{get:function(){return this._sessionTokenRefreshTimeout},set:function(e){w("number",e)&&(e<60?e=60:e>1800&&(e=1800),this._sessionTokenRefreshTimeout=e)},enumerable:!1,configurable:!0}),e}(),R={encrypt:function(e){return e},decrypt:function(e){return e}},D=function(){function e(e){var t=e.store;this._preference=new Map,this._store=t}return e.prototype._savePreferenceKeys=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,this._store.set({key:this._keysAddress,value:c([],a(this._preference.keys()),!1)})];case 1:return e.sent(),[2]}}))}))},e.prototype.init=function(e,t){var n;return void 0===t&&(t=1),i(this,void 0,void 0,(function(){var r,i,a,c,u,l,h,d,_,f;return o(this,(function(o){switch(o.label){case 0:return this._version=t,this._keysAddress=e,r="".concat(e,".metadata.version"),[4,this._store.get(r)];case 1:return i=o.sent(),[4,this._store.get(e)];case 2:return a=null!==(n=o.sent())&&void 0!==n?n:[],!i||i.version<this._version?[4,this._resetPreferenceData(a,r)]:[3,4];case 3:return o.sent(),[3,11];case 4:o.trys.push([4,9,10,11]),c=s(a),u=c.next(),o.label=5;case 5:return u.done?[3,8]:(l=u.value,[4,this._store.get(l)]);case 6:(h=o.sent())&&this._preference.set(l,h),o.label=7;case 7:return u=c.next(),[3,5];case 8:return[3,11];case 9:return d=o.sent(),_={error:d},[3,11];case 10:try{u&&!u.done&&(f=c.return)&&f.call(c)}finally{if(_)throw _.error}return[7];case 11:return[2]}}))}))},e.prototype._resetPreferenceData=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return this._preference=new Map,[4,this._store.removeMany(e)];case 1:return n.sent(),[4,this._store.set({key:t,value:{version:this._version}})];case 2:return n.sent(),[2]}}))}))},e.prototype.get=function(e){var t;return i(this,void 0,void 0,(function(){return o(this,(function(n){return[2,null!==(t=this._preference.get(e))&&void 0!==t?t:null]}))}))},e.prototype.set=function(e,t){return i(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return n=!this._preference.has(e),[4,this._store.set({key:e,value:t})];case 1:return r.sent(),this._preference.set(e,t),n?[4,this._savePreferenceKeys()]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},e.prototype.remove=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this._store.remove(e)];case 1:return t.sent(),this._preference.delete(e),[4,this._savePreferenceKeys()];case 2:return t.sent(),[2]}}))}))},e.prototype.clear=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,this._store.removeMany(c([],a(this._preference.keys()),!1))];case 1:return e.sent(),this._preference.clear(),[4,this._savePreferenceKeys()];case 2:return e.sent(),[2]}}))}))},e}(),L=function(){function e(e){var t=e.encryption,n=void 0===t?null:t,r=e.store,i=void 0===r?null:r,o=e.localCacheEnabled,s=void 0===o||o,a=e.localCacheConfig,c=void 0===a?null:a;this.nestdb=null,this.store=i,this.preference=new D({store:i}),this.encryption=null!=n?n:R,this.localCacheEnabled=s,this.localCacheConfig=c}return e.prototype.replaceStore=function(e){this.store=e,this.preference=new D({store:e})},e}();!function(e){e.SUCCESS="success",e.PENDING="pending",e.ERROR="error"}(d||(d={})),function(e){e.DEFAULT="default",e.ALL="all",e.MENTION_ONLY="mention_only",e.OFF="off"}(_||(_={})),function(e){e.FCM="gcm",e.APNS="apns",e.UNKNOWN="unknown"}(f||(f={})),function(e){e.ALTERNATIVE="alternative",e.DEFAULT="default"}(p||(p={})),function(e){e.CUSTOM="custom",e.MESSAGE_COLLECTION_ACCESSED_AT="messagecollection_accessed_at"}(g||(g={}));var x,M,P,U,z,F,q,G,j,K=function(){function e(e){var t=e.channel,n=e.cachedMessageCount;this._channel=null,this._cachedMessageCount=0,this._channel=t,this._cachedMessageCount=n}return Object.defineProperty(e.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cachedMessageCount",{get:function(){return this._cachedMessageCount},enumerable:!1,configurable:!0}),e}(),B=function(){function e(e){var t=void 0===e?{}:e,n=t.maxSize,r=void 0===n?256:n,i=t.clearOrder,o=void 0===i?g.MESSAGE_COLLECTION_ACCESSED_AT:i,s=t.customClearOrderComparator,a=void 0===s?null:s;this._customClearOrderComparator=null,this._clearOrderComparatorUseMessageCollectionAccessedAt=function(e,t){return e.channel.messageCollectionLastAccessedAt===t.channel.messageCollectionLastAccessedAt?e.channel.lastMessage&&!t.channel.lastMessage?1:!e.channel.lastMessage&&t.channel.lastMessage?-1:e.channel.lastMessage.createdAt-t.channel.lastMessage.createdAt:e.channel.messageCollectionLastAccessedAt>t.channel.messageCollectionLastAccessedAt?1:-1},this._maxSize=Math.max(r,64),a?(this._clearOrder=o,this._customClearOrderComparator=a):this._clearOrder=g.MESSAGE_COLLECTION_ACCESSED_AT}return Object.defineProperty(e.prototype,"maxSize",{get:function(){return this._maxSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clearOrder",{get:function(){return this._clearOrder},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clearOrderComparator",{get:function(){var e;return this._clearOrder===g.MESSAGE_COLLECTION_ACCESSED_AT?this._clearOrderComparatorUseMessageCollectionAccessedAt:null!==(e=this._customClearOrderComparator)&&void 0!==e?e:this._clearOrderComparatorUseMessageCollectionAccessedAt},enumerable:!1,configurable:!0}),e}(),Z=function(){function e(){this.sessionKey=null,this.authToken=null}return Object.defineProperty(e.prototype,"hasSession",{get:function(){return!!this.sessionKey},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this.authToken=null,this.sessionKey=null},e}(),V=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))},H=function(){function e(e){var t=e.container;this._container={},this._container=t,this.key=V()}return e.prototype._register=function(e,t,n){return e in this._container||(this._container[e]=new Map),this._container[e].set(this.key,{occurence:t,handler:n}),this},e.prototype.on=function(e,t){return this._register(e,-1,t)},e.prototype.once=function(e,t){return this._register(e,1,t)},e.prototype.close=function(){for(var e in this._container)this._container[e].delete(this.key)},e}(),W=function(){function e(){this._container={}}return e.prototype.on=function(e,t){return new H({container:this._container}).on(e,t)},e.prototype.once=function(e,t){return new H({container:this._container}).once(e,t)},e.prototype.dispatch=function(e,t){var n,r,i=this._container[e];if(i){var o=[];try{for(var a=s(i.keys()),c=a.next();!c.done;c=a.next()){var u=c.value,l=i.get(u);l.handler(t),l.occurence>0&&(l.occurence--,0===l.occurence&&o.push(u))}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}o.forEach((function(e){return i.delete(e)}))}},e}(),Q=function(){function e(){this._dispatcher=new W}return e.prototype.on=function(e){return this._dispatcher.on("event",e)},e.prototype.once=function(e){return this._dispatcher.once("event",e)},e.prototype.dispatch=function(e){this._dispatcher.dispatch("event",e)},e}(),Y=function(){},X=function(e){var t={};return e&&Object.keys(e).forEach((function(n){void 0===e[n]||Number.isNaN(e[n])||null===e[n]||(t[n]=e[n])})),t};!function(e){e.BASE="base",e.GROUP="group",e.OPEN="open"}(x||(x={})),function(e){e.OPERATOR="operator",e.NONE="none"}(M||(M={})),function(e){e.BASE="base",e.USER="user",e.FILE="file",e.ADMIN="admin"}(P||(P={})),function(e){e.ALL="",e.USER="MESG",e.FILE="FILE",e.ADMIN="ADMM"}(U||(U={})),function(e){e.USER="MESG",e.FILE="FILE",e.ADMIN="ADMM"}(z||(z={})),function(e){e.USERS="users",e.CHANNEL="channel"}(F||(F={})),function(e){e.ALL="all",e.NONE="none",e.ONLY_REPLY_TO_CHANNEL="only_reply_to_channel"}(q||(q={})),function(e){e.DEFAULT="default",e.SUPPRESS="suppress"}(G||(G={})),function(e){e.PENDING="pending",e.SCHEDULED="scheduled",e.SUCCEEDED="succeeded",e.FAILED="failed",e.CANCELED="canceled"}(j||(j={}));var J,$="v3",ee="/".concat($,"/users"),te="/".concat($,"/storage/file"),ne="/".concat($,"/group_channels"),re="/".concat($,"/sdk/group_channels"),ie="/".concat($,"/open_channels"),oe="/".concat($,"/sdk/open_channels"),se="/".concat($,"/search"),ae="/".concat($,"/report"),ce="/".concat($,"/emojis"),ue="/".concat($,"/emoji_categories"),le="/".concat($,"/polls"),he="/".concat($,"/scheduled_messages"),de="/".concat($,"/sdk/ui_kit/configuration"),_e="/".concat($,"/sdk/statistics"),fe=function(e){switch(e){case x.GROUP:return ne;case x.OPEN:return ie;default:return null}},pe=function(e){switch(e){case x.GROUP:return"".concat(ae,"/group_channels");case x.OPEN:return"".concat(ae,"/open_channels");default:return null}},ge=function(e,t,n){var r,i;switch(e){case F.CHANNEL:return!0;case F.USERS:if(t)try{for(var o=s(t),a=o.next();!a.done;a=o.next()){if(a.value===n)return!0}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}}return!1},ve=function(e,t,n){var r=ge(e.mentionType,e.mentionedUserIds,n),i=ge(t.mentionType,t.mentionedUserIds,n);return!r&&i?1:r&&!i?-1:0},Ee=function(e,t,n){var r,i=t||new FormData;for(var o in e)if(o in e){var s=e[o],a=n?"".concat(n,"[").concat(o,"]"):o;A(s)?i.append(a,s,null!==(r=s.name)&&void 0!==r?r:"filename"):"object"!=typeof s||null===s||Array.isArray(s)||s instanceof Blob?i.append(a,String(s)):i=Ee(s,i,a)}return i};!function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(J||(J={}));var be,me=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.params={},t.requireAuth=!0,t.headers={},t.requestId=V(),t}return t(n,e),n.prototype.encodeParams=function(e){var t=this;return null==e||""===e?encodeURIComponent(""):Array.isArray(e)?e.map((function(e){return t.encodeParams(e)})).join(","):"object"==typeof e?encodeURIComponent(JSON.stringify(e)):encodeURIComponent(String(e))},Object.defineProperty(n.prototype,"query",{get:function(){var e=this,t=X(this.params);return"?".concat(Object.keys(t).map((function(n){return"".concat(encodeURIComponent(n),"=").concat(e.encodeParams(t[n]))})).join("&"))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"payload",{get:function(){var e=X(this.params);return Object.keys(e).some((function(t){return A(e[t])}))?Ee(e):JSON.stringify(e)},enumerable:!1,configurable:!0}),n}(Y),ye=function(e){function r(t,n){var r=e.call(this)||this;return r._iid=t,r._payload=n,r}return t(r,e),Object.defineProperty(r.prototype,"payload",{get:function(){return n({},this._payload)},enumerable:!1,configurable:!0}),r.prototype.as=function(e){return new e(this._iid,this.payload)},r}(Y),we=function(e){function n(t){var n=e.call(this)||this;return n.requestId=t,n}return t(n,e),n}(Y),Se=function(e){function n(t){var n=t.expires_in,r=t.reason,i=void 0===r?u.SESSION_KEY_EXPIRED:r,o=e.call(this)||this;switch(o.expiresIn=null!=n?n:0,i){case u.SESSION_KEY_EXPIRED:case u.SESSION_TOKEN_EXPIRED:case u.SESSION_REVOKED:o.error=new E({code:i})}return o}return t(n,e),Object.defineProperty(n.prototype,"invalidateSessionToken",{get:function(){var e;return null===(e=this.error)||void 0===e?void 0:e.isSessionTokenExpiredError},enumerable:!1,configurable:!0}),n}(Y),ke=function(e){function n(t){var n=e.call(this)||this;return n.statLog=t,n}return t(n,e),n}(Y);!function(e){e.FEATURE_LOCALCACHE="feature:local_cache",e.WEBSOCKET_CONNECT="ws:connect",e.API_RESULT="api:result"}(be||(be={}));var Te=function(){function e(e){var t=e.type,n=e.data,r=e.ts,i=void 0===r?Date.now():r;this.type=t,this.createdAt=i,this.data=n}return e.payloadify=function(e){return X({stat_type:e.type,ts:e.createdAt,data:X(e.data)})},e}(),Ce=function(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"==navigator.product},Oe=function(){function e(e,t){var n=t.auth,r=t.sdkState,i=t.dispatcher,o=t.logger,s=t.useFetchCompat,a=void 0!==s&&s,c=this;this._abortControl=new Map,this._shouldImportFetchCompat=!1,this._iid=e,this._auth=n,this._sdkState=r,this._dispatcher=i,this._dispatcher.on((function(e){e instanceof we&&c.cancel(e.requestId)})),this._logger=o,this._shouldImportFetchCompat=a}return Object.defineProperty(e.prototype,"_userAgentWithExtension",{get:function(){var e=this._sdkState.extensions,t=Ce()?"reactnative":"JS",n=e.sb_syncmanager?"s".concat(e.sb_syncmanager):"",r=e.sb_uikit?"u".concat(e.sb_uikit):"",i=e["device-os-platform"]?"o".concat(e["device-os-platform"]):"";return"".concat(t,"/c").concat(h.SDK_VERSION,"/").concat(n,"/").concat(r,"/").concat(i)},enumerable:!1,configurable:!0}),e.prototype._createHeader=function(e,t){void 0===t&&(t=null);var r=this._sdkState,i=r.appId,o=r.appVersion,s=n(n({},e.headers),{SendBird:"JS,".concat(h.OS_VERSION,",").concat(h.SDK_VERSION,",").concat(i).concat(o?",".concat(o):""),"SB-User-Agent":encodeURIComponent(this._userAgentWithExtension),"Request-Sent-Timestamp":Date.now().toString()});return t||(s["Content-Type"]="application/json; charset=utf-8"),e.requireAuth&&this._auth.hasSession&&(s["Session-Key"]=this._auth.sessionKey),this._auth&&this._auth.authToken&&(s["App-Id"]=i,s["Access-Token"]=this._auth.authToken),s},e.prototype._statLogApiResult=function(e,t,n){this._dispatcher.dispatch(new ke(new Te({type:be.API_RESULT,data:{endpoint:e.path,method:e.method,success:!n,latency:Date.now()-t,error_code:null==n?void 0:n.code,error_description:null==n?void 0:n.message}})))},e.prototype.send=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i,s,a,c,u,l,h,d,_,f,p,g;return o(this,(function(o){switch(o.label){case 0:t=e.path,n=e.method,r=![J.GET,J.DELETE].includes(n),i=this._sdkState.api,s="".concat(i.host).concat(t).concat(r?"":e.query),a=r?e.payload:null,c=this._createHeader(e,a instanceof FormData?a:null),u=new AbortController,l=u.signal,this._abortControl.set(e.requestId,u),h=Date.now(),o.label=1;case 1:return o.trys.push([1,8,,9]),this._shouldImportFetchCompat&&(this._shouldImportFetchCompat=!1,("undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||{fetch:null}).fetch=void 0),"undefined"!=typeof AbortController?[3,3]:[4,import("./__bundle-2aa1a987.js")];case 2:o.sent(),o.label=3;case 3:return"function"==typeof fetch?[3,5]:[4,import("./__bundle-57274663.js")];case 4:o.sent(),o.label=5;case 5:return[4,fetch(s,{method:n,body:a,headers:c,signal:l})];case 6:return[4,(d=o.sent()).json()];case 7:if(_=o.sent(),d.ok||d.redirected)return this._logger.debug("receive api response",e.requestId),this._statLogApiResult(e,h,null),[2,new ye(this._iid,_)];throw _?(((f=new E(_)).isSessionKeyExpiredError||f.isSessionTokenExpiredError)&&this._dispatcher.dispatch(new Se({reason:f.code})),this._statLogApiResult(e,h,f),f):(f=E.requestFailed,this._statLogApiResult(e,h,f),f);case 8:throw p=o.sent(),this._statLogApiResult(e,h,p),p instanceof E?(this._logger.debug("fail api request",p),p):"AbortError"===p.name?E.requestCanceled:(g=E.networkError,this._logger.debug("fail api request",g),g);case 9:return[2]}}))}))},e.prototype.cancel=function(e){this._abortControl.has(e)&&(this._abortControl.get(e).abort(),this._abortControl.delete(e))},e.prototype.cancelAll=function(){var e,t;try{for(var n=s(this._abortControl.values()),r=n.next();!r.done;r=n.next()){r.value.abort()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this._abortControl.clear()},e}(),Ae=function(e){function n(t,n,r,i){void 0===i&&(i="");var o=e.call(this)||this;return o._iid=t,o.code=n,o.payload=r,o.requestId=r?r.req_id:i,o}return t(n,e),n.createFromRawMessage=function(e,t){var r=t.substring(0,4),i=null;try{i=JSON.parse(t.substring(4))}catch(e){r="NOOP"}finally{return new n(e,r,i)}},n.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),"\n")},n.prototype.as=function(e){return new e(this._iid,this.code,this.payload)},n}(Y),Ne=function(){};function Ie(e){let t=e.length;for(;--t>=0;)e[t]=0}const Re=256,De=286,Le=30,xe=15,Me=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Pe=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Ue=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),ze=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Fe=new Array(576);Ie(Fe);const qe=new Array(60);Ie(qe);const Ge=new Array(512);Ie(Ge);const je=new Array(256);Ie(je);const Ke=new Array(29);Ie(Ke);const Be=new Array(Le);function Ze(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let Ve,He,We;function Qe(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}Ie(Be);const Ye=e=>e<256?Ge[e]:Ge[256+(e>>>7)],Xe=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},Je=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,Xe(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},$e=(e,t,n)=>{Je(e,n[2*t],n[2*t+1])},et=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},tt=(e,t,n)=>{const r=new Array(16);let i,o,s=0;for(i=1;i<=xe;i++)s=s+n[i-1]<<1,r[i]=s;for(o=0;o<=t;o++){let t=e[2*o+1];0!==t&&(e[2*o]=et(r[t]++,t))}},nt=e=>{let t;for(t=0;t<De;t++)e.dyn_ltree[2*t]=0;for(t=0;t<Le;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},rt=e=>{e.bi_valid>8?Xe(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},it=(e,t,n,r)=>{const i=2*t,o=2*n;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]},ot=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&it(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!it(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},st=(e,t,n)=>{let r,i,o,s,a=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+a++],r+=(255&e.pending_buf[e.sym_buf+a++])<<8,i=e.pending_buf[e.sym_buf+a++],0===r?$e(e,i,t):(o=je[i],$e(e,o+Re+1,t),s=Me[o],0!==s&&(i-=Ke[o],Je(e,i,s)),r--,o=Ye(r),$e(e,o,n),s=Pe[o],0!==s&&(r-=Be[o],Je(e,r,s)))}while(a<e.sym_next);$e(e,256,t)},at=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.elems;let s,a,c,u=-1;for(e.heap_len=0,e.heap_max=573,s=0;s<o;s++)0!==n[2*s]?(e.heap[++e.heap_len]=u=s,e.depth[s]=0):n[2*s+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=u<2?++u:0,n[2*c]=1,e.depth[c]=0,e.opt_len--,i&&(e.static_len-=r[2*c+1]);for(t.max_code=u,s=e.heap_len>>1;s>=1;s--)ot(e,n,s);c=o;do{s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],ot(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=a,n[2*c]=n[2*s]+n[2*a],e.depth[c]=(e.depth[s]>=e.depth[a]?e.depth[s]:e.depth[a])+1,n[2*s+1]=n[2*a+1]=c,e.heap[1]=c++,ot(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,o=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,c=t.stat_desc.max_length;let u,l,h,d,_,f,p=0;for(d=0;d<=xe;d++)e.bl_count[d]=0;for(n[2*e.heap[e.heap_max]+1]=0,u=e.heap_max+1;u<573;u++)l=e.heap[u],d=n[2*n[2*l+1]+1]+1,d>c&&(d=c,p++),n[2*l+1]=d,l>r||(e.bl_count[d]++,_=0,l>=a&&(_=s[l-a]),f=n[2*l],e.opt_len+=f*(d+_),o&&(e.static_len+=f*(i[2*l+1]+_)));if(0!==p){do{for(d=c-1;0===e.bl_count[d];)d--;e.bl_count[d]--,e.bl_count[d+1]+=2,e.bl_count[c]--,p-=2}while(p>0);for(d=c;0!==d;d--)for(l=e.bl_count[d];0!==l;)h=e.heap[--u],h>r||(n[2*h+1]!==d&&(e.opt_len+=(d-n[2*h+1])*n[2*h],n[2*h+1]=d),l--)}})(e,t),tt(n,u,e.bl_count)},ct=(e,t,n)=>{let r,i,o=-1,s=t[1],a=0,c=7,u=4;for(0===s&&(c=138,u=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=s,s=t[2*(r+1)+1],++a<c&&i===s||(a<u?e.bl_tree[2*i]+=a:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,o=i,0===s?(c=138,u=3):i===s?(c=6,u=3):(c=7,u=4))},ut=(e,t,n)=>{let r,i,o=-1,s=t[1],a=0,c=7,u=4;for(0===s&&(c=138,u=3),r=0;r<=n;r++)if(i=s,s=t[2*(r+1)+1],!(++a<c&&i===s)){if(a<u)do{$e(e,i,e.bl_tree)}while(0!=--a);else 0!==i?(i!==o&&($e(e,i,e.bl_tree),a--),$e(e,16,e.bl_tree),Je(e,a-3,2)):a<=10?($e(e,17,e.bl_tree),Je(e,a-3,3)):($e(e,18,e.bl_tree),Je(e,a-11,7));a=0,o=i,0===s?(c=138,u=3):i===s?(c=6,u=3):(c=7,u=4)}};let lt=!1;const ht=(e,t,n,r)=>{Je(e,0+(r?1:0),3),rt(e),Xe(e,n),Xe(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var dt=(e,t,n,r)=>{let i,o,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<Re;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),at(e,e.l_desc),at(e,e.d_desc),s=(e=>{let t;for(ct(e,e.dyn_ltree,e.l_desc.max_code),ct(e,e.dyn_dtree,e.d_desc.max_code),at(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*ze[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=i&&(i=o)):i=o=n+5,n+4<=i&&-1!==t?ht(e,t,n,r):4===e.strategy||o===i?(Je(e,2+(r?1:0),3),st(e,Fe,qe)):(Je(e,4+(r?1:0),3),((e,t,n,r)=>{let i;for(Je(e,t-257,5),Je(e,n-1,5),Je(e,r-4,4),i=0;i<r;i++)Je(e,e.bl_tree[2*ze[i]+1],3);ut(e,e.dyn_ltree,t-1),ut(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),st(e,e.dyn_ltree,e.dyn_dtree)),nt(e),r&&rt(e)},_t={_tr_init:e=>{lt||((()=>{let e,t,n,r,i;const o=new Array(16);for(n=0,r=0;r<28;r++)for(Ke[r]=n,e=0;e<1<<Me[r];e++)je[n++]=r;for(je[n-1]=r,i=0,r=0;r<16;r++)for(Be[r]=i,e=0;e<1<<Pe[r];e++)Ge[i++]=r;for(i>>=7;r<Le;r++)for(Be[r]=i<<7,e=0;e<1<<Pe[r]-7;e++)Ge[256+i++]=r;for(t=0;t<=xe;t++)o[t]=0;for(e=0;e<=143;)Fe[2*e+1]=8,e++,o[8]++;for(;e<=255;)Fe[2*e+1]=9,e++,o[9]++;for(;e<=279;)Fe[2*e+1]=7,e++,o[7]++;for(;e<=287;)Fe[2*e+1]=8,e++,o[8]++;for(tt(Fe,287,o),e=0;e<Le;e++)qe[2*e+1]=5,qe[2*e]=et(e,5);Ve=new Ze(Fe,Me,257,De,xe),He=new Ze(qe,Pe,0,Le,xe),We=new Ze(new Array(0),Ue,0,19,7)})(),lt=!0),e.l_desc=new Qe(e.dyn_ltree,Ve),e.d_desc=new Qe(e.dyn_dtree,He),e.bl_desc=new Qe(e.bl_tree,We),e.bi_buf=0,e.bi_valid=0,nt(e)},_tr_stored_block:ht,_tr_flush_block:dt,_tr_tally:(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(je[n]+Re+1)]++,e.dyn_dtree[2*Ye(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{Je(e,2,3),$e(e,256,Fe),(e=>{16===e.bi_valid?(Xe(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var ft=(e,t,n,r)=>{let i=65535&e|0,o=e>>>16&65535|0,s=0;for(;0!==n;){s=n>2e3?2e3:n,n-=s;do{i=i+t[r++]|0,o=o+i|0}while(--s);i%=65521,o%=65521}return i|o<<16|0};const pt=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var gt=(e,t,n,r)=>{const i=pt,o=r+n;e^=-1;for(let n=r;n<o;n++)e=e>>>8^i[255&(e^t[n])];return-1^e},vt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Et={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:bt,_tr_stored_block:mt,_tr_flush_block:yt,_tr_tally:wt,_tr_align:St}=_t,{Z_NO_FLUSH:kt,Z_PARTIAL_FLUSH:Tt,Z_FULL_FLUSH:Ct,Z_FINISH:Ot,Z_BLOCK:At,Z_OK:Nt,Z_STREAM_END:It,Z_STREAM_ERROR:Rt,Z_DATA_ERROR:Dt,Z_BUF_ERROR:Lt,Z_DEFAULT_COMPRESSION:xt,Z_FILTERED:Mt,Z_HUFFMAN_ONLY:Pt,Z_RLE:Ut,Z_FIXED:zt,Z_DEFAULT_STRATEGY:Ft,Z_UNKNOWN:qt,Z_DEFLATED:Gt}=Et,jt=258,Kt=262,Bt=42,Zt=113,Vt=666,Ht=(e,t)=>(e.msg=vt[t],t),Wt=e=>2*e-(e>4?9:0),Qt=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Yt=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=i?n-i:0}while(--t);t=i,r=t;do{n=e.prev[--r],e.prev[r]=n>=i?n-i:0}while(--t)};let Xt=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const Jt=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},$t=(e,t)=>{yt(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Jt(e.strm)},en=(e,t)=>{e.pending_buf[e.pending++]=t},tn=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},nn=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),1===e.state.wrap?e.adler=ft(e.adler,t,i,n):2===e.state.wrap&&(e.adler=gt(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},rn=(e,t)=>{let n,r,i=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match;const c=e.strstart>e.w_size-Kt?e.strstart-(e.w_size-Kt):0,u=e.window,l=e.w_mask,h=e.prev,d=e.strstart+jt;let _=u[o+s-1],f=u[o+s];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(n=t,u[n+s]===f&&u[n+s-1]===_&&u[n]===u[o]&&u[++n]===u[o+1]){o+=2,n++;do{}while(u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&o<d);if(r=jt-(d-o),o=d-jt,r>s){if(e.match_start=t,s=r,r>=a)break;_=u[o+s-1],f=u[o+s]}}}while((t=h[t&l])>c&&0!=--i);return s<=e.lookahead?s:e.lookahead},on=e=>{const t=e.w_size;let n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Kt)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Yt(e),r+=t),0===e.strm.avail_in)break;if(n=nn(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=Xt(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=Xt(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<Kt&&0!==e.strm.avail_in)},sn=(e,t)=>{let n,r,i,o=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,s=0,a=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i)break;if(i=e.strm.avail_out-i,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>i&&(n=i),n<o&&(0===n&&t!==Ot||t===kt||n!==r+e.strm.avail_in))break;s=t===Ot&&n===r+e.strm.avail_in?1:0,mt(e,0,0,s),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,Jt(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(nn(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===s);return a-=e.strm.avail_in,a&&(a>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=a&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-a,e.strm.next_in),e.strstart),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?4:t!==kt&&t!==Ot&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(nn(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,o=i>e.w_size?e.w_size:i,r=e.strstart-e.block_start,(r>=o||(r||t===Ot)&&t!==kt&&0===e.strm.avail_in&&r<=i)&&(n=r>i?i:r,s=t===Ot&&0===e.strm.avail_in&&n===r?1:0,mt(e,e.block_start,n,s),e.block_start+=n,Jt(e.strm)),s?3:1)},an=(e,t)=>{let n,r;for(;;){if(e.lookahead<Kt){if(on(e),e.lookahead<Kt&&t===kt)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Xt(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-Kt&&(e.match_length=rn(e,n)),e.match_length>=3)if(r=wt(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Xt(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Xt(e,e.ins_h,e.window[e.strstart+1]);else r=wt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&($t(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Ot?($t(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&($t(e,!1),0===e.strm.avail_out)?1:2},cn=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<Kt){if(on(e),e.lookahead<Kt&&t===kt)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Xt(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-Kt&&(e.match_length=rn(e,n),e.match_length<=5&&(e.strategy===Mt||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=wt(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=Xt(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&($t(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=wt(e,0,e.window[e.strstart-1]),r&&$t(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=wt(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Ot?($t(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&($t(e,!1),0===e.strm.avail_out)?1:2};function un(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}const ln=[new un(0,0,0,0,sn),new un(4,4,8,4,an),new un(4,5,16,8,an),new un(4,6,32,32,an),new un(4,4,16,16,cn),new un(8,16,32,32,cn),new un(8,16,128,128,cn),new un(8,32,128,256,cn),new un(32,128,258,1024,cn),new un(32,258,258,4096,cn)];function hn(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Gt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Qt(this.dyn_ltree),Qt(this.dyn_dtree),Qt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Qt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Qt(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const dn=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Bt&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==Zt&&t.status!==Vt?1:0},_n=e=>{if(dn(e))return Ht(e,Rt);e.total_in=e.total_out=0,e.data_type=qt;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?Bt:Zt,e.adler=2===t.wrap?0:1,t.last_flush=-2,bt(t),Nt},fn=e=>{const t=_n(e);var n;return t===Nt&&((n=e.state).window_size=2*n.w_size,Qt(n.head),n.max_lazy_match=ln[n.level].max_lazy,n.good_match=ln[n.level].good_length,n.nice_match=ln[n.level].nice_length,n.max_chain_length=ln[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},pn=(e,t,n,r,i,o)=>{if(!e)return Rt;let s=1;if(t===xt&&(t=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),i<1||i>9||n!==Gt||r<8||r>15||t<0||t>9||o<0||o>zt||8===r&&1!==s)return Ht(e,Rt);8===r&&(r=9);const a=new hn;return e.state=a,a.strm=e,a.status=Bt,a.wrap=s,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=t,a.strategy=o,a.method=n,fn(e)};var gn={deflateInit:(e,t)=>pn(e,t,Gt,15,8,Ft),deflateInit2:pn,deflateReset:fn,deflateResetKeep:_n,deflateSetHeader:(e,t)=>dn(e)||2!==e.state.wrap?Rt:(e.state.gzhead=t,Nt),deflate:(e,t)=>{if(dn(e)||t>At||t<0)return e?Ht(e,Rt):Rt;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===Vt&&t!==Ot)return Ht(e,0===e.avail_out?Lt:Rt);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(Jt(e),0===e.avail_out)return n.last_flush=-1,Nt}else if(0===e.avail_in&&Wt(t)<=Wt(r)&&t!==Ot)return Ht(e,Lt);if(n.status===Vt&&0!==e.avail_in)return Ht(e,Lt);if(n.status===Bt&&0===n.wrap&&(n.status=Zt),n.status===Bt){let t=Gt+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=Pt||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=32),t+=31-t%31,tn(n,t),0!==n.strstart&&(tn(n,e.adler>>>16),tn(n,65535&e.adler)),e.adler=1,n.status=Zt,Jt(e),0!==n.pending)return n.last_flush=-1,Nt}if(57===n.status)if(e.adler=0,en(n,31),en(n,139),en(n,8),n.gzhead)en(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),en(n,255&n.gzhead.time),en(n,n.gzhead.time>>8&255),en(n,n.gzhead.time>>16&255),en(n,n.gzhead.time>>24&255),en(n,9===n.level?2:n.strategy>=Pt||n.level<2?4:0),en(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(en(n,255&n.gzhead.extra.length),en(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=gt(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(en(n,0),en(n,0),en(n,0),en(n,0),en(n,0),en(n,9===n.level?2:n.strategy>=Pt||n.level<2?4:0),en(n,3),n.status=Zt,Jt(e),0!==n.pending)return n.last_flush=-1,Nt;if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let i=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=gt(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=i,Jt(e),0!==n.pending)return n.last_flush=-1,Nt;t=0,r-=i}let i=new Uint8Array(n.gzhead.extra);n.pending_buf.set(i.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=gt(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=gt(e.adler,n.pending_buf,n.pending-r,r)),Jt(e),0!==n.pending)return n.last_flush=-1,Nt;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,en(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=gt(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=gt(e.adler,n.pending_buf,n.pending-r,r)),Jt(e),0!==n.pending)return n.last_flush=-1,Nt;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,en(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=gt(e.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(Jt(e),0!==n.pending))return n.last_flush=-1,Nt;en(n,255&e.adler),en(n,e.adler>>8&255),e.adler=0}if(n.status=Zt,Jt(e),0!==n.pending)return n.last_flush=-1,Nt}if(0!==e.avail_in||0!==n.lookahead||t!==kt&&n.status!==Vt){let r=0===n.level?sn(n,t):n.strategy===Pt?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(on(e),0===e.lookahead)){if(t===kt)return 1;break}if(e.match_length=0,n=wt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&($t(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Ot?($t(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&($t(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===Ut?((e,t)=>{let n,r,i,o;const s=e.window;for(;;){if(e.lookahead<=jt){if(on(e),e.lookahead<=jt&&t===kt)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,r=s[i],r===s[++i]&&r===s[++i]&&r===s[++i])){o=e.strstart+jt;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<o);e.match_length=jt-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=wt(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=wt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&($t(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Ot?($t(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&($t(e,!1),0===e.strm.avail_out)?1:2})(n,t):ln[n.level].func(n,t);if(3!==r&&4!==r||(n.status=Vt),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),Nt;if(2===r&&(t===Tt?St(n):t!==At&&(mt(n,0,0,!1),t===Ct&&(Qt(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),Jt(e),0===e.avail_out))return n.last_flush=-1,Nt}return t!==Ot?Nt:n.wrap<=0?It:(2===n.wrap?(en(n,255&e.adler),en(n,e.adler>>8&255),en(n,e.adler>>16&255),en(n,e.adler>>24&255),en(n,255&e.total_in),en(n,e.total_in>>8&255),en(n,e.total_in>>16&255),en(n,e.total_in>>24&255)):(tn(n,e.adler>>>16),tn(n,65535&e.adler)),Jt(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?Nt:It)},deflateEnd:e=>{if(dn(e))return Rt;const t=e.state.status;return e.state=null,t===Zt?Ht(e,Dt):Nt},deflateSetDictionary:(e,t)=>{let n=t.length;if(dn(e))return Rt;const r=e.state,i=r.wrap;if(2===i||1===i&&r.status!==Bt||r.lookahead)return Rt;if(1===i&&(e.adler=ft(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===i&&(Qt(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const o=e.avail_in,s=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,on(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=Xt(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,on(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=s,e.input=a,e.avail_in=o,r.wrap=i,Nt},deflateInfo:"pako deflate (from Nodeca project)"};const vn=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var En={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)vn(n,t)&&(e[t]=n[t])}}return e},flattenChunks:e=>{let t=0;for(let n=0,r=e.length;n<r;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,r=0,i=e.length;t<i;t++){let i=e[t];n.set(i,r),r+=i.length}return n}};let bn=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){bn=!1}const mn=new Uint8Array(256);for(let e=0;e<256;e++)mn[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;mn[254]=mn[254]=1;var yn={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,i,o,s=e.length,a=0;for(i=0;i<s;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<s&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),o=0,i=0;o<a;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<s&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},buf2string:(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,i;const o=new Array(2*n);for(i=0,r=0;r<n;){let t=e[r++];if(t<128){o[i++]=t;continue}let s=mn[t];if(s>4)o[i++]=65533,r+=s-1;else{for(t&=2===s?31:3===s?15:7;s>1&&r<n;)t=t<<6|63&e[r++],s--;s>1?o[i++]=65533:t<65536?o[i++]=t:(t-=65536,o[i++]=55296|t>>10&1023,o[i++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&bn)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n})(o,i)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+mn[e[n]]>t?n:t}};var wn=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Sn=Object.prototype.toString,{Z_NO_FLUSH:kn,Z_SYNC_FLUSH:Tn,Z_FULL_FLUSH:Cn,Z_FINISH:On,Z_OK:An,Z_STREAM_END:Nn,Z_DEFAULT_COMPRESSION:In,Z_DEFAULT_STRATEGY:Rn,Z_DEFLATED:Dn}=Et;function Ln(e){this.options=En.assign({level:In,method:Dn,chunkSize:16384,windowBits:15,memLevel:8,strategy:Rn},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new wn,this.strm.avail_out=0;let n=gn.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==An)throw new Error(vt[n]);if(t.header&&gn.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?yn.string2buf(t.dictionary):"[object ArrayBuffer]"===Sn.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=gn.deflateSetDictionary(this.strm,e),n!==An)throw new Error(vt[n]);this._dict_set=!0}}function xn(e,t){const n=new Ln(t);if(n.push(e,!0),n.err)throw n.msg||vt[n.err];return n.result}Ln.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let i,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?On:kn,"string"==typeof e?n.input=yn.string2buf(e):"[object ArrayBuffer]"===Sn.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(o===Tn||o===Cn)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(i=gn.deflate(n,o),i===Nn)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=gn.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===An;if(0!==n.avail_out){if(o>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},Ln.prototype.onData=function(e){this.chunks.push(e)},Ln.prototype.onEnd=function(e){e===An&&(this.result=En.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Mn={Deflate:Ln,deflate:xn,deflateRaw:function(e,t){return(t=t||{}).raw=!0,xn(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,xn(e,t)},constants:Et};const Pn=16209;var Un=function(e,t){let n,r,i,o,s,a,c,u,l,h,d,_,f,p,g,v,E,b,m,y,w,S,k,T;const C=e.state;n=e.next_in,k=e.input,r=n+(e.avail_in-5),i=e.next_out,T=e.output,o=i-(t-e.avail_out),s=i+(e.avail_out-257),a=C.dmax,c=C.wsize,u=C.whave,l=C.wnext,h=C.window,d=C.hold,_=C.bits,f=C.lencode,p=C.distcode,g=(1<<C.lenbits)-1,v=(1<<C.distbits)-1;e:do{_<15&&(d+=k[n++]<<_,_+=8,d+=k[n++]<<_,_+=8),E=f[d&g];t:for(;;){if(b=E>>>24,d>>>=b,_-=b,b=E>>>16&255,0===b)T[i++]=65535&E;else{if(!(16&b)){if(0==(64&b)){E=f[(65535&E)+(d&(1<<b)-1)];continue t}if(32&b){C.mode=16191;break e}e.msg="invalid literal/length code",C.mode=Pn;break e}m=65535&E,b&=15,b&&(_<b&&(d+=k[n++]<<_,_+=8),m+=d&(1<<b)-1,d>>>=b,_-=b),_<15&&(d+=k[n++]<<_,_+=8,d+=k[n++]<<_,_+=8),E=p[d&v];n:for(;;){if(b=E>>>24,d>>>=b,_-=b,b=E>>>16&255,!(16&b)){if(0==(64&b)){E=p[(65535&E)+(d&(1<<b)-1)];continue n}e.msg="invalid distance code",C.mode=Pn;break e}if(y=65535&E,b&=15,_<b&&(d+=k[n++]<<_,_+=8,_<b&&(d+=k[n++]<<_,_+=8)),y+=d&(1<<b)-1,y>a){e.msg="invalid distance too far back",C.mode=Pn;break e}if(d>>>=b,_-=b,b=i-o,y>b){if(b=y-b,b>u&&C.sane){e.msg="invalid distance too far back",C.mode=Pn;break e}if(w=0,S=h,0===l){if(w+=c-b,b<m){m-=b;do{T[i++]=h[w++]}while(--b);w=i-y,S=T}}else if(l<b){if(w+=c+l-b,b-=l,b<m){m-=b;do{T[i++]=h[w++]}while(--b);if(w=0,l<m){b=l,m-=b;do{T[i++]=h[w++]}while(--b);w=i-y,S=T}}}else if(w+=l-b,b<m){m-=b;do{T[i++]=h[w++]}while(--b);w=i-y,S=T}for(;m>2;)T[i++]=S[w++],T[i++]=S[w++],T[i++]=S[w++],m-=3;m&&(T[i++]=S[w++],m>1&&(T[i++]=S[w++]))}else{w=i-y;do{T[i++]=T[w++],T[i++]=T[w++],T[i++]=T[w++],m-=3}while(m>2);m&&(T[i++]=T[w++],m>1&&(T[i++]=T[w++]))}break}}break}}while(n<r&&i<s);m=_>>3,n-=m,_-=m<<3,d&=(1<<_)-1,e.next_in=n,e.next_out=i,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=i<s?s-i+257:257-(i-s),C.hold=d,C.bits=_};const zn=15,Fn=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),qn=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Gn=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),jn=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Kn=(e,t,n,r,i,o,s,a)=>{const c=a.bits;let u,l,h,d,_,f,p=0,g=0,v=0,E=0,b=0,m=0,y=0,w=0,S=0,k=0,T=null;const C=new Uint16Array(16),O=new Uint16Array(16);let A,N,I,R=null;for(p=0;p<=zn;p++)C[p]=0;for(g=0;g<r;g++)C[t[n+g]]++;for(b=c,E=zn;E>=1&&0===C[E];E--);if(b>E&&(b=E),0===E)return i[o++]=20971520,i[o++]=20971520,a.bits=1,0;for(v=1;v<E&&0===C[v];v++);for(b<v&&(b=v),w=1,p=1;p<=zn;p++)if(w<<=1,w-=C[p],w<0)return-1;if(w>0&&(0===e||1!==E))return-1;for(O[1]=0,p=1;p<zn;p++)O[p+1]=O[p]+C[p];for(g=0;g<r;g++)0!==t[n+g]&&(s[O[t[n+g]]++]=g);if(0===e?(T=R=s,f=20):1===e?(T=Fn,R=qn,f=257):(T=Gn,R=jn,f=0),k=0,g=0,p=v,_=o,m=b,y=0,h=-1,S=1<<b,d=S-1,1===e&&S>852||2===e&&S>592)return 1;for(;;){A=p-y,s[g]+1<f?(N=0,I=s[g]):s[g]>=f?(N=R[s[g]-f],I=T[s[g]-f]):(N=96,I=0),u=1<<p-y,l=1<<m,v=l;do{l-=u,i[_+(k>>y)+l]=A<<24|N<<16|I|0}while(0!==l);for(u=1<<p-1;k&u;)u>>=1;if(0!==u?(k&=u-1,k+=u):k=0,g++,0==--C[p]){if(p===E)break;p=t[n+s[g]]}if(p>b&&(k&d)!==h){for(0===y&&(y=b),_+=v,m=p-y,w=1<<m;m+y<E&&(w-=C[m+y],!(w<=0));)m++,w<<=1;if(S+=1<<m,1===e&&S>852||2===e&&S>592)return 1;h=k&d,i[h]=b<<24|m<<16|_-o|0}}return 0!==k&&(i[_+k]=p-y<<24|64<<16|0),a.bits=b,0};const{Z_FINISH:Bn,Z_BLOCK:Zn,Z_TREES:Vn,Z_OK:Hn,Z_STREAM_END:Wn,Z_NEED_DICT:Qn,Z_STREAM_ERROR:Yn,Z_DATA_ERROR:Xn,Z_MEM_ERROR:Jn,Z_BUF_ERROR:$n,Z_DEFLATED:er}=Et,tr=16180,nr=16190,rr=16191,ir=16192,or=16194,sr=16199,ar=16200,cr=16206,ur=16209,lr=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function hr(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const dr=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<tr||t.mode>16211?1:0},_r=e=>{if(dr(e))return Yn;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=tr,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Hn},fr=e=>{if(dr(e))return Yn;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,_r(e)},pr=(e,t)=>{let n;if(dr(e))return Yn;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Yn:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,fr(e))},gr=(e,t)=>{if(!e)return Yn;const n=new hr;e.state=n,n.strm=e,n.window=null,n.mode=tr;const r=pr(e,t);return r!==Hn&&(e.state=null),r};let vr,Er,br=!0;const mr=e=>{if(br){vr=new Int32Array(512),Er=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Kn(1,e.lens,0,288,vr,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Kn(2,e.lens,0,32,Er,0,e.work,{bits:5}),br=!1}e.lencode=vr,e.lenbits=9,e.distcode=Er,e.distbits=5},yr=(e,t,n,r)=>{let i;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),r>=o.wsize?(o.window.set(t.subarray(n-o.wsize,n),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>r&&(i=r),o.window.set(t.subarray(n-r,n-r+i),o.wnext),(r-=i)?(o.window.set(t.subarray(n-r,n),0),o.wnext=r,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0};var wr={inflateReset:fr,inflateReset2:pr,inflateResetKeep:_r,inflateInit:e=>gr(e,15),inflateInit2:gr,inflate:(e,t)=>{let n,r,i,o,s,a,c,u,l,h,d,_,f,p,g,v,E,b,m,y,w,S,k=0;const T=new Uint8Array(4);let C,O;const A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(dr(e)||!e.output||!e.input&&0!==e.avail_in)return Yn;n=e.state,n.mode===rr&&(n.mode=ir),s=e.next_out,i=e.output,c=e.avail_out,o=e.next_in,r=e.input,a=e.avail_in,u=n.hold,l=n.bits,h=a,d=c,S=Hn;e:for(;;)switch(n.mode){case tr:if(0===n.wrap){n.mode=ir;break}for(;l<16;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}if(2&n.wrap&&35615===u){0===n.wbits&&(n.wbits=15),n.check=0,T[0]=255&u,T[1]=u>>>8&255,n.check=gt(n.check,T,2,0),u=0,l=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",n.mode=ur;break}if((15&u)!==er){e.msg="unknown compression method",n.mode=ur;break}if(u>>>=4,l-=4,w=8+(15&u),0===n.wbits&&(n.wbits=w),w>15||w>n.wbits){e.msg="invalid window size",n.mode=ur;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&u?16189:rr,u=0,l=0;break;case 16181:for(;l<16;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}if(n.flags=u,(255&n.flags)!==er){e.msg="unknown compression method",n.mode=ur;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=ur;break}n.head&&(n.head.text=u>>8&1),512&n.flags&&4&n.wrap&&(T[0]=255&u,T[1]=u>>>8&255,n.check=gt(n.check,T,2,0)),u=0,l=0,n.mode=16182;case 16182:for(;l<32;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}n.head&&(n.head.time=u),512&n.flags&&4&n.wrap&&(T[0]=255&u,T[1]=u>>>8&255,T[2]=u>>>16&255,T[3]=u>>>24&255,n.check=gt(n.check,T,4,0)),u=0,l=0,n.mode=16183;case 16183:for(;l<16;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}n.head&&(n.head.xflags=255&u,n.head.os=u>>8),512&n.flags&&4&n.wrap&&(T[0]=255&u,T[1]=u>>>8&255,n.check=gt(n.check,T,2,0)),u=0,l=0,n.mode=16184;case 16184:if(1024&n.flags){for(;l<16;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}n.length=u,n.head&&(n.head.extra_len=u),512&n.flags&&4&n.wrap&&(T[0]=255&u,T[1]=u>>>8&255,n.check=gt(n.check,T,2,0)),u=0,l=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(_=n.length,_>a&&(_=a),_&&(n.head&&(w=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(o,o+_),w)),512&n.flags&&4&n.wrap&&(n.check=gt(n.check,r,_,o)),a-=_,o+=_,n.length-=_),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===a)break e;_=0;do{w=r[o+_++],n.head&&w&&n.length<65536&&(n.head.name+=String.fromCharCode(w))}while(w&&_<a);if(512&n.flags&&4&n.wrap&&(n.check=gt(n.check,r,_,o)),a-=_,o+=_,w)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===a)break e;_=0;do{w=r[o+_++],n.head&&w&&n.length<65536&&(n.head.comment+=String.fromCharCode(w))}while(w&&_<a);if(512&n.flags&&4&n.wrap&&(n.check=gt(n.check,r,_,o)),a-=_,o+=_,w)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;l<16;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}if(4&n.wrap&&u!==(65535&n.check)){e.msg="header crc mismatch",n.mode=ur;break}u=0,l=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=rr;break;case 16189:for(;l<32;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}e.adler=n.check=lr(u),u=0,l=0,n.mode=nr;case nr:if(0===n.havedict)return e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,n.hold=u,n.bits=l,Qn;e.adler=n.check=1,n.mode=rr;case rr:if(t===Zn||t===Vn)break e;case ir:if(n.last){u>>>=7&l,l-=7&l,n.mode=cr;break}for(;l<3;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}switch(n.last=1&u,u>>>=1,l-=1,3&u){case 0:n.mode=16193;break;case 1:if(mr(n),n.mode=sr,t===Vn){u>>>=2,l-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=ur}u>>>=2,l-=2;break;case 16193:for(u>>>=7&l,l-=7&l;l<32;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",n.mode=ur;break}if(n.length=65535&u,u=0,l=0,n.mode=or,t===Vn)break e;case or:n.mode=16195;case 16195:if(_=n.length,_){if(_>a&&(_=a),_>c&&(_=c),0===_)break e;i.set(r.subarray(o,o+_),s),a-=_,o+=_,c-=_,s+=_,n.length-=_;break}n.mode=rr;break;case 16196:for(;l<14;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}if(n.nlen=257+(31&u),u>>>=5,l-=5,n.ndist=1+(31&u),u>>>=5,l-=5,n.ncode=4+(15&u),u>>>=4,l-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=ur;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;l<3;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}n.lens[A[n.have++]]=7&u,u>>>=3,l-=3}for(;n.have<19;)n.lens[A[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,C={bits:n.lenbits},S=Kn(0,n.lens,0,19,n.lencode,0,n.work,C),n.lenbits=C.bits,S){e.msg="invalid code lengths set",n.mode=ur;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;k=n.lencode[u&(1<<n.lenbits)-1],g=k>>>24,v=k>>>16&255,E=65535&k,!(g<=l);){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}if(E<16)u>>>=g,l-=g,n.lens[n.have++]=E;else{if(16===E){for(O=g+2;l<O;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}if(u>>>=g,l-=g,0===n.have){e.msg="invalid bit length repeat",n.mode=ur;break}w=n.lens[n.have-1],_=3+(3&u),u>>>=2,l-=2}else if(17===E){for(O=g+3;l<O;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}u>>>=g,l-=g,w=0,_=3+(7&u),u>>>=3,l-=3}else{for(O=g+7;l<O;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}u>>>=g,l-=g,w=0,_=11+(127&u),u>>>=7,l-=7}if(n.have+_>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=ur;break}for(;_--;)n.lens[n.have++]=w}}if(n.mode===ur)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=ur;break}if(n.lenbits=9,C={bits:n.lenbits},S=Kn(1,n.lens,0,n.nlen,n.lencode,0,n.work,C),n.lenbits=C.bits,S){e.msg="invalid literal/lengths set",n.mode=ur;break}if(n.distbits=6,n.distcode=n.distdyn,C={bits:n.distbits},S=Kn(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,C),n.distbits=C.bits,S){e.msg="invalid distances set",n.mode=ur;break}if(n.mode=sr,t===Vn)break e;case sr:n.mode=ar;case ar:if(a>=6&&c>=258){e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,n.hold=u,n.bits=l,Un(e,d),s=e.next_out,i=e.output,c=e.avail_out,o=e.next_in,r=e.input,a=e.avail_in,u=n.hold,l=n.bits,n.mode===rr&&(n.back=-1);break}for(n.back=0;k=n.lencode[u&(1<<n.lenbits)-1],g=k>>>24,v=k>>>16&255,E=65535&k,!(g<=l);){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}if(v&&0==(240&v)){for(b=g,m=v,y=E;k=n.lencode[y+((u&(1<<b+m)-1)>>b)],g=k>>>24,v=k>>>16&255,E=65535&k,!(b+g<=l);){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}u>>>=b,l-=b,n.back+=b}if(u>>>=g,l-=g,n.back+=g,n.length=E,0===v){n.mode=16205;break}if(32&v){n.back=-1,n.mode=rr;break}if(64&v){e.msg="invalid literal/length code",n.mode=ur;break}n.extra=15&v,n.mode=16201;case 16201:if(n.extra){for(O=n.extra;l<O;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,l-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;k=n.distcode[u&(1<<n.distbits)-1],g=k>>>24,v=k>>>16&255,E=65535&k,!(g<=l);){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}if(0==(240&v)){for(b=g,m=v,y=E;k=n.distcode[y+((u&(1<<b+m)-1)>>b)],g=k>>>24,v=k>>>16&255,E=65535&k,!(b+g<=l);){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}u>>>=b,l-=b,n.back+=b}if(u>>>=g,l-=g,n.back+=g,64&v){e.msg="invalid distance code",n.mode=ur;break}n.offset=E,n.extra=15&v,n.mode=16203;case 16203:if(n.extra){for(O=n.extra;l<O;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,l-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=ur;break}n.mode=16204;case 16204:if(0===c)break e;if(_=d-c,n.offset>_){if(_=n.offset-_,_>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=ur;break}_>n.wnext?(_-=n.wnext,f=n.wsize-_):f=n.wnext-_,_>n.length&&(_=n.length),p=n.window}else p=i,f=s-n.offset,_=n.length;_>c&&(_=c),c-=_,n.length-=_;do{i[s++]=p[f++]}while(--_);0===n.length&&(n.mode=ar);break;case 16205:if(0===c)break e;i[s++]=n.length,c--,n.mode=ar;break;case cr:if(n.wrap){for(;l<32;){if(0===a)break e;a--,u|=r[o++]<<l,l+=8}if(d-=c,e.total_out+=d,n.total+=d,4&n.wrap&&d&&(e.adler=n.check=n.flags?gt(n.check,i,d,s-d):ft(n.check,i,d,s-d)),d=c,4&n.wrap&&(n.flags?u:lr(u))!==n.check){e.msg="incorrect data check",n.mode=ur;break}u=0,l=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;l<32;){if(0===a)break e;a--,u+=r[o++]<<l,l+=8}if(4&n.wrap&&u!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=ur;break}u=0,l=0}n.mode=16208;case 16208:S=Wn;break e;case ur:S=Xn;break e;case 16210:return Jn;default:return Yn}return e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,n.hold=u,n.bits=l,(n.wsize||d!==e.avail_out&&n.mode<ur&&(n.mode<cr||t!==Bn))&&yr(e,e.output,e.next_out,d-e.avail_out),h-=e.avail_in,d-=e.avail_out,e.total_in+=h,e.total_out+=d,n.total+=d,4&n.wrap&&d&&(e.adler=n.check=n.flags?gt(n.check,i,d,e.next_out-d):ft(n.check,i,d,e.next_out-d)),e.data_type=n.bits+(n.last?64:0)+(n.mode===rr?128:0)+(n.mode===sr||n.mode===or?256:0),(0===h&&0===d||t===Bn)&&S===Hn&&(S=$n),S},inflateEnd:e=>{if(dr(e))return Yn;let t=e.state;return t.window&&(t.window=null),e.state=null,Hn},inflateGetHeader:(e,t)=>{if(dr(e))return Yn;const n=e.state;return 0==(2&n.wrap)?Yn:(n.head=t,t.done=!1,Hn)},inflateSetDictionary:(e,t)=>{const n=t.length;let r,i,o;return dr(e)?Yn:(r=e.state,0!==r.wrap&&r.mode!==nr?Yn:r.mode===nr&&(i=1,i=ft(i,t,n,0),i!==r.check)?Xn:(o=yr(e,t,n,n),o?(r.mode=16210,Jn):(r.havedict=1,Hn)))},inflateInfo:"pako inflate (from Nodeca project)"};var Sr=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const kr=Object.prototype.toString,{Z_NO_FLUSH:Tr,Z_FINISH:Cr,Z_OK:Or,Z_STREAM_END:Ar,Z_NEED_DICT:Nr,Z_STREAM_ERROR:Ir,Z_DATA_ERROR:Rr,Z_MEM_ERROR:Dr}=Et;function Lr(e){this.options=En.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new wn,this.strm.avail_out=0;let n=wr.inflateInit2(this.strm,t.windowBits);if(n!==Or)throw new Error(vt[n]);if(this.header=new Sr,wr.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=yn.string2buf(t.dictionary):"[object ArrayBuffer]"===kr.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=wr.inflateSetDictionary(this.strm,t.dictionary),n!==Or)))throw new Error(vt[n])}function xr(e,t){const n=new Lr(t);if(n.push(e),n.err)throw n.msg||vt[n.err];return n.result}Lr.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=t===~~t?t:!0===t?Cr:Tr,"[object ArrayBuffer]"===kr.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),o=wr.inflate(n,s),o===Nr&&i&&(o=wr.inflateSetDictionary(n,i),o===Or?o=wr.inflate(n,s):o===Rr&&(o=Nr));n.avail_in>0&&o===Ar&&n.state.wrap>0&&0!==e[n.next_in];)wr.inflateReset(n),o=wr.inflate(n,s);switch(o){case Ir:case Rr:case Nr:case Dr:return this.onEnd(o),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(0===n.avail_out||o===Ar))if("string"===this.options.to){let e=yn.utf8border(n.output,n.next_out),t=n.next_out-e,i=yn.buf2string(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(i)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(o!==Or||0!==a){if(o===Ar)return o=wr.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},Lr.prototype.onData=function(e){this.chunks.push(e)},Lr.prototype.onEnd=function(e){e===Or&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=En.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Mr={Inflate:Lr,inflate:xr,inflateRaw:function(e,t){return(t=t||{}).raw=!0,xr(e,t)},ungzip:xr,constants:Et};const{Deflate:Pr,deflate:Ur,deflateRaw:zr,gzip:Fr}=Mn,{Inflate:qr,inflate:Gr,inflateRaw:jr,ungzip:Kr}=Mr;var Br,Zr={Deflate:Pr,deflate:Ur,deflateRaw:zr,gzip:Fr,Inflate:qr,inflate:Gr,inflateRaw:jr,ungzip:Kr,constants:Et};!function(e){e.CONNECTING="CONNECTING",e.OPEN="OPEN",e.CLOSED="CLOSED"}(Br||(Br={}));var Vr,Hr=function(e){function n(t,n){var r=n.sdkState,i=n.dispatcher,o=n.logger,s=e.call(this)||this;return s.lastActive=0,s._iid=t,s._sdkState=r,s._dispatcher=i,s._logger=o,s}return t(n,e),Object.defineProperty(n.prototype,"isOpen",{get:function(){return this.connectionState===Br.OPEN},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"connectionState",{get:function(){if(this._ws)switch(this._ws.readyState){case 0:return Br.CONNECTING;case 1:return Br.OPEN}return Br.CLOSED},enumerable:!1,configurable:!0}),n.prototype._handleMessage=function(e){var t=this;e.split("\n").forEach((function(e){if(e){var n=Ae.createFromRawMessage(t._iid,e);if(t._logger.debug("receive websocket event",n),"LOGI"===n.code)t.dispatch("message",n);else if("PONG"===n.code)t.dispatch("pong");else if("EXPR"===n.code){if(n.payload){var r=new Se(n.payload);r.expiresIn>=0&&t._dispatcher.dispatch(r)}}else"NOOP"===n.code||t.dispatch("message",n)}}))},n.prototype.connect=function(e){var t=this;this._ws=new WebSocket(e),this._ws.onopen=function(){t._logger.debug("websocket open"),t.dispatch("open")},this._ws.onmessage=function(e){return i(t,void 0,void 0,(function(){var t,n,r=this;return o(this,(function(s){return(null===(n=this._sdkState.websocket)||void 0===n?void 0:n.compression)?e.data instanceof Blob?((t=new FileReader).readAsArrayBuffer(e.data),t.onloadend=function(){return i(r,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return[4,(r=t.result,i(void 0,void 0,void 0,(function(){var e;return o(this,(function(t){return e=Zr.ungzip(r),[2,String.fromCharCode.apply(null,e)]}))})))];case 1:return e=n.sent(),this._handleMessage(e),[2]}var r}))}))}):"string"==typeof e.data&&this._handleMessage(e.data):this._handleMessage(e.data),[2]}))}))},this._ws.onerror=function(){t._logger.debug("websocket error"),t.dispatch("error",E.networkError)},this._ws.onclose=function(){t._logger.debug("websocket close"),t.dispatch("close")},this.lastActive=Date.now()},n.prototype.disconnect=function(){var e=this;return new Promise((function(t){e._logger.debug("websocket disconnect"),e._ws&&e.connectionState!==Br.CLOSED?(e._ws.onopen=Ne,e._ws.onmessage=Ne,e._ws.onerror=Ne,e._ws.onclose=function(){e.dispatch("close"),t()},e._ws.close(),e._ws=null):t()}))},n.prototype.send=function(e){if(!this._ws)throw E.connectionClosed;"PING"!==e.code?this.dispatch("ping-refresh"):this._logger.debug("send ping",e),this._ws.send(e.convertToMessage())},n.prototype.error=function(e){this._logger.debug("websocket error",e),this.dispatch("error",e)},n}(W),Wr=function(e){function n(t){var n,r=t.code,i=t.ackRequired,o=t.payload,s=void 0===o?null:o,a=this;return(a=e.call(this)||this).code=r,a.payload=s,a.requestId=null!==(n=a.payload.req_id)&&void 0!==n?n:V(),a.ackRequired=i,a.payload.req_id=a.requestId,a}return t(n,e),n.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),"\n")},n}(Y),Qr=function(e){function n(t){var n=t.all,r=t.custom_types,i=t.ts,o=e.call(this)||this;return o.all=n,o.customTypes=r,o.ts=i,o}return t(n,e),n}(Y),Yr=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))},Xr=function(){function e(e,t){var n=t.auth,r=t.sdkState,i=t.dispatcher,o=t.logger,s=t.useFetchCompat,a=void 0!==s&&s,c=this;this._ackStateMap=new Map,this._sdkState=r,this._dispatcher=i,this._logger=o,this.apiClient=new Oe(e,{auth:n,sdkState:r,dispatcher:i,logger:o,useFetchCompat:a}),this.websocketClient=new Hr(e,{sdkState:r,dispatcher:i,logger:o}),this.websocketClient.on("message",(function(e){if(e.payload.unread_cnt&&c._dispatcher.dispatch(new Qr(e.payload.unread_cnt)),e.requestId){if(c._ackStateMap.has(e.requestId)){var t=c._ackStateMap.get(e.requestId);"EROR"!==e.code?t.resolve(e):t.reject(new E({code:e.payload.code,message:e.payload.message}))}}else c._dispatcher.dispatch(e)})).on("close",(function(){c._ackStateMap.forEach((function(e){e.reject(E.connectionClosed)})),c._ackStateMap.clear()}))}return e.prototype._sendApiRequest=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.apiClient.send(e)];case 1:return[2,t.sent()]}}))}))},e.prototype._sendWebsocketRequest=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i=this;return o(this,(function(o){if(t=new Yr,e.ackRequired){n=null,r=function(r,o){void 0===r&&(r=null),void 0===o&&(o=null),i._ackStateMap.has(e.requestId)&&(i._ackStateMap.delete(e.requestId),n&&(clearTimeout(n),n=null),r?(i._logger.debug("fail websocket request",r),t.reject(r)):(i._logger.debug("receive websocket ack",e.requestId),t.resolve(o)))};try{n=setTimeout((function(){return r(E.noAckTimeout)}),this._sdkState.websocket.responseTimeout),this._ackStateMap.set(e.requestId,{resolve:function(e){return r(null,e)},reject:function(e){return r(e)}}),this.websocketClient.send(e)}catch(e){r(e)}}else try{this.websocketClient.send(e),t.resolve(null)}catch(e){t.reject(e)}return[2,t.promise]}))}))},e.prototype.send=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return e instanceof me?[4,this._sendApiRequest(e)]:[3,2];case 1:case 3:return[2,t.sent()];case 2:return e instanceof Wr?[4,this._sendWebsocketRequest(e)]:[3,4];case 4:throw E.invalidParameters}}))}))},e.prototype.cancel=function(e){this.apiClient.cancel(e)},e.prototype.cancelAll=function(){this.apiClient.cancelAll()},e}();!function(e){e[e.NONE=0]="NONE",e[e.INITIALIZED=1]="INITIALIZED",e[e.CONNECTING=2]="CONNECTING",e[e.CONNECTED=3]="CONNECTED",e[e.RECONNECTING=4]="RECONNECTING",e[e.INTERNAL_DISCONNECTED=5]="INTERNAL_DISCONNECTED",e[e.EXTERNAL_DISCONNECTED=6]="EXTERNAL_DISCONNECTED",e[e.LOGOUT=7]="LOGOUT"}(Vr||(Vr={}));var Jr=function(e){function n(t){var n=t.stateType,r=e.call(this)||this;return r.stateType=n,r}return t(n,e),n}(Y),$r=function(){function e(e,t){var n=t.auth,r=t.sdkState,s=t.dispatcher,a=t.logger,c=t.useFetchCompat,u=void 0!==c&&c,l=this;this._currentConnectionStateType=Vr.INITIALIZED,this._lazyCallQueue=[],this.commandRouter=new Xr(e,{auth:n,sdkState:r,dispatcher:s,logger:a,useFetchCompat:u}),this._auth=n,this._logger=a,this._dispatcher=s,this._dispatcher.on((function(e){if(e instanceof Jr){var t=e.stateType;switch(l._currentConnectionStateType=t,t){case Vr.CONNECTED:var n=l._lazyCallQueue;l._lazyCallQueue=[],n.forEach((function(e){return i(l,void 0,void 0,(function(){var t,n,r,i,s;return o(this,(function(o){switch(o.label){case 0:t=e.command,n=e.deferred,r=e.timeout,clearTimeout(r),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.send(t)];case 2:return i=o.sent(),n.resolve(i),[3,4];case 3:return s=o.sent(),n.reject(s),[3,4];case 4:return[2]}}))}))}));break;case Vr.INITIALIZED:case Vr.INTERNAL_DISCONNECTED:case Vr.EXTERNAL_DISCONNECTED:case Vr.LOGOUT:n=l._lazyCallQueue;l._lazyCallQueue=[],n.forEach((function(e){return i(l,void 0,void 0,(function(){var t,n;return o(this,(function(r){return t=e.deferred,n=e.timeout,clearTimeout(n),this._auth&&this._auth.hasSession?t.reject(E.connectionClosed):t.reject(E.connectionRequired),[2]}))}))}))}}}))}return Object.defineProperty(e.prototype,"isReady",{get:function(){return this._currentConnectionStateType===Vr.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLazyCallActivated",{get:function(){return this._currentConnectionStateType===Vr.CONNECTING||this._currentConnectionStateType===Vr.RECONNECTING},enumerable:!1,configurable:!0}),e.prototype.send=function(e){return i(this,void 0,void 0,(function(){var t,n,r=this;return o(this,(function(i){switch(i.label){case 0:return e instanceof Wr?this.isReady?(this._logger.debug("send websocket request",e),[4,this.commandRouter.send(e)]):[3,2]:[3,4];case 1:case 5:return[2,i.sent()];case 2:if(this.isLazyCallActivated)return this._logger.debug("wait websocket request",e),t=new Yr,this._lazyCallQueue.push({command:e,deferred:t,timeout:setTimeout((function(){return r.timeout(e.requestId)}),1e4)}),[2,t.promise];throw this._logger.debug("fail websocket request"),E.connectionRequired;case 3:return[3,7];case 4:return e instanceof me?this._auth.hasSession?(this._logger.debug("send api request",e),[4,this.commandRouter.send(e)]):[3,6]:[3,7];case 6:if(this.isLazyCallActivated)return this._logger.debug("wait api request",e),t=new Yr,this._lazyCallQueue.push({command:e,deferred:t,timeout:setTimeout((function(){return r.timeout(e.requestId)}),1e4)}),[2,t.promise];throw n=E.connectionRequired,this._logger.debug("fail api request",n),n;case 7:return[2]}}))}))},e.prototype.forceSend=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return this._logger.debug("send forced request",e),[4,this.commandRouter.send(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.timeout=function(e){this._logger.debug("timeout request",e);var t=this._lazyCallQueue.findIndex((function(t){return t.command.requestId===e}));t>-1&&(this._lazyCallQueue[t].deferred.reject(E.connectionRequired),this._lazyCallQueue.splice(t,1))},e.prototype.cancel=function(e){this._logger.debug("cancel api request",e),this.commandRouter.cancel(e)},e.prototype.cancelAll=function(){this._logger.debug("cancel all api requests"),this.commandRouter.cancelAll()},e}(),ei="sendbird@devicetokens",ti=function(){function e(e){var t=e.type,n=e.token;this.type=t,this.token=n}return e.payloadify=function(e){return{type:e.type,token:e.token}},e}(),ni=function(e){function n(t){var n=t.userId,r=t.authToken,i=t.expiringSession,o=void 0===i||i,s=e.call(this)||this;return s.path="".concat(ee,"/").concat(n,"/session_key"),s.method=J.POST,s.params={token:r,expiring_session:!!o},s.requireAuth=!1,s}return t(n,e),n}(me),ri=function(e){function n(t){var n=t.authToken,r=t.expiringSession,i=void 0===r||r,o=t.requestId,s=void 0===o?null:o;return e.call(this,{code:"LOGI",payload:{token:n,expiring_session:i?1:0,req_id:s},ackRequired:!0})||this}return t(n,e),n}(Wr),ii=function(e){function n(t,n){var r=e.call(this,t,n)||this,i=n.key;return r.key=i,r}return t(n,e),n}(ye),oi=function(e){function n(t,n,r){var i=e.call(this,t,"LOGI",r)||this;return i.error=null,i.newKey=r.new_key,i.error=r.error?new E(r.error):null,i}return t(n,e),n}(Ae),si=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n}(Y),ai=function(e){return i(void 0,void 0,void 0,(function(){return o(this,(function(t){return[2,new Promise((function(t){return setTimeout(t,e)}))]}))}))},ci=function(){function e(){}return e.prototype.calcTimeout=function(){return 0},e}(),ui=function(e,t,n){return void 0===n&&(n=new ci),i(void 0,void 0,void 0,(function(){var r,i,s,a,c,u;return o(this,(function(o){switch(o.label){case 0:r=0,i=null,s=function(e){return void 0===e&&(e=null),i=null!=e?e:new Error("Halted")},a=function(){r=0},o.label=1;case 1:if(!(-1===t||r<t))return[3,9];o.label=2;case 2:return o.trys.push([2,4,,8]),[4,e(s,a)];case 3:if(c=o.sent(),i)throw i;return[2,c];case 4:if(u=o.sent(),i)return[3,6];if(++r===t)throw u;return[4,ai(n.calcTimeout(r))];case 5:return o.sent(),[3,7];case 6:throw i;case 7:return[3,8];case 8:return[3,1];case 9:return[2]}}))}))},li=function(e){return i(void 0,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e()];case 1:return n.sent(),[3,3];case 2:if(!((t=n.sent())instanceof E))throw t;return t.throwOutside(),[3,3];case 3:return[2]}}))}))},hi=function(e){return i(void 0,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e()];case 1:case 2:return t.sent(),[3,3];case 3:return[2]}}))}))},di=new WeakMap,_i=function(e){function n(t){var n=t.auth,r=t.cacheContext,i=t.sdkState,o=t.dispatcher,s=t.requestQueue,a=t.logger,c=e.call(this)||this;return c._currentConnectionStateType=Vr.INITIALIZED,c._isRefreshingAuthToken=!1,c._isRefreshingSessionKey=!1,c.auth=n,c._cacheContext=r,c._sdkState=i,c._dispatcher=o,c._requestQueue=s,c._logger=a,c._deviceTokens=[],c._dispatcher.on((function(e){var t;if(e instanceof Jr){var n=e.stateType;c._currentConnectionStateType=n}else e instanceof Se&&c.handler&&(e.invalidateSessionToken&&(c.auth.authToken=void 0),e.error&&(e.error.isSessionKeyExpiredError||e.error.isSessionTokenExpiredError)&&(c._logger.debug("session expired"),(null===(t=c.handler)||void 0===t?void 0:t.onSessionExpired)&&c.handler.onSessionExpired(),c.refresh()))})),c}return t(n,e),Object.defineProperty(n.prototype,"ekey",{get:function(){return di.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"deviceTokens",{get:function(){return this._deviceTokens},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"deviceTokenLastDeletedAt",{get:function(){return this._deviceTokenLastDeletedAt},enumerable:!1,configurable:!0}),n.prototype.indexOfDeviceToken=function(e,t){return this._deviceTokens.findIndex((function(n){return n.type===e&&n.token===t}))},n.prototype.hasDeviceToken=function(e,t){return this.indexOfDeviceToken(e,t)>=0},n.prototype.createRefreshWebsocketCommand=function(e,t){return void 0===t&&(t=null),new ri({authToken:e,expiringSession:!0,requestId:t})},n.prototype._refreshSessionKeyByWebSocket=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i,s;return o(this,(function(o){switch(o.label){case 0:return t=this.createRefreshWebsocketCommand(e),[4,this._requestQueue.forceSend(t)];case 1:if(n=o.sent(),r=n.as(oi),i=r.newKey,s=r.error)throw s;return this.auth.sessionKey=null!=i?i:this.auth.sessionKey,[2]}}))}))},n.prototype._refreshSessionKeyByApi=function(e){return i(this,void 0,void 0,(function(){var t,n=this;return o(this,(function(r){switch(r.label){case 0:return t=new ni({userId:this._sdkState.userId,authToken:e,expiringSession:!0}),[4,ui((function(e){return i(n,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this._requestQueue.forceSend(t)];case 1:return n=o.sent(),r=n.as(ii).key,this.auth.sessionKey=r,[3,3];case 2:if(i=o.sent(),!this._isSessionRelatedError(i))throw i;return e(i),[3,3];case 3:return[2]}}))}))}),3)];case 1:return r.sent(),[2]}}))}))},n.prototype._refreshSessionKey=function(e,t){return void 0===t&&(t=!0),i(this,void 0,void 0,(function(){var n,r,i,s;return o(this,(function(o){switch(o.label){case 0:if(this._currentConnectionStateType!==Vr.CONNECTED)return[3,10];o.label=1;case 1:return o.trys.push([1,3,,10]),[4,this._refreshSessionKeyByWebSocket(e)];case 2:return o.sent(),this.complete(),[2];case 3:return n=o.sent(),this._isSessionRelatedError(n)?t?(r=this.auth,[4,this._receiveNewAuthToken()]):[3,9]:[3,9];case 4:return r.authToken=o.sent(),this.auth.authToken?[4,this._refreshSessionKey(this.auth.authToken,!1)]:[3,6];case 5:return o.sent(),this.complete(),[3,8];case 6:return[4,this.clear()];case 7:o.sent(),this.close(),o.label=8;case 8:return[2];case 9:return[3,10];case 10:return o.trys.push([10,12,,22]),[4,this._refreshSessionKeyByApi(e)];case 11:return o.sent(),this.complete(),[3,22];case 12:return i=o.sent(),this._isSessionRelatedError(i)?t?(s=this.auth,[4,this._receiveNewAuthToken()]):[3,18]:[3,20];case 13:return s.authToken=o.sent(),this.auth.authToken?[4,this._refreshSessionKeyByApi(this.auth.authToken)]:[3,15];case 14:return o.sent(),this.complete(),[3,17];case 15:return[4,this.clear()];case 16:o.sent(),this.close(),o.label=17;case 17:return[3,19];case 18:throw i;case 19:return[3,21];case 20:throw i;case 21:return[3,22];case 22:return[2]}}))}))},n.prototype._receiveNewAuthToken=function(){var e=this,t=new Yr;return li((function(){return i(e,void 0,void 0,(function(){var e,n,r=this;return o(this,(function(i){return this._isRefreshingAuthToken=!0,this.auth.clear(),e=null,n=function(){e&&(clearTimeout(e),e=null)},e=setTimeout((function(){r._isRefreshingAuthToken=!1,t.reject()}),1e3*this._sdkState.sessionTokenRefreshTimeout),this.handler.onSessionTokenRequired?this.handler.onSessionTokenRequired((function(e){n(),r._isRefreshingAuthToken&&(r._isRefreshingAuthToken=!1,r.dispatch("refresh-authtoken"),t.resolve(e))}),(function(e){n(),r._isRefreshingAuthToken=!1,t.reject(e)})):t.resolve(null),[2]}))}))})),t.promise},n.prototype._isSessionRelatedError=function(e){return e instanceof E&&(e.isSessionKeyExpiredError||e.isSessionTokenExpiredError||e.isSessionRevokedError)},Object.defineProperty(n.prototype,"isSessionKeyRefreshing",{get:function(){return this._isRefreshingSessionKey},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isRefreshingAuthToken",{get:function(){return this._isRefreshingAuthToken},enumerable:!1,configurable:!0}),n.prototype.login=function(e){var t;return i(this,void 0,void 0,(function(){var n,r,i,s,a,c,u;return o(this,(function(o){switch(o.label){case 0:return n=e.key,r=e.ekey,i=e.userProfile,s=e.deviceTokenLastDeletedAt,a=void 0===s?0:s,this.auth.sessionKey=n,di.set(this,r),this._deviceTokenCacheEnabled=null===(t=null==i?void 0:i.appInfo)||void 0===t?void 0:t.deviceTokenCache,c=this._cacheContext.preference,this._deviceTokenCacheEnabled?[4,c.get(ei)]:[3,5];case 1:return!(u=o.sent())||u.lastDeletedAt<a?(this._deviceTokens=[],this._deviceTokenLastDeletedAt=a,[4,this.saveDeviceToken()]):[3,3];case 2:return o.sent(),[3,4];case 3:this._deviceTokens=u.tokens.map((function(e){return new ti(ti.payloadify(e))})),this._deviceTokenLastDeletedAt=u.lastDeletedAt,o.label=4;case 4:return[3,7];case 5:return[4,c.remove(ei)];case 6:o.sent(),o.label=7;case 7:return[2]}}))}))},n.prototype.complete=function(){var e=this;this.dispatch("refresh"),li((function(){return i(e,void 0,void 0,(function(){var e;return o(this,(function(t){return this._logger.debug("session refreshed"),(null===(e=this.handler)||void 0===e?void 0:e.onSessionRefreshed)&&this.handler.onSessionRefreshed(),[2]}))}))}))},n.prototype.error=function(e){var t=this;li((function(){return i(t,void 0,void 0,(function(){var t;return o(this,(function(n){return(null===(t=this.handler)||void 0===t?void 0:t.onSessionError)&&this.handler.onSessionError(e),[2]}))}))}))},n.prototype.close=function(){var e=this;this.dispatch("close"),li((function(){return i(e,void 0,void 0,(function(){var e;return o(this,(function(t){return this._logger.debug("session closed"),(null===(e=this.handler)||void 0===e?void 0:e.onSessionClosed)&&this.handler.onSessionClosed(),[2]}))}))}))},n.prototype.refresh=function(){return i(this,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:if(!this.handler)return[3,10];if(this._isRefreshingSessionKey)return[3,10];if(this._isRefreshingSessionKey=!0,this.auth.authToken)return[3,7];n.label=1;case 1:return n.trys.push([1,6,,7]),[4,this._receiveNewAuthToken()];case 2:return(e=n.sent())?(this._logger.debug("session refreshing.."),this.auth.authToken=e,[3,5]):[3,3];case 3:return[4,this.clear()];case 4:return n.sent(),this._isRefreshingSessionKey=!1,[2];case 5:return[3,7];case 6:throw n.sent(),t=E.sessionTokenRequestFailed,this._dispatcher.dispatch(new si),this.error(t),this._isRefreshingSessionKey=!1,t;case 7:return n.trys.push([7,9,,10]),[4,this._refreshSessionKey(this.auth.authToken)];case 8:return n.sent(),this._isRefreshingSessionKey=!1,[3,10];case 9:throw n.sent(),t=E.sessionTokenRefreshFailed,this._dispatcher.dispatch(new si),this.error(t),this._isRefreshingSessionKey=!1,t;case 10:return[2]}}))}))},n.prototype.setDeviceToken=function(e,t){if(this._deviceTokenCacheEnabled&&this.indexOfDeviceToken(e,t)<0)return this._deviceTokens.push(new ti({type:e,token:t})),!0;return!1},n.prototype.unsetDeviceToken=function(e,t){if(this._deviceTokenCacheEnabled){var n=this.indexOfDeviceToken(e,t);n>=0&&this._deviceTokens.splice(n,1)}},n.prototype.unsetDeviceTokens=function(e){this._deviceTokenCacheEnabled&&(this._deviceTokens=e?this._deviceTokens.filter((function(t){return t.type!==e})):[])},n.prototype.setDeviceTokenDeletedAt=function(e){e>0&&(this._deviceTokenLastDeletedAt=e)},n.prototype.saveDeviceToken=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return this._deviceTokenCacheEnabled?[4,this._cacheContext.preference.set(ei,{tokens:this._deviceTokens,lastDeletedAt:this._deviceTokenLastDeletedAt})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},n.prototype.clear=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return this.currentUser=null,this.auth.clear(),this.close(),di.delete(this),this._deviceTokens=[],this._deviceTokenLastDeletedAt=0,[4,this.saveDeviceToken()];case 1:return e.sent(),[2]}}))}))},n}(W),fi=function(){function e(){this.type=Vr.NONE,this.name="none"}return e.prototype.run=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(e){return[2]}))}))},e.prototype.onConnect=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(e){return[2]}))}))},e.prototype.onReconnect=function(e,t){return t.resetReconnectCount,i(this,void 0,void 0,(function(){return o(this,(function(e){return[2]}))}))},e.prototype.onDisconnect=function(e,t){return t.error,t.autoReconnect,i(this,void 0,void 0,(function(){return o(this,(function(e){return[2]}))}))},e.prototype.onDisconnectWebSocket=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(e){return[2]}))}))},e.prototype.onLogout=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(e){return[2]}))}))},e}(),pi=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Vr.LOGOUT,t.name="logout",t}return t(n,e),n.prototype.run=function(e){return i(this,void 0,void 0,(function(){var t,n,r=this;return o(this,(function(s){switch(s.label){case 0:return t=Date.now(),n=e.sdkState.userId,[4,e.logout()];case 1:return s.sent(),[4,e.changeState(new yi,t)];case 2:return s.sent(),li((function(){return i(r,void 0,void 0,(function(){return o(this,(function(t){return e.connectionHandlers.forEach((function(e){e.onDisconnected(n)})),[2]}))}))})),[2]}}))}))},n}(fi),gi=function(e){function n(){var t=e.call(this)||this;return t.type=Vr.EXTERNAL_DISCONNECTED,t.name="externaldisconnected",t}return t(n,e),n.prototype.run=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,e.disconnect()];case 1:return t.sent(),[2]}}))}))},n.prototype.onConnect=function(e,t){return i(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return n=Date.now(),[4,e.disconnect()];case 1:return r.sent(),[4,e.changeState(new mi({authToken:t}),n)];case 2:return r.sent(),[2]}}))}))},n.prototype.onReconnect=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Ei,t)];case 1:return n.sent(),[2]}}))}))},n.prototype.onLogout=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new pi,t)];case 1:return n.sent(),[2]}}))}))},n}(fi),vi=function(e){function n(t){var n=t.autoReconnect,r=e.call(this)||this;return r.type=Vr.INTERNAL_DISCONNECTED,r.name="internaldisconnected",r._autoReconnect=!1,r._autoReconnect=n,r}return t(n,e),n.prototype.run=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.disconnect()];case 1:return n.sent(),this._autoReconnect?[4,e.changeState(new Ei,t)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},n.prototype.onConnect=function(e,t){return i(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return n=Date.now(),[4,e.disconnect()];case 1:return r.sent(),[4,e.changeState(new mi({authToken:t}),n)];case 2:return r.sent(),[2]}}))}))},n.prototype.onReconnect=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Ei,t)];case 1:return n.sent(),[2]}}))}))},n.prototype.onDisconnectWebSocket=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new gi,t)];case 1:return n.sent(),[2]}}))}))},n.prototype.onLogout=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new pi,t)];case 1:return n.sent(),[2]}}))}))},n}(fi),Ei=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Vr.RECONNECTING,t.name="reconnecting",t._haltConnect=null,t._resetConnect=null,t._callbacks=[],t}return t(n,e),n.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=null)},n.prototype._flushCallbacks=function(e){void 0===e&&(e=null),this._haltConnect=null,this._resetConnect=null,this._callbacks.forEach((function(t){return t(e)}))},n.prototype.run=function(e){return i(this,void 0,void 0,(function(){var t,n,r,s,a,c,l=this;return o(this,(function(h){switch(h.label){case 0:t=Date.now(),n=new Yr,this._callbacks.push((function(e){return e?n.reject(e):n.resolve()})),li((function(){return i(l,void 0,void 0,(function(){return o(this,(function(t){return e.connectionHandlers.forEach((function(e){e.onReconnectStarted()})),[2]}))}))})),h.label=1;case 1:return h.trys.push([1,4,,9]),r=e.sdkState.websocket,s=r.reconnectMaxRetry,a=r.reconnectRetryStrategy,[4,ui((function(t,n){return i(l,void 0,void 0,(function(){var r;return o(this,(function(i){switch(i.label){case 0:this._haltConnect=t,this._resetConnect=n,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.connect()];case 2:return i.sent(),[3,4];case 3:if(r=i.sent(),e.clearLoginTimer(),r instanceof E&&r.code===u.CONNECTION_CANCELED)return t(r),[2];throw r;case 4:return[2]}}))}))}),s,a)];case 2:return h.sent(),[4,e.changeState(new bi,t)];case 3:return h.sent(),li((function(){return i(l,void 0,void 0,(function(){return o(this,(function(t){return this._flushCallbacks(null),e.connectionHandlers.forEach((function(e){e.onReconnectSucceeded()})),[2]}))}))})),[3,9];case 4:return c=h.sent(),v(c)?[3,7]:c instanceof E?c.code===u.CONNECTION_CANCELED?[3,6]:[4,e.changeState(new vi({autoReconnect:!1}),t)]:[3,6];case 5:h.sent(),h.label=6;case 6:return li((function(){return i(l,void 0,void 0,(function(){return o(this,(function(t){return this._flushCallbacks(c),e.connectionHandlers.forEach((function(e){e.onReconnectFailed()})),[2]}))}))})),[3,8];case 7:throw c;case 8:return[3,9];case 9:return[2,n.promise]}}))}))},n.prototype.onConnect=function(e,t){return i(this,void 0,void 0,(function(){var n;return o(this,(function(r){return n=new Yr,this._halt(E.connectionCanceled),e.cancelConnectForRetry(),this._callbacks.push((function(){var r=Date.now();e.changeState(new mi({authToken:t}),r).then((function(){n.resolve()})).catch((function(e){n.reject(e)}))})),[2,n.promise]}))}))},n.prototype.onReconnect=function(e,t){var n=t.resetReconnectCount,r=void 0!==n&&n;return i(this,void 0,void 0,(function(){var e;return o(this,(function(t){return e=new Yr,this._resetConnect&&r&&this._resetConnect(),this._callbacks.push((function(t){return t?e.reject(t):e.resolve()})),[2,e.promise]}))}))},n.prototype.onDisconnect=function(e,t){t.error;var n=t.autoReconnect,r=void 0===n||n;return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(E.connectionCanceled),[4,e.changeState(new vi({autoReconnect:r}),t)];case 1:return n.sent(),[2]}}))}))},n.prototype.onDisconnectWebSocket=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(E.connectionCanceled),[4,e.changeState(new gi,t)];case 1:return n.sent(),[2]}}))}))},n.prototype.onLogout=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(E.connectionCanceled),[4,e.changeState(new pi,t)];case 1:return n.sent(),[2]}}))}))},n}(fi),bi=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Vr.CONNECTED,t.name="connected",t}return t(n,e),n.prototype.onReconnect=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.disconnect()];case 1:return n.sent(),[4,e.changeState(new Ei,t)];case 2:return n.sent(),[2]}}))}))},n.prototype.onDisconnect=function(e,t){var n=t.autoReconnect;return i(this,void 0,void 0,(function(){var t;return o(this,(function(r){switch(r.label){case 0:return t=Date.now(),[4,e.changeState(new vi({autoReconnect:n}),t)];case 1:return r.sent(),[2]}}))}))},n.prototype.onDisconnectWebSocket=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new gi,t)];case 1:return n.sent(),[2]}}))}))},n.prototype.onLogout=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new pi,t)];case 1:return n.sent(),[2]}}))}))},n}(fi),mi=function(e){function n(t){var n=t.authToken,r=e.call(this)||this;return r.type=Vr.CONNECTING,r.name="connecting",r._authToken="",r._haltConnect=null,r._callbacks=[],r._authToken=n,r}return t(n,e),n.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=null)},n.prototype._flushCallbacks=function(e){void 0===e&&(e=null),this._haltConnect=null,this._callbacks.forEach((function(t){return t(e)}))},n.prototype.run=function(e){return i(this,void 0,void 0,(function(){var t,n,r,s=this;return o(this,(function(a){switch(a.label){case 0:t=Date.now(),n=new Yr,this._callbacks.push((function(e){return e?n.reject(e):n.resolve()})),a.label=1;case 1:return a.trys.push([1,4,,10]),[4,ui((function(t){return i(s,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:this._haltConnect=t,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.connect(this._authToken)];case 2:return r.sent(),[3,4];case 3:if(n=r.sent(),e.clearLoginTimer(),n instanceof E&&n.code===u.CONNECTION_CANCELED)return t(n),[2];throw n;case 4:return[2]}}))}))}),e.sdkState.websocket.connectMaxRetry)];case 2:return a.sent(),[4,e.changeState(new bi,t)];case 3:return a.sent(),li((function(){return i(s,void 0,void 0,(function(){return o(this,(function(t){return this._flushCallbacks(null),e.connectionHandlers.forEach((function(t){t.onConnected(e.sdkState.userId)})),[2]}))}))})),[3,10];case 4:return r=a.sent(),v(r)?[3,8]:[4,e.disconnect()];case 5:return a.sent(),r instanceof E?r.code===u.CONNECTION_CANCELED?[3,7]:[4,e.changeState(new yi,t)]:[3,7];case 6:a.sent(),a.label=7;case 7:return li((function(){return i(s,void 0,void 0,(function(){return o(this,(function(e){return this._flushCallbacks(r),[2]}))}))})),[3,9];case 8:throw r;case 9:return[3,10];case 10:return[2,n.promise]}}))}))},n.prototype.onConnect=function(e){return i(this,void 0,void 0,(function(){var e;return o(this,(function(t){return e=new Yr,this._callbacks.push((function(t){return t?e.reject(t):e.resolve()})),[2,e.promise]}))}))},n.prototype.onDisconnect=function(e,t){var n=t.error,r=void 0===n?null:n,s=t.autoReconnect;return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(null!=r?r:E.connectionCanceled),e.hasSession?[4,e.changeState(new vi({autoReconnect:s}),t)]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,e.changeState(new pi,t)];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},n.prototype.onDisconnectWebSocket=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(E.connectionCanceled),e.hasSession?[4,e.changeState(new gi,t)]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,e.changeState(new pi,t)];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},n.prototype.onLogout=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(E.connectionCanceled),[4,e.changeState(new pi,t)];case 1:return n.sent(),[2]}}))}))},n}(fi),yi=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Vr.INITIALIZED,t.name="initialized",t}return t(n,e),n.prototype.onConnect=function(e,t){return i(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return n=Date.now(),[4,e.changeState(new mi({authToken:t}),n)];case 1:return r.sent(),[2]}}))}))},n}(fi),wi=function(e){function n(){return e.call(this,{code:"PING",payload:{id:Date.now(),active:1},ackRequired:!1})||this}return t(n,e),n}(Wr),Si=function(){function e(e){var t=e.pingDelegate,n=e.sdkState,r=e.logger;this._pingTimer=null,this._pingTimeoutTimer=null,this.pingDelegate=t,this.sdkState=n,this._logger=r}return Object.defineProperty(e.prototype,"isWaiting",{get:function(){return!!this._pingTimeoutTimer},enumerable:!1,configurable:!0}),e.prototype.ping=function(){var e,t=this,n=new wi;try{var r=null!==(e=this.sdkState.websocket.pongTimeout)&&void 0!==e?e:5e3;this._pingTimeoutTimer=setTimeout((function(){t._logger.debug("pinger.ping() timeout"),t.pingDelegate.error(null)}),r),this.pingDelegate.send(n),this._logger.debug("pinger.ping()")}catch(e){this._logger.debug("pinger.ping() error",e),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=null),this.pingDelegate.error(null)}return n},e.prototype.pong=function(){this._logger.debug("pinger.pong()"),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=null)},e.prototype.refreshTimer=function(){var e,t=this;this._logger.debug("pinger.refreshTimer()");var n=null!==(e=this.sdkState.websocket.pingInterval)&&void 0!==e?e:15e3;this.stop(),this._pingTimer=setInterval((function(){t.ping()}),n)},e.prototype.start=function(){this._logger.debug("pinger.start()"),this.refreshTimer(),this.ping()},e.prototype.stop=function(){this._logger.debug("pinger.stop()"),this._pingTimer&&(clearInterval(this._pingTimer),this._pingTimer=null),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=null)},e}(),ki=function(){function e(e){var t;this.lastUpdatedAt=null!==(t=e.last_updated_at)&&void 0!==t?t:0}return e.payloadify=function(e){return X({last_updated_at:e.lastUpdatedAt})},e}(),Ti=1048576,Ci=5,Oi=function(){function e(e){var t,n,r,i,o;void 0===e&&(e={}),this.emojiHash=e.emoji_hash||"",this.uploadSizeLimit=e.file_upload_size_limit?e.file_upload_size_limit*Ti:Number.MAX_SAFE_INTEGER,this.useReaction=!!e.use_reaction,this.applicationAttributes=null!==(t=e.application_attributes)&&void 0!==t?t:[],this.premiumFeatureList=null!==(n=e.premium_feature_list)&&void 0!==n?n:[],this.deviceTokenCache=this.applicationAttributes.includes("sdk_device_token_cache"),this.enabledChannelMemberShipHistory=this.applicationAttributes.includes("channel_membership_history"),this.multipleFilesMessageFileCountLimit=null!==(r=e.multiple_file_send_max_size)&&void 0!==r?r:5,this.allowSdkStatsUpload=null===(i=e.allow_sdk_log_ingestion)||void 0===i||i,this.uikitConfigInfo=new ki(null!==(o=e.uikit_config)&&void 0!==o?o:{})}return e.payloadify=function(e){return{emoji_hash:e.emojiHash,file_upload_size_limit:e.uploadSizeLimit/Ti,application_attributes:e.applicationAttributes,premium_feature_list:e.premiumFeatureList,use_reaction:e.useReaction,allow_sdk_log_ingestion:e.allowSdkStatsUpload,uikit_config:e.uikitConfigInfo?ki.payloadify(e.uikitConfigInfo):void 0}},e}(),Ai=function(){function e(e){this._iid="",this._iid=e}return e.payloadify=function(e){return e?{}:null},e}(),Ni=function(e){function n(t){var n=t.userId,r=t.metadata,i=e.call(this)||this;return i.method=J.POST,i.path="".concat(ee,"/").concat(n,"/metadata"),i.params={metadata:r},i}return t(n,e),n}(me),Ii=function(e){function n(t,n){var r=e.call(this,t,n)||this;return r.metaData=n,r}return t(n,e),n}(ye),Ri=function(e){function n(t){var n=t.userId,r=t.metadata,i=t.upsert,o=e.call(this)||this;return o.method=J.PUT,o.path="".concat(ee,"/").concat(n,"/metadata"),o.params={metadata:r,upsert:i},o}return t(n,e),n}(me),Di=function(e){function n(t,n){var r=e.call(this,t,n)||this;return r.metadata=n,r}return t(n,e),n}(ye),Li=function(e){function n(t){var n=t.userId,r=t.metadataKey,i=e.call(this)||this;return i.method=J.DELETE,i.path="".concat(ee,"/").concat(n,"/metadata/").concat(r),i}return t(n,e),n}(me);!function(e){function n(){return null!==e&&e.apply(this,arguments)||this}t(n,e)}(ye);var xi=function(e){function n(t){var n=t.userId,r=e.call(this)||this;return r.method=J.DELETE,r.path="".concat(ee,"/").concat(n,"/metadata"),r}return t(n,e),n}(me);!function(e){function n(){return null!==e&&e.apply(this,arguments)||this}t(n,e)}(ye);var Mi,Pi=function(e,t){void 0===t&&(t=null);var n=JSON.parse(JSON.stringify(e));return n._iid&&delete n._iid,t&&t(n),n},Ui=function(e,t){void 0===t&&(t=null);var n=JSON.parse(JSON.stringify(e));return t&&t(n),n},zi=function(e){return{do:function(t){e||t()},throw:function(t){if(!e)throw t}}};!function(e){e.ONLINE="online",e.OFFLINE="offline",e.NON_AVAILABLE="nonavailable"}(Mi||(Mi={}));var Fi,qi=function(e){function r(t,n){var r,i,o,s,u,l,h,d,_,f,p,g,v=this;return(v=e.call(this,t)||this).userId=null!==(i=null!==(r=n.guest_id)&&void 0!==r?r:n.user_id)&&void 0!==i?i:"",v.nickname=null!==(s=null!==(o=n.nickname)&&void 0!==o?o:n.name)&&void 0!==s?s:"",v.plainProfileUrl=null!==(l=null!==(u=n.profile_url)&&void 0!==u?u:n.image)&&void 0!==l?l:"",v.requireAuth=null!==(h=n.require_auth_for_profile_image)&&void 0!==h&&h,v.metaData=null!==(d=n.metadata)&&void 0!==d?d:{},v.connectionStatus=Mi.NON_AVAILABLE,S(Mi,n.is_online)?v.connectionStatus=n.is_online:w("boolean",n.is_online)&&(v.connectionStatus=n.is_online?Mi.ONLINE:Mi.OFFLINE),v.isActive=null===(_=n.is_active)||void 0===_||_,v.lastSeenAt=null!==(f=n.last_seen_at)&&void 0!==f?f:null,v.preferredLanguages=n.preferred_languages?c([],a(n.preferred_languages),!1):null,v.friendDiscoveryKey=null!==(p=n.friend_discovery_key)&&void 0!==p?p:null,v.friendName=null!==(g=n.friend_name)&&void 0!==g?g:null,v}return t(r,e),r.payloadify=function(t){return t?X(n(n({},e.payloadify.call(this,t)),{user_id:t.userId,nickname:t.nickname,profile_url:t.plainProfileUrl,require_auth_for_profile_image:t.requireAuth,metadata:t.metaData,is_online:t.connectionStatus,is_active:t.isActive,last_seen_at:t.lastSeenAt,preferred_languages:t.preferredLanguages,friend_discovery_key:t.friendDiscoveryKey,friend_name:t.friendName})):null},Object.defineProperty(r.prototype,"profileUrl",{get:function(){var e=to.of(this._iid).sessionManager;return this.requireAuth?"".concat(this.plainProfileUrl,"?auth=").concat(e.ekey):this.plainProfileUrl},enumerable:!1,configurable:!0}),r.prototype.serialize=function(){return Pi(this)},r.prototype._isValidMetaData=function(e){return!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return w("string",e)}))},r.prototype._applyMetaData=function(e,t){var n=this;void 0===t&&(t=!1),Object.keys(e).forEach((function(r){t?delete n.metaData[r]:n.metaData[r]=e[r]}))},r.prototype.createMetaData=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i,s,a;return o(this,(function(o){switch(o.label){case 0:return zi(this._isValidMetaData(e)).throw(E.invalidParameters),t=to.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Ni({userId:n.userId,metadata:e}),[4,r.send(i)];case 1:return s=o.sent(),a=s.as(Ii).metaData,this._applyMetaData(a),[2,this.metaData]}}))}))},r.prototype.updateMetaData=function(e,t){return void 0===t&&(t=!1),i(this,void 0,void 0,(function(){var n,r,i,s,a,c;return o(this,(function(o){switch(o.label){case 0:return zi(this._isValidMetaData(e)).throw(E.invalidParameters),n=to.of(this._iid),r=n.sdkState,i=n.requestQueue,s=new Ri({userId:r.userId,metadata:e,upsert:t}),[4,i.send(s)];case 1:return a=o.sent(),c=a.as(Di).metadata,this._applyMetaData(c),[2,this.metaData]}}))}))},r.prototype.deleteMetaData=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i,s;return o(this,(function(o){switch(o.label){case 0:return zi(w("string",e)).throw(E.invalidParameters),t=to.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Li({userId:n.userId,metadataKey:e}),[4,r.send(i)];case 1:return o.sent(),this._applyMetaData(((s={})[e]=!0,s),!0),[2,this.metaData]}}))}))},r.prototype.deleteAllMetaData=function(){return i(this,void 0,void 0,(function(){var e,t,n,r;return o(this,(function(i){switch(i.label){case 0:return e=to.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new xi({userId:t.userId}),[4,n.send(r)];case 1:return i.sent(),this.metaData={},[2]}}))}))},r}(Ai),Gi=function(e){function n(t){var n=t.userProfile,r=e.call(this)||this;return r.userProfile=n,r}return t(n,e),n}(Y),ji=function(){function e(e,t){var n,r,i,o,s,a,c,u,l,h,d,_,f,p;this._iid=e,this.appInfo=new Oi(t),this.user=new qi(e,t),this.connectedAt=null!==(n=t.login_ts)&&void 0!==n?n:0,this.firstConnectedAt=0,this.pingInterval=null!==(r=t.ping_interval)&&void 0!==r?r:15e3,this.pongTimeout=null!==(i=t.pong_timeout)&&void 0!==i?i:5e3,this.reconnectInterval=null!==(s=null===(o=t.reconnect)||void 0===o?void 0:o.interval)&&void 0!==s?s:3e3,this.reconnectMaxInterval=null!==(c=null===(a=t.reconnect)||void 0===a?void 0:a.max_interval)&&void 0!==c?c:6e4,this.reconnectRetryCount=null!==(l=null===(u=t.reconnect)||void 0===u?void 0:u.retry_cnt)&&void 0!==l?l:5,this.reconnectIntervalMultiple=null!==(d=null===(h=t.reconnect)||void 0===h?void 0:h.mul)&&void 0!==d?d:2,this.maxUnreadCountOnSuperGroup=null!==(_=t.max_unread_cnt_on_super_group)&&void 0!==_?_:100,this.profileImageEncryption=!!t.profile_image_encryption,this.concurrentCallLimit=null!==(f=t.concurrent_call_limit)&&void 0!==f?f:5,this.backOffDelay=null!==(p=t.back_off_delay)&&void 0!==p?p:100}return e.payloadify=function(e){return n(n(n({},qi.payloadify(e.user)),Oi.payloadify(e.appInfo)),{login_ts:e.connectedAt,ping_interval:e.pingInterval,pong_timeout:e.pongTimeout,reconnect:{interval:e.reconnectInterval,max_interval:e.reconnectMaxInterval,retry_cnt:e.reconnectRetryCount,mul:e.reconnectIntervalMultiple},max_unread_cnt_on_super_group:e.maxUnreadCountOnSuperGroup,profile_image_encryption:e.profileImageEncryption,concurrent_call_limit:e.concurrentCallLimit,back_off_delay:e.backOffDelay})},e.prototype.apply=function(){var e=this.reconnectInterval,t=this.reconnectMaxInterval,n=this.reconnectIntervalMultiple,r=to.of(this._iid);r.sdkState.websocket.pingInterval=1e3*this.pingInterval,r.sdkState.websocket.pongTimeout=1e3*this.pongTimeout,r.sdkState.websocket.reconnectMaxRetry=this.reconnectRetryCount,r.sdkState.websocket.reconnectRetryStrategy={calcTimeout:function(r){return r>0?1e3*Math.min(e*Math.pow(n,r-1),t):10}},r.appInfo=this.appInfo,r.sessionManager.currentUser=this.user,r.connectedAt=this.connectedAt,this.firstConnectedAt||(r.firstConnectedAt=this.connectedAt),r.maxSuperGroupChannelUnreadCount=this.maxUnreadCountOnSuperGroup,r.concurrentCallLimit=this.concurrentCallLimit,r.backOffDelay=this.backOffDelay,r.dispatcher.dispatch(new Gi({userProfile:this}))},e}(),Ki=function(e){function r(t,n,r){var i,o=this;return(o=e.call(this,t,n,r)||this).error=null,o.userProfile=new ji(t,r),o.deviceTokenLastDeletedAt=r.device_token_last_deleted_at,o.key=r.key,o.ekey=null!==(i=r.ekey)&&void 0!==i?i:"",o.error=r.error?new E(r):null,o}return t(r,e),r.asError=function(e){return new r(null,"LOGI",n({user_id:null,error:!0},e))},r.prototype.applyTo=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return this.error?[3,4]:(t=to.of(e))?[4,t.sessionManager.login(this)]:[3,2];case 1:return n.sent(),this.userProfile.apply(),[3,3];case 2:throw E.lostInstance;case 3:return[3,5];case 4:throw this.error;case 5:return[2]}}))}))},r}(Ae),Bi=function(e){function r(t){var r=t.request,i=void 0===r||r,o=t.features,s=void 0===o?{}:o,a=t.options,c=void 0===a?{}:a,u=e.call(this)||this;return u.request=i,u.features=n({localCache:!0},s),u.options=n({ingestion:!0},c),u}return t(r,e),r}(Y),Zi=function(e){function n(t,n){var r=n.sdkState,i=n.cacheContext,o=n.connectionHandlers,s=n.sessionManager,a=n.websocketClient,c=n.dispatcher,u=n.logger,l=n.entryState,h=void 0===l?new yi:l,d=e.call(this)||this;return d._currentState=null,d._loginTimer=null,d._logiProcessingTimer=null,d._unresolvedLogi=null,d._stateUpdatedAt=0,d._connectingAt=0,d._connectionRequestQueue=[],d._iid=t,d.sdkState=r,d.cacheContext=i,d.connectionHandlers=o,d._sessionManager=s,d._websocketClient=a,d._dispatcher=c,d._logger=u,d._currentState=h,d.sdkState.websocket.pingerDisabled||(d._pinger=new Si({pingDelegate:{send:function(e){return d._websocketClient.send(e)},error:function(e){return d._websocketClient.error(e)}},sdkState:d.sdkState,logger:u})),d._websocketClient.on("open",(function(){d._tryResolveConnectionRequest()})).on("message",(function(e){if("LOGI"===e.code)d.clearLoginTimer(),d._dispatcher.dispatch(e.as(Ki))})).on("ping-refresh",(function(){var e;return null===(e=d._pinger)||void 0===e?void 0:e.refreshTimer()})).on("pong",(function(){var e;return null===(e=d._pinger)||void 0===e?void 0:e.pong()})).on("error",(function(){var e;return null===(e=d._pinger)||void 0===e?void 0:e.stop()})).on("close",(function(){d._logiProcessingTimer=setTimeout((function(){d._logiProcessingTimer=null,d._unresolvedLogi||d._rejectConnectionRequest(E.networkError)}),500)})),d._dispatcher.on((function(e){e instanceof Ki&&(d._unresolvedLogi=e,d._tryResolveConnectionRequest())})),d}return t(n,e),Object.defineProperty(n.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasSession",{get:function(){return this._sessionManager.auth.hasSession},enumerable:!1,configurable:!0}),n.prototype.changeState=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return t>=this._stateUpdatedAt?(this._currentState=e,this._stateUpdatedAt=t,this._dispatcher.dispatch(new Jr({stateType:e.type})),this._logger.debug("connection state changes to ".concat(e.name)),[4,this._currentState.run(this)]):[3,2];case 1:return n.sent(),[2,!0];case 2:return[2,!1]}}))}))},n.prototype._tryResolveConnectionRequest=function(){var e;return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return t=this._unresolvedLogi,this._websocketClient.isOpen&&t?(this._unresolvedLogi=null,t.error?[3,2]:[4,t.applyTo(this._iid)]):[3,3];case 1:return r.sent(),n=t.userProfile,this._enableStatLog({request:n.appInfo.applicationAttributes.includes("allow_sdk_request_log_publish"),features:{localCache:n.appInfo.applicationAttributes.includes("allow_sdk_feature_local_cache_log_publish")},options:{ingestion:n.appInfo.allowSdkStatsUpload}}),this._statLogConnection(null),null===(e=this._pinger)||void 0===e||e.start(),this._connectionRequestQueue.forEach((function(e){return e.resolve()})),this._connectionRequestQueue=[],this.sdkState.appState="foreground",[3,3];case 2:this._sessionManager.auth.authToken=null,(t.error.isSessionKeyExpiredError||t.error.isSessionTokenExpiredError)&&this._dispatcher.dispatch(new Se({reason:t.error.code})),this._rejectConnectionRequest(t.error),r.label=3;case 3:return[2]}}))}))},n.prototype._rejectConnectionRequest=function(e){var t;if(null===(t=this._pinger)||void 0===t||t.stop(),this.clearLoginTimer(),this._connectionRequestQueue.length>0){var n=this._connectionRequestQueue;this._connectionRequestQueue=[],n.forEach((function(t){return t.reject(e)})),this._statLogConnection(e)}},n.prototype._url=function(e){var t;void 0===e&&(e="");var n=this.sdkState,r=n.appId,i=n.appVersion,o=n.userId,s=n.extensions,a=this.cacheContext.localCacheEnabled,c=this._sessionManager.auth,u=null===(t=this.sdkState.websocket)||void 0===t?void 0:t.compression,l=!!this.sdkState.extensions.sb_uikit,d=s.sb_syncmanager?"s".concat(s.sb_syncmanager):"",_=s.sb_uikit?"u".concat(s.sb_uikit):"",f="JS/c".concat(h.SDK_VERSION,"/").concat(d,"/").concat(_);return"".concat(this.sdkState.websocket.host,"/?p=JS&pv=").concat(encodeURIComponent(h.OS_VERSION),"&sv=").concat(encodeURIComponent(h.SDK_VERSION),"&ai=").concat(r).concat(i?"&av=".concat(i):"").concat(c.hasSession?"&key=".concat(encodeURIComponent(c.sessionKey)):"&user_id=".concat(encodeURIComponent(o),"&access_token=").concat(encodeURIComponent(e)),"&pmce=").concat(u?1:0,"&active=1&device_token_types=").concat(encodeURIComponent(["gcm","huawei","apns"].join(",")),"&SB-User-Agent=").concat(f,"&Request-Sent-Timestamp=").concat(Date.now().toString(),"&include_extra_data=").concat(encodeURIComponent(String(["premium_feature_list","file_upload_size_limit","application_attributes","emoji_hash","multiple_file_send_max_size"]))).concat(this._sessionManager.handler?"&expiring_session=1":"","&use_local_cache=").concat(a?1:0,"&include_poll_details=1").concat(l?"&uikit_config=1":"")},n.prototype._enableStatLog=function(e){var t=e.request,n=e.features,r=e.options,i=void 0===r?{}:r;this._dispatcher.dispatch(new Bi({request:t,features:n,options:i}))},n.prototype._statLogConnection=function(e){this._dispatcher.dispatch(new ke(new Te({type:be.WEBSOCKET_CONNECT,data:{host_url:this.sdkState.websocket.host,success:!e,latency:Date.now()-this._connectingAt,error_code:null==e?void 0:e.code,error_description:null==e?void 0:e.message}})))},n.prototype.connect=function(e){return void 0===e&&(e=""),i(this,void 0,void 0,(function(){var t,n,r=this;return o(this,(function(i){return this._logiProcessingTimer&&(clearTimeout(this._logiProcessingTimer),this._logiProcessingTimer=null,this._rejectConnectionRequest(E.connectionCanceled)),t=this._url(e),n=new Yr,this._connectionRequestQueue.push(n),1===this._connectionRequestQueue.length&&(this._connectingAt=Date.now(),this._loginTimer=setTimeout((function(){r._loginTimer=null,r._rejectConnectionRequest(E.loginTimeout)}),this.sdkState.websocket.responseTimeout),e&&(this._sessionManager.auth.authToken=e),this._websocketClient.connect(t)),[2,n.promise]}))}))},n.prototype.cancelConnectForRetry=function(){this._dispatcher.dispatch(Ki.asError(E.connectionRenew))},n.prototype.disconnect=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,this._websocketClient.disconnect()];case 1:return e.sent(),[2]}}))}))},n.prototype.logout=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return this.sdkState.userId=null,this._unresolvedLogi=null,[4,this._sessionManager.clear()];case 1:return e.sent(),[4,this.disconnect()];case 2:return e.sent(),[2]}}))}))},n.prototype.clearLoginTimer=function(){this._loginTimer&&(clearTimeout(this._loginTimer),this._loginTimer=null)},n}(W),Vi=function(){function e(e,t){var n=t.sdkState,r=t.cacheContext,i=t.connectionHandlers,o=t.sessionManager,s=t.websocketClient,a=t.dispatcher,c=t.logger,u=t.disableWebSocketCloseEventHandling,l=void 0!==u&&u;this._context=null,this._disableWebSocketCloseEventHandling=!1,this._externalCalledWebSocketClose=!1,this._logger=c,this._disableWebSocketCloseEventHandling=l,this._context=new Zi(e,{sdkState:n,cacheContext:r,connectionHandlers:i,sessionManager:o,websocketClient:s,dispatcher:a,logger:c}),this._sdkState=n,this._sessionManager=o,this._websocketClient=s}return e.prototype._registerEventDispatcher=function(){var e=this;this._disableWebSocketCloseEventHandling||(this._clearEventDispatcher(),this._sessionEventDispatcherContext=this._sessionManager.on("refresh-authtoken",(function(){e.isConnected||(e._logger.debug("try reconnect by session token refresh"),e.reconnect())})).on("refresh",(function(){e.isConnecting||e.isConnected||(e._logger.debug("try reconnect by session key refresh"),e.reconnect())})),this._websocketEventDispatcherContext=this._websocketClient.on("close",(function(){"foreground"!==e._sdkState.appState||e._externalCalledWebSocketClose||e._sessionManager.isRefreshingAuthToken||(e._logger.debug("try reconnect by websocket connection closed"),e.reconnect())})))},e.prototype._clearEventDispatcher=function(){this._sessionEventDispatcherContext&&(this._sessionEventDispatcherContext.close(),this._sessionEventDispatcherContext=null),this._websocketEventDispatcherContext&&(this._websocketEventDispatcherContext.close(),this._websocketEventDispatcherContext=null)},Object.defineProperty(e.prototype,"isConnected",{get:function(){return this._context.currentState.type===Vr.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConnecting",{get:function(){var e=this._context.currentState;return e.type===Vr.CONNECTING||e.type===Vr.RECONNECTING},enumerable:!1,configurable:!0}),e.prototype.connect=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t=this._context.currentState,this._externalCalledWebSocketClose=!1,[4,t.onConnect(this._context,e)];case 1:return n.sent(),this._registerEventDispatcher(),[2]}}))}))},e.prototype.reconnect=function(){return i(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._externalCalledWebSocketClose=!1,[4,e.onReconnect(this._context,{})];case 1:return t.sent(),[2]}}))}))},e.prototype.resetAndReconnect=function(){return i(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._externalCalledWebSocketClose=!1,[4,e.onReconnect(this._context,{resetReconnectCount:!0})];case 1:return t.sent(),[2]}}))}))},e.prototype.background=function(){return i(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._externalCalledWebSocketClose=!0,[4,e.onDisconnect(this._context,{autoReconnect:!1})];case 1:return t.sent(),[2]}}))}))},e.prototype.disconnect=function(e){return void 0===e&&(e=null),i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this._context.currentState.onDisconnect(this._context,{error:e,autoReconnect:!0})];case 1:return t.sent(),[2]}}))}))},e.prototype.disconnectWebSocket=function(){return i(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._externalCalledWebSocketClose=!0,[4,e.onDisconnectWebSocket(this._context)];case 1:return t.sent(),[2]}}))}))},e.prototype.logout=function(){return i(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._clearEventDispatcher(),[4,e.onLogout(this._context)];case 1:return t.sent(),[2]}}))}))},e}(),Hi=function(e){function n(t){var n,r,i,o,s=t.type,a=t.data,c=t.ts,u=void 0===c?Date.now():c,l=e.call(this,{type:s,data:a,ts:u})||this;return l.date=new Date(u),l.key="".concat((n=l.date,r=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0"),o=String(n.getDate()).padStart(2,"0"),"".concat(r).concat(i).concat(o)),"_").concat(s),l}return t(n,e),n}(Te),Wi=function(e){function n(t){var n=t.deviceId,r=t.statLogs,i=e.call(this)||this;return i.method=J.POST,i.path="".concat(_e),i.params={device_id:n,log_entries:r.map((function(e){return Te.payloadify(e)}))},i}return t(n,e),n}(me),Qi=function(e,t){var n,r;if(null!==e&&null!==t){var i=Object.keys(e),o=Object.keys(t),u=c([],a(new Set(c(c([],a(i),!1),a(o),!1))),!1),l={};try{for(var h=s(u),d=h.next();!d.done;d=h.next()){var _=d.value,f=typeof e[_],p=typeof t[_];"undefined"===f?l[_]=t[_]:"undefined"===p?l[_]=e[_]:f!==p?l[_]=t[_]:"object"===f&&e[_]&&t[_]?l[_]=Qi(e[_],t[_]):l[_]=t[_]}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}return l}return t};!function(e){e[e.PENDING=0]="PENDING",e[e.COLLECT_ONLY=1]="COLLECT_ONLY",e[e.ENABLED=2]="ENABLED",e[e.DISABLED=3]="DISABLED"}(Fi||(Fi={}));var Yi,Xi=function(e){function n(t){var n=t.cacheContext,r=t.requestQueue,i=t.dispatcher,o=t.baseLimit,s=void 0===o?100:o,a=t.maxLimit,c=void 0===a?1e3:a,u=t.minLimit,l=void 0===u?10:u,h=e.call(this)||this;return h.queue=[],h.enabledState=Fi.PENDING,h.isFlushing=!1,h.generation=1,h.lastFlushedAt=0,h.commandEventContext=null,h._collectRequestStat=!0,h._collectFeatureLocalCacheStat=!0,h.deviceId=V(),h.cacheContext=n,h.requestQueue=r,h.dispatcher=i,h.baseLimit=s,h.limit=s,h.maxLimit=c,h.minLimit=l,h}return t(n,e),Object.defineProperty(n.prototype,"isEnabled",{get:function(){return this.enabledState===Fi.ENABLED},enumerable:!1,configurable:!0}),n.prototype._arrangeStat=function(){var e=[];this._collectRequestStat&&e.push.apply(e,c([],a(this.queue.filter((function(e){return e.type===be.API_RESULT||e.type===be.WEBSOCKET_CONNECT}))),!1)),this._collectFeatureLocalCacheStat&&e.push.apply(e,c([],a(this.queue.filter((function(e){return e.type===be.FEATURE_LOCALCACHE}))),!1)),this.queue=e},n.prototype._save=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return this.enabledState!==Fi.ENABLED?[3,2]:[4,this.cacheContext.preference.set(this.key,{deviceId:this.deviceId,statLogs:this.queue.map((function(e){return Te.payloadify(e)})),generation:this.generation++,lastFlushedAt:this.lastFlushedAt})];case 1:e.sent(),this.dispatch("save",c([],a(this.queue),!1)),e.label=2;case 2:return[2]}}))}))},n.prototype._flush=function(){return i(this,void 0,void 0,(function(){var e,t,n,r,i;return o(this,(function(o){switch(o.label){case 0:if(!this.isEnabled)return[3,10];if(this.isFlushing)return[3,10];this.isFlushing=!0,o.label=1;case 1:return o.trys.push([1,5,9,10]),this._arrangeStat(),e=this.queue.filter((function(e){if(e instanceof Hi){var t=new Date,n=a([e.date.getFullYear(),t.getFullYear()],2),r=n[0],i=n[1];if(r<i)return!0;if(r===i){var o=a([e.date.getMonth(),t.getMonth()],2),s=o[0],c=o[1];if(s<c)return!0;if(s===c){var u=a([e.date.getDate(),t.getDate()],2);return u[0]<u[1]}}}return!1})),t=this.queue.filter((function(e){return!(e instanceof Hi)})),(n=c(c([],a(e),!1),a(t),!1).slice(0,Math.min(this.limit,this.maxLimit))).length>0?(r=new Wi({deviceId:this.deviceId,statLogs:n}),[4,this.requestQueue.send(r)]):[3,4];case 2:return o.sent(),this.dispatch("flush",n),this.queue=c(c([],a(e),!1),a(t),!1).slice(n.length),[4,this._save()];case 3:o.sent(),o.label=4;case 4:return this.limit=this.baseLimit,this.lastFlushedAt=Date.now(),[3,10];case 5:return(i=o.sent())instanceof E?i.code!==u.STAT_LOG_NOT_ALLOWED?[3,7]:[4,this.clear()]:[3,8];case 6:return o.sent(),this.enabledState=Fi.DISABLED,[3,8];case 7:i.code===u.STAT_UPLOAD_NOT_ALLOWED&&(this.enabledState=Fi.COLLECT_ONLY),o.label=8;case 8:return this.limit=this.limit+20,[3,10];case 9:return this.isFlushing=!1,[7];case 10:return[2]}}))}))},n.prototype.init=function(e){return i(this,void 0,void 0,(function(){var t,n,r=this;return o(this,(function(i){switch(i.label){case 0:return this.key=e,[4,this.cacheContext.preference.get(this.key)];case 1:return(t=i.sent())?(this.deviceId=t.deviceId,this.queue=t.statLogs.map((function(e){return new Te({type:e.stat_type,ts:e.ts,data:e.data})})),this.generation=t.generation,this.lastFlushedAt=t.lastFlushedAt,Date.now()-this.lastFlushedAt>=108e5&&this.queue.length>=this.minLimit?(n=Math.min(Math.floor(18e4*Math.random()),100),[4,ai(n)]):[3,4]):[3,4];case 2:return i.sent(),[4,this._flush()];case 3:i.sent(),i.label=4;case 4:return this.commandEventContext||(this.commandEventContext=this.dispatcher.on((function(e){if(e instanceof ke){var t=e.statLog;r.put(t)}else if(e instanceof Bi){var n=e.request,i=e.features,o=e.options;r._collectRequestStat=n,r._collectFeatureLocalCacheStat=null==i?void 0:i.localCache,r._arrangeStat(),r._collectRequestStat||r._collectFeatureLocalCacheStat?r.enabledState=o.ingestion?Fi.ENABLED:Fi.COLLECT_ONLY:r.enabledState=Fi.DISABLED,r.isEnabled?r.queue.length>=r.limit&&r._flush():r.clear()}}))),[2]}}))}))},n.prototype.put=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return this.enabledState===Fi.DISABLED?[3,3]:(e instanceof Hi?this._collectFeatureLocalCacheStat&&(t=a(this.queue.filter((function(t){return t instanceof Hi&&t.key===e.key})),1),(n=t[0])?n.data=Qi(n.data,e.data):this.queue.push(e)):this._collectRequestStat&&this.queue.push(e),[4,this._save()]);case 1:return r.sent(),this.queue.length>=this.limit?[4,this._flush()]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},n.prototype.clear=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return this.queue=[],this.generation=1,[4,this._save()];case 1:return e.sent(),[2]}}))}))},n.prototype.close=function(){this.commandEventContext&&(this.commandEventContext.close(),this.commandEventContext=null)},n}(W);!function(e){e[e.NONE=0]="NONE",e[e.VERBOSE=1]="VERBOSE",e[e.DEBUG=2]="DEBUG",e[e.INFO=3]="INFO",e[e.WARN=4]="WARN",e[e.ERROR=5]="ERROR"}(Yi||(Yi={}));var Ji,$i=function(){function e(){this.level=Yi.WARN}return e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Yi.VERBOSE&&console.log.apply(console,c(["[verbose]"],a(e),!1))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Yi.DEBUG&&console.log.apply(console,c(["[debug]"],a(e),!1))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Yi.INFO&&console.log.apply(console,c(["[info]"],a(e),!1))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Yi.WARN&&console.warn.apply(console,c(["[warn]"],a(e),!1))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Yi.ERROR&&console.error.apply(console,c(["[error]"],a(e),!1))},e}(),eo={},to=function(){function e(e,t){var n,r,i,o,s,a,c,u,l,d;if(this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map,!eo[e]){eo[e]=this;var _=null!==(n=t.options)&&void 0!==n?n:new I,f=this.sdkState={appId:t.appId,appVersion:null!==(r=t.appVersion)&&void 0!==r?r:"",appState:"foreground",userId:null,extensions:{},api:{host:null!==(i=t.apiHost)&&void 0!==i?i:"https://api-".concat(t.appId,".sendbird.com")},websocket:{host:null!==(o=t.websocketHost)&&void 0!==o?o:"wss://ws-".concat(t.appId,".sendbird.com"),pingerDisabled:!!t.noPingpong,pingInterval:null,pongTimeout:null,connectMaxRetry:2,compression:!0,reconnectMaxRetry:-1,reconnectRetryStrategy:new ci,responseTimeout:_.websocketResponseTimeout},sessionTokenRefreshTimeout:_.sessionTokenRefreshTimeout};this.appInfo=null,this.subscribedUnreadMessageCount={all:0,customTypes:{},ts:0};var p=this.logger=new $i;this.logger.level=null!==(s=t.logLevel)&&void 0!==s?s:Yi.WARN,this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map;var g=this.cacheContext=new L({encryption:t.encryption,store:t.store,localCacheEnabled:null!==(a=t.localCacheEnabled)&&void 0!==a&&a,localCacheConfig:null!==(c=t.localCacheConfig)&&void 0!==c?c:new B});this.debugMode=null!==(u=t.debugMode)&&void 0!==u&&u,this.maxSuperGroupChannelUnreadCount=h.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL,this.useMemberInfoInMessage=_.useMemberInfoInMessage,this.typingIndicatorInvalidateTime=_.typingIndicatorInvalidateTime,this.typingIndicatorThrottle=_.typingIndicatorThrottle,this.concurrentCallLimit=null,this.backOffDelay=null;var v=this.dispatcher=new Q,E=new Z;this.requestQueue=new $r(e,{auth:E,sdkState:f,dispatcher:v,logger:p,useFetchCompat:t.useFetchCompat}),this.sessionManager=new _i({auth:E,cacheContext:g,sdkState:f,dispatcher:v,requestQueue:this.requestQueue,logger:p}),this.connectionManager=new Vi(e,{sdkState:f,cacheContext:this.cacheContext,connectionHandlers:this.connectionHandlers,dispatcher:v,sessionManager:this.sessionManager,websocketClient:this.requestQueue.commandRouter.websocketClient,disableWebSocketCloseEventHandling:null!==(l=t.disableWebSocketCloseEventHandling)&&void 0!==l&&l,logger:p}),this.statLogCollector=new Xi({cacheContext:this.cacheContext,requestQueue:this.requestQueue,dispatcher:v}),this.appStateToggleEnabled=null===(d=t.appStateToggleEnabled)||void 0===d||d}return eo[e]}return e.of=function(e){if(eo[e])return eo[e];throw E.lostInstance},e.clear=function(e){eo[e]&&delete eo[e]},e.prototype.hasExtension=function(e){return!!this.sdkState.extensions[e]},e}(),no=function(){function e(){}return e.prototype.init=function(e,t){var n=t.sdkState,r=t.dispatcher,i=t.sessionManager,o=t.requestQueue,s=t.logger;t.onlineDetector;var a=t.cacheContext,c=void 0===a?null:a;this._iid=e,this._cacheContext=c,this._sdkState=n,this._dispatcher=r,this._sessionManager=i,this._requestQueue=o,this._logger=s},e}();!function(e){e.OPEN="open",e.CLOSED="closed"}(Ji||(Ji={}));var ro,io="removed",oo=function(e){switch(e){case Ji.OPEN:return Ji.OPEN;case Ji.CLOSED:return Ji.CLOSED}},so=function(e){return!e||e.text&&w("string",e.text)},ao=function(e){return T("string",e)&&e.every((function(e){return""!==e.trim()}))},co=function(e){function r(t,n){var r,i,o,s,a,c,u,l=this;return(l=e.call(this,t)||this).pollId=0,l.id=0,l.text=null,l.voteCount=0,l.createdBy=null,l.createdAt=0,l.updatedAt=0,l._lastVotedAt=0,l.pollId=null!==(r=n.poll_id)&&void 0!==r?r:0,l.id=null!==(i=n.id)&&void 0!==i?i:0,l.text=null!==(o=n.text)&&void 0!==o?o:null,l.voteCount=null!==(s=n.vote_count)&&void 0!==s?s:0,l.createdBy=null!==(a=n.created_by)&&void 0!==a?a:null,l.createdAt=null!==(c=n.created_at)&&void 0!==c?c:0,l.updatedAt=null!==(u=n.updated_at)&&void 0!==u?u:0,l}return t(r,e),r.payloadify=function(t){return t?X(n(n({},e.payloadify.call(this,t)),{vote_count:t.voteCount,poll_id:t.pollId,text:t.text,created_at:t.createdAt,id:t.id,created_by:t.createdBy,updated_at:t.updatedAt})):null},r}(Ai),uo=function(e){function r(t,n){var r,i,o,s,a,c,u,l,h,d,_,f,p,g=this;return(g=e.call(this,t)||this).id=0,g.title=null,g.createdAt=0,g.updatedAt=0,g.closeAt=-1,g.status=Ji.CLOSED,g.messageId=0,g.data=null,g.voterCount=-1,g.options=[],g.createdBy=null,g.allowUserSuggestion=!1,g.allowMultipleVotes=!1,g.votedPollOptionIds=[],g.id=null!==(r=n.id)&&void 0!==r?r:0,g.title=null!==(i=n.title)&&void 0!==i?i:null,g.createdAt=null!==(o=n.created_at)&&void 0!==o?o:0,g.updatedAt=null!==(s=n.updated_at)&&void 0!==s?s:0,g.closeAt=null!==(a=n.close_at)&&void 0!==a?a:-1,g.status=null!==(c=oo(n.status))&&void 0!==c?c:Ji.CLOSED,g.messageId=null!==(u=n.message_id)&&void 0!==u?u:0,g.data=null!==(l=n.data)&&void 0!==l?l:null,g.voterCount=null!==(h=n.voter_count)&&void 0!==h?h:-1,g.options=n.options?n.options.map((function(e){return new co(g._iid,e)})):[],g.createdBy=null!==(d=n.created_by)&&void 0!==d?d:null,g.allowUserSuggestion=null!==(_=n.allow_user_suggestion)&&void 0!==_&&_,g.allowMultipleVotes=null!==(f=n.allow_multiple_votes)&&void 0!==f&&f,g.votedPollOptionIds=null!==(p=n.voted_option_ids)&&void 0!==p?p:[],g}return t(r,e),r.prototype._applyPollUpdatePayload=function(e){var t,n,r,i,o,s,a,c,u=this;this.title=null!==(t=e.title)&&void 0!==t?t:this.title,this.updatedAt=null!==(n=e.updated_at)&&void 0!==n?n:this.updatedAt,this.closeAt=null!==(r=e.close_at)&&void 0!==r?r:this.closeAt,this.status=null!==(i=oo(e.status))&&void 0!==i?i:this.status,this.data=null!==(o=e.data)&&void 0!==o?o:this.data,this.voterCount=null!==(s=e.voter_count)&&void 0!==s?s:this.voterCount,e.options&&(this.options=e.options.map((function(e){return new co(u._iid,e)})),this.votedPollOptionIds=e.options.filter((function(e){return e.vote_count>0})).map((function(e){return e.id}))),this.allowUserSuggestion=null!==(a=e.allow_user_suggestion)&&void 0!==a?a:this.allowUserSuggestion,this.allowMultipleVotes=null!==(c=e.allow_multiple_votes)&&void 0!==c?c:this.allowMultipleVotes},r.payloadify=function(t){return t?X(n(n({},e.payloadify.call(this,t)),{id:t.id,title:t.title,created_at:t.createdAt,updated_at:t.updatedAt,close_at:t.closeAt,status:t.status,message_id:t.messageId,data:t.data,voter_count:t.voterCount,options:t.options.map((function(e){return co.payloadify(e)})),created_by:t.createdBy,allow_user_suggestion:t.allowUserSuggestion,allow_multiple_votes:t.allowMultipleVotes,voted_option_ids:t.votedPollOptionIds})):null},r.prototype.applyPollUpdateEvent=function(e){var t=e._payload.poll;return!(!t||this.id!==t.id||t.updated_at<this.updatedAt)&&(this._applyPollUpdatePayload(t),!0)},r.prototype.applyPollVoteEvent=function(e){if(this.id!==e.pollId)return!1;var t=this.options,n=t.map((function(e){return e.id})),r=e._payload,i=Math.floor(r.ts/1e3);return r.updated_vote_counts.forEach((function(e){var r=n.indexOf(e.option_id);if(r>-1){var o=t[r];i>=o._lastVotedAt&&(o.voteCount=e.vote_count,o._lastVotedAt=i)}})),r.req_id&&r.voted_option_ids&&(this.votedPollOptionIds=r.voted_option_ids),!0},r.prototype.serialize=function(){return Pi(this)},r}(Ai);!function(e){e.UNKNOWN="UNKNOWN",e.EVENT_MESSAGE_SENT_SUCCESS="EVENT_MESSAGE_SENT_SUCCESS",e.EVENT_MESSAGE_SENT_FAILED="EVENT_MESSAGE_SENT_FAILED",e.EVENT_MESSAGE_SENT_PENDING="EVENT_MESSAGE_SENT_PENDING",e.EVENT_MESSAGE_RECEIVED="EVENT_MESSAGE_RECEIVED",e.EVENT_MESSAGE_UPDATED="EVENT_MESSAGE_UPDATED",e.EVENT_MESSAGE_DELETED="EVENT_MESSAGE_DELETED",e.EVENT_MESSAGE_READ="EVENT_MESSAGE_READ",e.EVENT_MESSAGE_DELIVERED="EVENT_MESSAGE_DELIVERED",e.EVENT_MESSAGE_REACTION_UPDATED="EVENT_MESSAGE_REACTION_UPDATED",e.EVENT_MESSAGE_THREADINFO_UPDATED="EVENT_MESSAGE_THREADINFO_UPDATED",e.EVENT_MESSAGE_OFFSET_UPDATED="EVENT_MESSAGE_OFFSET_UPDATED",e.REQUEST_MESSAGE="REQUEST_MESSAGE",e.EVENT_POLL_UPDATED="EVENT_POLL_UPDATED",e.EVENT_POLL_VOTED="EVENT_POLL_VOTED",e.SYNC_POLL_CHANGELOGS="SYNC_POLL_CHANGELOGS",e.REQUEST_RESEND_MESSAGE="REQUEST_RESEND_MESSAGE",e.REQUEST_THREADED_MESSAGE="REQUEST_THREADED_MESSAGE",e.REQUEST_MESSAGE_CHANGELOGS="REQUEST_MESSAGE_CHANGELOGS",e.SYNC_MESSAGE_FILL="SYNC_MESSAGE_FILL",e.SYNC_MESSAGE_BACKGROUND="SYNC_MESSAGE_BACKGROUND",e.SYNC_MESSAGE_CHANGELOGS="SYNC_MESSAGE_CHANGELOGS",e.LOCAL_MESSAGE_PENDING_CREATED="LOCAL_MESSAGE_PENDING_CREATED",e.LOCAL_MESSAGE_FAILED="LOCAL_MESSAGE_FAILED",e.LOCAL_MESSAGE_CANCELED="LOCAL_MESSAGE_CANCELED",e.LOCAL_MESSAGE_RESEND_STARTED="LOCAL_MESSAGE_RESEND_STARTED"}(ro||(ro={}));var lo=function(e){return e.startsWith("EVENT_")||e===ro.SYNC_MESSAGE_FILL||e===ro.SYNC_MESSAGE_CHANGELOGS||e===ro.SYNC_POLL_CHANGELOGS},ho=function(e){function n(t){var n=t.messages,r=t.source,i=e.call(this)||this;return i.messages=n,i.source=r,i}return t(n,e),n}(Y),_o=function(e){function n(t){var n=t.messageIds,r=t.source,i=e.call(this)||this;return i.messageIds=n,i.source=r,i}return t(n,e),n}(Y),fo=function(e){function n(t){var n=t.reqId,r=t.source,i=e.call(this)||this;return i.reqId=n,i.source=r,i}return t(n,e),n}(Y),po=function(e){function n(t){var n=t.polls,r=t.source,i=e.call(this)||this;return i.polls=n,i.source=r,i}return t(n,e),n}(Y),go=function(e){function n(t){var n=t.event,r=t.source,i=e.call(this)||this;return i.event=n,i.source=r,i}return t(n,e),n}(Y),vo=function(e){function n(t){var n=t.event,r=t.source,i=e.call(this)||this;return i.event=null,i.source=null,i.event=n,i.source=r,i}return t(n,e),n}(Y),Eo=function(){function e(e,t){var n;this._iid=null,this.limit=20,this._isLoading=!1,this._hasNext=!0,this._token="",this._iid=e,this.limit=null!==(n=t.limit)&&void 0!==n?n:20}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLoading",{get:function(){return this._isLoading},enumerable:!1,configurable:!0}),e.prototype._validate=function(){return w("number",this.limit)&&this.limit>0},e}(),bo=function(e){function n(t,n,r,i){var o=e.call(this,t,i)||this;return o.channelUrl=n,o.channelType=r,o}return t(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&w("string",this.channelUrl)&&S(x,this.channelType)},n}(Eo);export{Ai as $,J as A,Eo as B,Br as C,Gi as D,W as E,ji as F,Se as G,d as H,hi as I,s as J,S as K,B as L,_ as M,p as N,x as O,f as P,K as Q,Yi as R,E as S,M as T,qi as U,to as V,Ae as W,ki as X,Mi as Y,te as Z,t as _,w as a,y as a0,P as a1,Pi as a2,F as a3,j as a4,C as a5,U as a6,uo as a7,G as a8,Wr as a9,ve as aA,z as aB,v as aC,vo as aD,N as aE,go as aF,fo as aG,re as aH,he as aI,io as aJ,lo as aK,Hi as aL,be as aM,ui as aN,oo as aO,oe as aP,ie as aQ,fe as aa,ge as ab,u as ac,ai as ad,Yr as ae,q as af,ne as ag,ro as ah,ho as ai,_o as aj,se as ak,bo as al,no as am,co as an,Ji as ao,Y as ap,O as aq,R as ar,r as as,le as at,ao as au,so as av,po as aw,Ci as ax,pe as ay,ae as az,i as b,o as c,ee as d,X as e,me as f,n as g,ye as h,A as i,ue as j,ce as k,de as l,T as m,Ne as n,I as o,Ce as p,c as q,a as r,zi as s,Ui as t,V as u,l as v,Jr as w,Vr as x,li as y,Qr as z};
