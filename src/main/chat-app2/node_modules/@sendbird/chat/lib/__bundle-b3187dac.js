import{_ as t,A as n,at as e,f as o,a7 as s,h as l,an as a,aa as i,e as r,a as u,au as c,av as h,K as p,O as d,t as f,b as _,c as m,ah as v,s as g,S as I,g as w,aw as y,al as T,V as U,U as k}from"./__bundle-2cf2dbb7.js";var b=function(o){function s(t){var s=t.title,l=t.optionTexts,a=t.data,i=t.allowUserSuggestion,r=t.allowMultipleVotes,u=t.closeAt,c=o.call(this)||this;return c.method=n.POST,c.path=e,c.params={title:s,options:l,data:a,allow_user_suggestion:i,allow_multiple_votes:r,close_at:u},c}return t(s,o),s}(o),P=function(n){function e(t,e){var o=n.call(this,t,e)||this;return o.poll=new s(t,e),o}return t(e,n),e}(l),O=function(o){function s(t){var s=t.channelUrl,l=t.channelType,a=t.pollId,i=o.call(this)||this;return i.method=n.GET,i.path="".concat(e,"/").concat(encodeURIComponent(a)),i.params={channel_url:s,channel_type:l},i}return t(s,o),s}(o),x=function(n){function e(t,e){var o=n.call(this,t,e)||this;return o.poll=new s(t,e),o}return t(e,n),e}(l),q=function(o){function s(t){var s=t.channelUrl,l=t.channelType,a=t.pollId,i=t.pollOptionId,r=o.call(this)||this;return r.method=n.GET,r.path="".concat(e,"/").concat(encodeURIComponent(a),"/options/").concat(encodeURIComponent(i)),r.params={channel_url:s,channel_type:l},r}return t(s,o),s}(o),L=function(n){function e(t,e){var o=n.call(this,t,e)||this;return o.pollOption=new a(t,e),o}return t(e,n),e}(l),S=function(e){function o(t){var o=t.channelType,s=t.channelUrl,l=t.timestamp,a=t.token,u=e.call(this)||this;return u.method=n.GET,u.path="".concat(i(o),"/").concat(encodeURIComponent(s),"/polls/changelogs"),u.params=r({change_ts:l,token:a}),u}return t(o,e),o}(o),C=function(n){function e(t,e){var o=n.call(this,t,e)||this;return o.updatedPolls=e.updated.map((function(n){return function(t,n){return n?new s(t,n):null}(t,n)})),o.deletedPollIds=e.deleted.map((function(t){return t})),o.hasMore=e.has_more,o.nextToken=e.next,o}return t(e,n),e}(l),M={title:null,optionTexts:null,data:null,allowUserSuggestion:null,allowMultipleVotes:null,closeAt:-1},Q=function(t){return u("string",t.title)&&c(t.optionTexts)&&h(t.data)&&u("boolean",t.allowUserSuggestion,!0)&&u("boolean",t.allowMultipleVotes,!0)&&u("number",t.closeAt,!0)},G={channelUrl:null,channelType:null,pollId:null,pollOptionId:null},E=function(t){return u("string",t.channelUrl)&&p(d,t.channelType)&&u("number",t.pollId)&&u("number",t.pollOptionId)},N={channelUrl:null,channelType:null,pollId:null},R=function(t){return u("string",t.channelUrl)&&""!==t.channelUrl&&p(d,t.channelType)&&u("number",t.pollId)},A={},V=function(){function t(t,n){var e=n.sdkState,o=n.dispatcher,s=n.sessionManager,l=n.requestQueue,a=n.logger;this._iid=t,this._sdkState=e,this._sessionManager=s,this._requestQueue=l,this._dispatcher=o,this._logger=a,A[t]=this}return t.of=function(t){return A[t]},t.prototype.buildPollFromSerializedData=function(t){var n=f(t);return new s(this._iid,s.payloadify(n))},t.prototype.get=function(t){return _(this,void 0,void 0,(function(){var n,e;return m(this,(function(o){switch(o.label){case 0:return g(R(t)).throw(I.invalidParameters),n=new O(w({},t)),[4,this._requestQueue.send(n)];case 1:return e=o.sent(),[2,e.as(x).poll]}}))}))},t.prototype.create=function(t){return _(this,void 0,void 0,(function(){var n,e,o;return m(this,(function(s){switch(s.label){case 0:return g(Q(t)).throw(I.invalidParameters),n=t.data,e=new b(w(w({},t),{data:n})),[4,this._requestQueue.send(e)];case 1:return o=s.sent(),[2,o.as(P).poll]}}))}))},t.prototype.getOption=function(t){return _(this,void 0,void 0,(function(){var n,e;return m(this,(function(o){switch(o.label){case 0:return g(E(t)).throw(I.invalidParameters),n=new q(w({},t)),[4,this._requestQueue.send(n)];case 1:return e=o.sent(),[2,e.as(L).pollOption]}}))}))},t.prototype.getPollChangeLogs=function(t,n,e,o){return void 0===o&&(o=v.SYNC_POLL_CHANGELOGS),_(this,void 0,void 0,(function(){var s,l,a,i,u,c,h;return m(this,(function(p){switch(p.label){case 0:return s=new S(r({channelType:n,channelUrl:t,timestamp:"number"==typeof e?e:null,token:"string"==typeof e?e:null})),[4,this._requestQueue.send(s)];case 1:return l=p.sent(),a=l.as(C),i=a.updatedPolls,u=a.deletedPollIds,c=a.hasMore,h=a.nextToken,i.length>0&&this._dispatcher.dispatch(new y({polls:i,source:o})),[2,{updatedPolls:i,deletedPollIds:u,hasMore:c,token:h}]}}))}))},t}(),j=function(t,n){this.pollId=0,this.messageId=0,this.pollId=n.poll.id,this.messageId=n.poll.message_id,this._iid=t,this._payload=n},z=function(t){this.pollId=0,this.messageId=0,this.pollId=t.poll_id,this.messageId=t.message_id,this._payload=t},D=function(o){function s(t){var s=t.channelUrl,l=t.channelType,a=t.token,i=t.limit,r=o.call(this)||this;return r.method=n.GET,r.path=e,r.params={channel_url:s,channel_type:l,token:a,limit:i},r}return t(s,o),s}(o),F=function(n){function e(t,e){var o,l=this;return(l=n.call(this,t,e)||this).polls=(null!==(o=e.polls)&&void 0!==o?o:[]).map((function(n){return new s(t,n)})),l.token=e.next,l}return t(e,n),e}(l),H=function(n){function e(t,e){return n.call(this,t,e.channelUrl,e.channelType,e)||this}return t(e,n),e.prototype.next=function(){return _(this,void 0,void 0,(function(){var t,n,e,o,s,l;return m(this,(function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=U.of(this._iid).requestQueue,n=new D(w(w({},this),{token:this._token})),[4,t.send(n)]):[3,2]:[3,5];case 1:return e=a.sent(),o=e.as(F),s=o.polls,l=o.token,this._token=l,this._hasNext=!!l,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw I.queryInProgress;case 4:return[3,6];case 5:throw I.invalidParameters;case 6:return[2]}}))}))},e}(T),K=function(o){function s(t){var s=t.channelUrl,l=t.channelType,a=t.pollId,i=t.pollOptionId,r=t.token,u=t.limit,c=o.call(this)||this;return c.method=n.GET,c.path="".concat(e,"/").concat(encodeURIComponent(a),"/options/").concat(encodeURIComponent(i),"/voters"),c.params={channel_url:s,channel_type:l,token:r,limit:u},c}return t(s,o),s}(o),Y=function(n){function e(t,e){var o,s=this;return(s=n.call(this,t,e)||this).voters=(null!==(o=e.voters)&&void 0!==o?o:[]).map((function(n){return new k(t,n)})),s.token=e.next,s}return t(e,n),e}(l),B=function(n){function e(t,e){var o=n.call(this,t,e.channelUrl,e.channelType,e)||this;return o.pollId=e.pollId,o.pollOptionId=e.pollOptionId,o}return t(e,n),e.prototype._validate=function(){return n.prototype._validate.call(this)&&u("number",this.pollId)&&u("number",this.pollOptionId)},e.prototype.next=function(){return _(this,void 0,void 0,(function(){var t,n,e,o,s,l;return m(this,(function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=U.of(this._iid).requestQueue,n=new K(w(w({},this),{pollId:this.pollId,pollOptionId:this.pollOptionId,token:this._token})),[4,t.send(n)]):[3,2]:[3,5];case 1:return e=a.sent(),o=e.as(Y),s=o.voters,l=o.token,this._token=l,this._hasNext=!!l,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw I.queryInProgress;case 4:return[3,6];case 5:throw I.invalidParameters;case 6:return[2]}}))}))},e}(T);export{H as P,B as a,V as b,M as c,N as d,R as e,G as f,E as g,j as h,z as i,Q as v};
