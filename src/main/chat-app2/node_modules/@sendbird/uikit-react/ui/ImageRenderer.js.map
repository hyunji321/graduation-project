{"version":3,"file":"ImageRenderer.js","sources":["../../src/ui/ImageRenderer/index.tsx"],"sourcesContent":["import React, { useState, useMemo, ReactElement } from 'react';\n\nimport './index.scss';\n\n/*\n  ImageRenderer displays image with url or source\n  it checks if the source exist with img tag first\n  if it exists onLoad is called, if not onError is called\n  and those properties switch img tag to real purposing element\n*/\n\nexport interface ImageRendererProps {\n  className?: string | Array<string>;\n  url: string;\n  alt?: string;\n  width?: string | number;\n  height?: string | number;\n  circle?: boolean;\n  fixedSize?: boolean;\n  placeHolder?: ((props: { style: { [key: string]: string | number } }) => ReactElement) | ReactElement;\n  defaultComponent?: (() => ReactElement) | ReactElement;\n  onLoad?: () => void;\n  onError?: () => void;\n}\n\nconst ImageRenderer = ({\n  className = '',\n  url,\n  alt = '',\n  width = null,\n  height = null,\n  circle = false,\n  fixedSize = false,\n  placeHolder = null,\n  defaultComponent = null,\n  onLoad = () => { /* noop */ },\n  onError = () => { /* noop */ },\n}: ImageRendererProps): ReactElement => {\n  const [showDefaultComponent, setShowDefaultComponent] = useState(false);\n  const [showPlaceHolder, setShowPlaceHolder] = useState(true);\n\n  const DefaultComponent = useMemo(() => {\n    return typeof defaultComponent === 'function'\n      ? defaultComponent()\n      : defaultComponent;\n  }, [defaultComponent]);\n\n  const PlaceHolder = useMemo(() => {\n    return (placeHolder && typeof placeHolder === 'function')\n      ? placeHolder({\n        style: {\n          width: '100%',\n          minWidth: width,\n          maxWidth: fixedSize ? width : '400px',\n          height,\n          position: 'absolute',\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n        },\n      })\n      : null;\n  }, [placeHolder]);\n\n  const HiddenImageLoader = useMemo(() => {\n    setShowDefaultComponent(false);\n    // reset the state when url is changed\n    return (\n      <img\n        className=\"sendbird-image-renderer__hidden-image-loader\"\n        src={url}\n        alt={alt}\n        onLoad={() => {\n          setShowPlaceHolder(false);\n          onLoad();\n        }}\n        onError={() => {\n          setShowDefaultComponent(true);\n          onError();\n        }}\n      />\n    );\n  }, [url]);\n\n  return (\n    <div\n      className={[\n        ...(Array.isArray(className) ? className : [className]),\n        'sendbird-image-renderer',\n      ].join(' ')}\n      style={{\n        width: '100%',\n        minWidth: width,\n        maxWidth: fixedSize ? width : '400px',\n        height,\n      }}\n    >\n      {showPlaceHolder && PlaceHolder}\n      {\n        showDefaultComponent\n          ? DefaultComponent\n          : (\n            <div\n              className=\"sendbird-image-renderer__image\"\n              style={{\n                width: '100%',\n                minWidth: width,\n                maxWidth: fixedSize ? width : '400px',\n                height,\n                position: 'absolute',\n                backgroundRepeat: 'no-repeat',\n                backgroundPosition: 'center',\n                backgroundSize: 'cover',\n                backgroundImage: `url(${url})`,\n                borderRadius: circle ? '50%' : null,\n              }}\n            />\n          )\n      }\n      {HiddenImageLoader}\n    </div>\n  );\n};\n\nexport default ImageRenderer;\n"],"names":["ImageRenderer","_ref","className","url","alt","width","height","circle","fixedSize","placeHolder","defaultComponent","onLoad","onError","showDefaultComponent","setShowDefaultComponent","useState","showPlaceHolder","setShowPlaceHolder","DefaultComponent","useMemo","PlaceHolder","style","minWidth","maxWidth","position","display","justifyContent","alignItems","HiddenImageLoader","React","createElement","src","Array","isArray","join","backgroundRepeat","backgroundPosition","backgroundSize","backgroundImage","borderRadius"],"mappings":"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"}