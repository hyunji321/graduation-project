{"version":3,"file":"TypingIndicator.js","sources":["../../../src/modules/Channel/components/TypingIndicator.tsx"],"sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\nimport {\n  GroupChannelHandler,\n  Member,\n  SendbirdGroupChat,\n} from '@sendbird/chat/groupChannel';\n\nimport { LocalizationContext } from '../../../lib/LocalizationContext';\nimport { uuidv4 } from '../../../utils/uuid';\nimport Label, { LabelTypography, LabelColors } from '../../../ui/Label';\nimport { useChannelContext } from '../context/ChannelProvider';\nimport useSendbirdStateContext from '../../../hooks/useSendbirdStateContext';\n\nexport interface TypingIndicatorTextProps {\n  members: Member[];\n}\n\nexport const TypingIndicatorText: React.FC<TypingIndicatorTextProps> = ({ members }: TypingIndicatorTextProps) => {\n  const { stringSet } = useContext(LocalizationContext);\n  if (!members || members.length === 0) {\n    return '';\n  }\n\n  if (members && members.length === 1) {\n    return `${members[0].nickname} ${stringSet.TYPING_INDICATOR__IS_TYPING}`;\n  }\n\n  if (members && members.length === 2) {\n    return `${members[0].nickname} ${stringSet.TYPING_INDICATOR__AND} ${members[1].nickname} ${stringSet.TYPING_INDICATOR__ARE_TYPING}`;\n  }\n\n  return stringSet.TYPING_INDICATOR__MULTIPLE_TYPING;\n};\n\nconst TypingIndicator: React.FC = () => {\n  const { channelUrl } = useChannelContext();\n  const globalStore = useSendbirdStateContext();\n  const sb = globalStore?.stores?.sdkStore?.sdk as SendbirdGroupChat;\n  const logger = globalStore?.config?.logger;\n  const [handlerId, setHandlerId] = useState(uuidv4());\n  const [typingMembers, setTypingMembers] = useState<Member[]>([]);\n\n  useEffect(() => {\n    if (sb?.groupChannel?.addGroupChannelHandler) {\n      sb.groupChannel.removeGroupChannelHandler(handlerId);\n      const newHandlerId = uuidv4();\n      const handler = new GroupChannelHandler({\n        onTypingStatusUpdated: (groupChannel) => {\n          // there is a possible warning in here - setState called after unmount\n          logger.info('Channel > Typing Indicator: onTypingStatusUpdated', groupChannel);\n          if (groupChannel.url === channelUrl) {\n            const members = groupChannel.getTypingUsers();\n            setTypingMembers(members);\n          }\n        },\n      });\n      sb.groupChannel.addGroupChannelHandler(newHandlerId, handler);\n      setHandlerId(newHandlerId);\n    }\n\n    return () => {\n      setTypingMembers([]);\n      if (sb?.groupChannel?.removeGroupChannelHandler) {\n        sb.groupChannel.removeGroupChannelHandler(handlerId);\n      }\n    };\n  }, [channelUrl]);\n\n  return (\n    <Label\n      className=\"sendbird-conversation__footer__typing-indicator__text\"\n      type={LabelTypography.CAPTION_2}\n      color={LabelColors.ONBACKGROUND_2}\n    >\n      <TypingIndicatorText members={typingMembers} />\n    </Label>\n  );\n};\n\nexport default TypingIndicator;\n"],"names":["TypingIndicatorText","_ref","members","stringSet","useContext","LocalizationContext","length","nickname","TYPING_INDICATOR__IS_TYPING","TYPING_INDICATOR__AND","TYPING_INDICATOR__ARE_TYPING","TYPING_INDICATOR__MULTIPLE_TYPING","TypingIndicator","_globalStore$stores","_globalStore$stores$s","_globalStore$config","channelUrl","useChannelContext","globalStore","useSendbirdStateContext","sb","stores","sdkStore","sdk","logger","config","handlerId","setHandlerId","useState","uuidv4","typingMembers","setTypingMembers","useEffect","_sb$groupChannel","groupChannel","addGroupChannelHandler","removeGroupChannelHandler","newHandlerId","handler","GroupChannelHandler","onTypingStatusUpdated","info","url","getTypingUsers","_sb$groupChannel2","React","createElement","Label","className","type","LabelTypography","CAPTION_2","color","LabelColors","ONBACKGROUND_2"],"mappings":"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"}