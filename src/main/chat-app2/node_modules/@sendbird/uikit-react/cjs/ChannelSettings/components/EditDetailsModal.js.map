{"version":3,"file":"EditDetailsModal.js","sources":["../../../../src/modules/ChannelSettings/components/EditDetailsModal/index.tsx"],"sourcesContent":["import React, { useState, useRef, useContext } from 'react';\n\nimport { useChannelSettingsContext } from '../../context/ChannelSettingsProvider';\nimport { LocalizationContext } from '../../../../lib/LocalizationContext';\nimport useSendbirdStateContext from '../../../../hooks/useSendbirdStateContext';\n\nimport Modal from '../../../../ui/Modal';\nimport Input, { InputLabel } from '../../../../ui/Input';\nimport Avatar from '../../../../ui/Avatar/index';\nimport { ButtonTypes } from '../../../../ui/Button';\nimport Label, { LabelColors, LabelTypography } from '../../../../ui/Label';\nimport TextButton from '../../../../ui/TextButton';\nimport ChannelAvatar from '../../../../ui/ChannelAvatar/index';\nimport uuidv4 from '../../../../utils/uuid';\n\nexport type EditDetailsProps = {\n  onSubmit: () => void;\n  onCancel: () => void;\n};\n\nconst EditDetails: React.FC<EditDetailsProps> = (props: EditDetailsProps) => {\n  const {\n    onSubmit,\n    onCancel,\n  } = props;\n\n  const {\n    channel,\n    onChannelModified,\n    onBeforeUpdateChannel,\n    setChannelUpdateId,\n  } = useChannelSettingsContext();\n  const title = channel?.name;\n\n  const state = useSendbirdStateContext();\n  const userId = state?.config?.userId;\n  const theme = state?.config?.theme;\n  const logger = state?.config?.logger;\n\n  const inputRef = useRef(null);\n  const formRef = useRef(null);\n  const hiddenInputRef = useRef(null);\n  const [currentImg, setCurrentImg] = useState(null);\n  const [newFile, setNewFile] = useState(null);\n  const { stringSet } = useContext(LocalizationContext);\n\n  return (\n    <Modal\n      isFullScreenOnMobile\n      titleText={stringSet.MODAL__CHANNEL_INFORMATION__TITLE}\n      submitText={stringSet.BUTTON__SAVE}\n      onCancel={onCancel}\n      onSubmit={() => {\n        if (title !== '' && !inputRef.current.value) {\n          if (formRef.current.reportValidity) { // might not work in explorer\n            formRef.current.reportValidity();\n          }\n          return;\n        }\n\n        const currentTitle = inputRef.current.value;\n        const currentImg = newFile;\n        logger.info('ChannelSettings: Channel information being updated', {\n          currentTitle,\n          currentImg,\n        });\n        if (onBeforeUpdateChannel) {\n          logger.info('ChannelSettings: onBeforeUpdateChannel');\n          const params = onBeforeUpdateChannel(currentTitle, currentImg, channel?.data);\n          channel?.updateChannel(params).then((groupChannel) => {\n            onChannelModified?.(groupChannel);\n            setChannelUpdateId(uuidv4());\n            onSubmit();\n          });\n        } else {\n          logger.info('ChannelSettings: normal');\n          channel?.updateChannel({\n            coverImage: currentImg,\n            name: currentTitle,\n            data: channel?.data || '',\n          }).then((groupChannel) => {\n            logger.info('ChannelSettings: Channel information updated', groupChannel);\n            onChannelModified?.(groupChannel);\n            setChannelUpdateId(uuidv4());\n            onSubmit();\n          });\n        }\n      }}\n      type={ButtonTypes.PRIMARY}\n    >\n      <form\n        className=\"channel-profile-form\"\n        ref={formRef}\n        onSubmit={(e) => { e.preventDefault(); }}\n      >\n        <div className=\"channel-profile-form__img-section\">\n          <InputLabel>\n            {stringSet.MODAL__CHANNEL_INFORMATION__CHANNEL_IMAGE}\n          </InputLabel>\n          <div className=\"channel-profile-form__avatar\">\n            {\n              currentImg\n                ? (\n                  <Avatar\n                    height=\"80px\"\n                    width=\"80px\"\n                    src={currentImg}\n                  />\n                ) : (\n                  <ChannelAvatar\n                    height={80}\n                    width={80}\n                    channel={channel}\n                    userId={userId}\n                    theme={theme}\n                  />\n                )\n              }\n          </div>\n          <input\n            ref={hiddenInputRef}\n            type=\"file\"\n            accept=\"image/gif, image/jpeg, image/png\"\n            style={{ display: 'none' }}\n            onChange={(e) => {\n              setCurrentImg(URL.createObjectURL(e.target.files[0]));\n              setNewFile(e.target.files[0]);\n              hiddenInputRef.current.value = '';\n            }}\n          />\n          <TextButton\n            className=\"channel-profile-form__avatar-button\"\n            onClick={() => hiddenInputRef.current.click()}\n            disableUnderline\n          >\n            <Label type={LabelTypography.BUTTON_1} color={LabelColors.PRIMARY}>\n              {stringSet.MODAL__CHANNEL_INFORMATION__UPLOAD}\n            </Label>\n          </TextButton>\n        </div>\n        <div className=\"channel-profile-form__name-section\">\n          <InputLabel>\n            {stringSet.MODAL__CHANNEL_INFORMATION__CHANNEL_NAME}\n          </InputLabel>\n          <Input\n            required={title !== ''}\n            name=\"channel-profile-form__name\"\n            ref={inputRef}\n            value={title}\n            placeHolder={stringSet.MODAL__CHANNEL_INFORMATION__INPUT__PLACE_HOLDER}\n          />\n        </div>\n      </form>\n    </Modal>\n  );\n};\n\nexport default EditDetails;\n"],"names":["EditDetails","props","_state$config","_state$config2","_state$config3","onSubmit","onCancel","channel","onChannelModified","onBeforeUpdateChannel","setChannelUpdateId","useChannelSettingsContext","title","name","state","useSendbirdStateContext","userId","config","theme","logger","inputRef","useRef","formRef","hiddenInputRef","currentImg","setCurrentImg","useState","newFile","setNewFile","stringSet","useContext","LocalizationContext","React","createElement","Modal","isFullScreenOnMobile","titleText","MODAL__CHANNEL_INFORMATION__TITLE","submitText","BUTTON__SAVE","current","value","reportValidity","currentTitle","info","params","data","updateChannel","then","groupChannel","uuidv4","coverImage","type","ButtonTypes","PRIMARY","className","ref","e","preventDefault","InputLabel","MODAL__CHANNEL_INFORMATION__CHANNEL_IMAGE","Avatar","height","width","src","ChannelAvatar","accept","style","display","onChange","URL","createObjectURL","target","files","TextButton","onClick","click","disableUnderline","Label","LabelTypography","BUTTON_1","color","LabelColors","MODAL__CHANNEL_INFORMATION__UPLOAD","MODAL__CHANNEL_INFORMATION__CHANNEL_NAME","Input","required","placeHolder","MODAL__CHANNEL_INFORMATION__INPUT__PLACE_HOLDER"],"mappings":"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"}