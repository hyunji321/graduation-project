{"version":3,"file":"OGMessageItemBody.js","sources":["../../../src/ui/OGMessageItemBody/index.tsx"],"sourcesContent":["import './index.scss';\nimport React, {\n  ReactElement,\n  useContext,\n  useMemo,\n  useRef,\n} from 'react';\nimport type { UserMessage } from '@sendbird/chat/message';\n\nimport ImageRenderer from '../ImageRenderer';\nimport Icon, { IconTypes } from '../Icon';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport { getClassName, isEditedMessage } from '../../utils';\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport TextFragment from '../../modules/Message/components/TextFragment';\nimport { tokenizeMessage } from '../../modules/Message/utils/tokens/tokenize';\nimport { OG_MESSAGE_BODY_CLASSNAME } from './consts';\n\ninterface Props {\n  className?: string | Array<string>;\n  message: UserMessage;\n  isByMe?: boolean;\n  mouseHover?: boolean;\n  isMentionEnabled?: boolean;\n  isReactionEnabled?: boolean;\n  onMessageHeightChange?: () => void;\n}\n\nexport default function OGMessageItemBody({\n  className,\n  message,\n  isByMe = false,\n  mouseHover = false,\n  isMentionEnabled = false,\n  isReactionEnabled = false,\n  onMessageHeightChange = () => { /* noop */ },\n}: Props): ReactElement {\n  const imageRef = useRef<HTMLDivElement>(null);\n  const { stringSet } = useContext(LocalizationContext);\n  const openOGUrl = (): void => {\n    if (message?.ogMetaData?.url) window.open(message?.ogMetaData?.url);\n  };\n  const isMessageMentioned = isMentionEnabled && message?.mentionedMessageTemplate?.length > 0 && message?.mentionedUsers?.length > 0;\n  const tokens = useMemo(() => {\n    if (isMessageMentioned) {\n      return tokenizeMessage({\n        mentionedUsers: message?.mentionedUsers,\n        messageText: message?.mentionedMessageTemplate,\n      });\n    }\n    return tokenizeMessage({\n      messageText: message?.message,\n    });\n  }, [message?.updatedAt]);\n  return (\n    <div className={getClassName([\n      className,\n      'sendbird-og-message-item-body',\n      isByMe ? 'outgoing' : 'incoming',\n      mouseHover ? 'mouse-hover' : '',\n      (isReactionEnabled && message?.reactions?.length > 0) ? 'reactions' : '',\n    ])}>\n      <Label\n        type={LabelTypography.BODY_1}\n        color={isByMe ? LabelColors.ONCONTENT_1 : LabelColors.ONBACKGROUND_1}\n      >\n        <div className={OG_MESSAGE_BODY_CLASSNAME}>\n          <TextFragment tokens={tokens} />\n          {\n            isEditedMessage(message) && (\n              <Label\n                className=\"sendbird-og-message-item-body__text-bubble__message\"\n                type={LabelTypography.BODY_1}\n                color={isByMe ? LabelColors.ONCONTENT_2 : LabelColors.ONBACKGROUND_2}\n              >\n                {` ${stringSet.MESSAGE_EDITED} `}\n              </Label>\n            )\n          }\n        </div>\n      </Label>\n      <div\n        ref={imageRef}\n        className={`sendbird-og-message-item-body__og-thumbnail\n          ${message?.ogMetaData?.defaultImage?.url ? '' : 'sendbird-og-message-item-body__og-thumbnail__empty'}\n        `}\n        onClick={openOGUrl}\n      >\n        <ImageRenderer\n          onLoad={onMessageHeightChange}\n          onError={() => {\n            try {\n              imageRef?.current?.classList?.add('sendbird-og-message-item-body__og-thumbnail__empty');\n            } catch (error) {\n              // do nothing\n            }\n          }}\n          className=\"sendbird-og-message-item-body__og-thumbnail__image\"\n          url={message?.ogMetaData?.defaultImage?.url || ''}\n          alt={message?.ogMetaData?.defaultImage?.alt}\n          // TODO: Change fixing width and height lengths\n          defaultComponent={(\n            <div className=\"sendbird-og-message-item-body__og-thumbnail__place-holder\">\n              <Icon\n                className=\"sendbird-og-message-item-body__og-thumbnail__place-holder__icon\"\n                type={IconTypes.THUMBNAIL_NONE}\n                width=\"56px\"\n                height=\"56px\"\n              />\n            </div>\n          )}\n        />\n      </div>\n      <div\n        className=\"sendbird-og-message-item-body__description\"\n        onClick={openOGUrl}\n      >\n        {message?.ogMetaData?.title && (\n          <Label\n            className=\"sendbird-og-message-item-body__description__title\"\n            type={LabelTypography.SUBTITLE_2}\n            color={LabelColors.ONBACKGROUND_1}\n          >\n            {message.ogMetaData.title}\n          </Label>\n        )}\n        {message?.ogMetaData?.description && (\n          <Label\n            className=\"sendbird-og-message-item-body__description__description\"\n            type={LabelTypography.BODY_2}\n            color={LabelColors.ONBACKGROUND_1}\n          >\n            {message.ogMetaData.description}\n          </Label>\n        )}\n        {message?.ogMetaData?.url && (\n          <Label\n            className=\"sendbird-og-message-item-body__description__url\"\n            type={LabelTypography.CAPTION_3}\n            color={LabelColors.ONBACKGROUND_2}\n          >\n            {message.ogMetaData.url}\n          </Label>\n        )}\n      </div>\n      <div className=\"sendbird-og-message-item-body__cover\" />\n    </div>\n  );\n}\n"],"names":["OGMessageItemBody","_ref","_message$mentionedMes","_message$mentionedUse","_message$reactions","_message$ogMetaData3","_message$ogMetaData3$","_message$ogMetaData4","_message$ogMetaData4$","_message$ogMetaData5","_message$ogMetaData5$","_message$ogMetaData6","_message$ogMetaData7","_message$ogMetaData8","className","message","isByMe","mouseHover","isMentionEnabled","isReactionEnabled","onMessageHeightChange","imageRef","useRef","stringSet","useContext","LocalizationContext","openOGUrl","_message$ogMetaData","_message$ogMetaData2","ogMetaData","url","window","open","isMessageMentioned","mentionedMessageTemplate","length","mentionedUsers","tokens","useMemo","tokenizeMessage","messageText","updatedAt","React","createElement","getClassName","reactions","Label","type","LabelTypography","BODY_1","color","LabelColors","ONCONTENT_1","ONBACKGROUND_1","OG_MESSAGE_BODY_CLASSNAME","TextFragment","isEditedMessage","ONCONTENT_2","ONBACKGROUND_2","MESSAGE_EDITED","ref","defaultImage","onClick","ImageRenderer","onLoad","onError","_imageRef$current","_imageRef$current$cla","current","classList","add","error","alt","defaultComponent","Icon","IconTypes","THUMBNAIL_NONE","width","height","title","SUBTITLE_2","description","BODY_2","CAPTION_3"],"mappings":"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"}