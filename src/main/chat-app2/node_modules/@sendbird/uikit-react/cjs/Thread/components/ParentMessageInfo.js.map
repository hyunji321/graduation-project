{"version":3,"file":"ParentMessageInfo.js","sources":["../../../../src/modules/Thread/components/ParentMessageInfo/index.tsx"],"sourcesContent":["import React, { useContext, useEffect, useRef, useState } from 'react';\nimport format from 'date-fns/format';\nimport { FileMessage, UserMessage } from '@sendbird/chat/message';\n\nimport './index.scss';\nimport RemoveMessage from '../RemoveMessageModal';\nimport ParentMessageInfoItem from './ParentMessageInfoItem';\n\nimport { getSenderName } from '../../../../utils';\nimport { getIsReactionEnabled } from '../../../../utils/getIsReactionEnabled';\nimport { useLocalization } from '../../../../lib/LocalizationContext';\nimport useSendbirdStateContext from '../../../../hooks/useSendbirdStateContext';\nimport { useThreadContext } from '../../context/ThreadProvider';\nimport { UserProfileContext } from '../../../../lib/UserProfileContext';\nimport SuggestedMentionList from '../../../Channel/components/SuggestedMentionList';\n\nimport Avatar from '../../../../ui/Avatar';\nimport Label, { LabelTypography, LabelColors } from '../../../../ui/Label';\nimport FileViewer from '../../../../ui/FileViewer';\nimport MessageItemMenu from '../../../../ui/MessageItemMenu';\nimport MessageItemReactionMenu from '../../../../ui/MessageItemReactionMenu';\nimport ContextMenu, { MenuItems } from '../../../../ui/ContextMenu';\nimport ConnectedUserProfile from '../../../../ui/UserProfile';\nimport { UserProfileContextInterface } from '../../../../ui/MessageContent';\nimport MessageInput from '../../../../ui/MessageInput';\nimport { MessageInputKeys } from '../../../../ui/MessageInput/const';\nimport { Role } from '../../../../lib/types';\nimport { useMediaQueryContext } from '../../../../lib/MediaQueryContext';\nimport useLongPress from '../../../../hooks/useLongPress';\nimport MobileMenu from '../../../../ui/MobileMenu';\nimport { useDirtyGetMentions } from '../../../Message/hooks/useDirtyGetMentions';\n\nexport interface ParentMessageInfoProps {\n  className?: string;\n}\n\nexport default function ParentMessageInfo({\n  className,\n}: ParentMessageInfoProps): React.ReactElement {\n  const { stores, config } = useSendbirdStateContext();\n  const {\n    isMentionEnabled,\n    isReactionEnabled,\n    replyType,\n    isOnline,\n    userMention,\n    logger,\n  } = config;\n  const userId = stores.userStore.user?.userId ?? '';\n  const { dateLocale } = useLocalization();\n  const {\n    currentChannel,\n    parentMessage,\n    allThreadMessages,\n    emojiContainer,\n    toggleReaction,\n    updateMessage,\n    deleteMessage,\n    onMoveToParentMessage,\n    onHeaderActionClick,\n    isMuted,\n    isChannelFrozen,\n  } = useThreadContext();\n  const { isMobile } = useMediaQueryContext();\n\n  const [showRemove, setShowRemove] = useState(false);\n  const [supposedHover, setSupposedHover] = useState(false);\n  const [showFileViewer, setShowFileViewer] = useState(false);\n  const usingReaction = getIsReactionEnabled({\n    globalLevel: isReactionEnabled,\n    isSuper: currentChannel.isSuper,\n    isBroadcast: currentChannel.isBroadcast,\n  });\n  const isByMe = userId === parentMessage.sender.userId;\n\n  // Mobile\n  const mobileMenuRef = useRef(null);\n  const [showMobileMenu, setShowMobileMenu] = useState(false);\n  const longPress = useLongPress({\n    onLongPress: () => {\n      if (isMobile) {\n        setShowMobileMenu(true);\n      }\n    },\n  }, {\n    shouldPreventDefault: false,\n  });\n\n  // Edit message\n  const [showEditInput, setShowEditInput] = useState(false);\n  const disabled = !isOnline || isMuted || isChannelFrozen && !(currentChannel?.myRole === Role.OPERATOR);\n\n  // Mention\n  const editMessageInputRef = useRef(null);\n  const [mentionNickname, setMentionNickname] = useState('');\n  const [mentionedUsers, setMentionedUsers] = useState([]);\n  const [mentionedUserIds, setMentionedUserIds] = useState([]);\n  const [messageInputEvent, setMessageInputEvent] = useState(null);\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [mentionSuggestedUsers, setMentionSuggestedUsers] = useState([]);\n  const displaySuggestedMentionList = isOnline\n    && isMentionEnabled\n    && mentionNickname.length > 0\n    && !isMuted\n    && !(isChannelFrozen && !(currentChannel.myRole === Role.OPERATOR));\n\n  const mentionNodes = useDirtyGetMentions({ ref: editMessageInputRef }, { logger });\n  const ableMention = mentionNodes?.length < userMention?.maxMentionCount;\n\n  useEffect(() => {\n    setMentionedUsers(mentionedUsers.filter(({ userId }) => {\n      const i = mentionedUserIds.indexOf(userId);\n      if (i < 0) {\n        return false;\n      } else {\n        mentionedUserIds.splice(i, 1);\n        return true;\n      }\n    }));\n  }, [mentionedUserIds]);\n\n  // User Profile\n  const avatarRef = useRef(null);\n  const {\n    disableUserProfile,\n    renderUserProfile,\n  } = useContext<UserProfileContextInterface>(UserProfileContext);\n\n  if (showEditInput && parentMessage?.isUserMessage?.()) {\n    return (\n      <>\n        {\n          displaySuggestedMentionList && (\n            <SuggestedMentionList\n              className=\"parent-message-info--suggested-mention-list\"\n              targetNickname={mentionNickname}\n              inputEvent={messageInputEvent}\n              // renderUserMentionItem={renderUserMentionItem}\n              onUserItemClick={(user) => {\n                if (user) {\n                  setMentionedUsers([...mentionedUsers, user]);\n                }\n                setMentionNickname('');\n                setSelectedUser(user);\n                setMessageInputEvent(null);\n              }}\n              onFocusItemChange={() => {\n                setMessageInputEvent(null);\n              }}\n              onFetchUsers={(users) => {\n                setMentionSuggestedUsers(users);\n              }}\n              ableAddMention={ableMention}\n              maxMentionCount={userMention?.maxMentionCount}\n              maxSuggestionCount={userMention?.maxSuggestionCount}\n            />\n          )\n        }\n        <MessageInput\n          isEdit\n          disabled={disabled}\n          ref={editMessageInputRef}\n          mentionSelectedUser={selectedUser}\n          isMentionEnabled={isMentionEnabled}\n          message={parentMessage}\n          onStartTyping={() => {\n            currentChannel?.startTyping?.();\n          }}\n          onUpdateMessage={({ messageId, message, mentionTemplate }) => {\n            updateMessage({\n              messageId,\n              message,\n              mentionedUsers,\n              mentionTemplate,\n            });\n            setShowEditInput(false);\n            currentChannel?.endTyping?.();\n          }}\n          onCancelEdit={() => {\n            setMentionNickname('');\n            setMentionedUsers([]);\n            setMentionedUserIds([]);\n            setMentionSuggestedUsers([]);\n            setShowEditInput(false);\n            currentChannel?.endTyping?.();\n          }}\n          onUserMentioned={(user) => {\n            if (selectedUser?.userId === user?.userId) {\n              setSelectedUser(null);\n              setMentionNickname('');\n            }\n          }}\n          onMentionStringChange={(mentionText) => {\n            setMentionNickname(mentionText);\n          }}\n          onMentionedUserIdsUpdated={(userIds) => {\n            setMentionedUserIds(userIds);\n          }}\n          onKeyDown={(e) => {\n            if (displaySuggestedMentionList && mentionSuggestedUsers?.length > 0\n              && ((e.key === MessageInputKeys.Enter && ableMention) || e.key === MessageInputKeys.ArrowUp || e.key === MessageInputKeys.ArrowDown)\n            ) {\n              setMessageInputEvent(e);\n              return true;\n            }\n            return false;\n          }}\n        />\n      </>\n    );\n  }\n\n  return (\n    <div\n      className={`sendbird-parent-message-info ${className}`}\n      {...(isMobile) ? { ...longPress } : {}}\n      ref={mobileMenuRef}\n    >\n      <ContextMenu\n        menuTrigger={(toggleDropdown) => (\n          <Avatar\n            className=\"sendbird-parent-message-info__sender\"\n            ref={avatarRef}\n            src={\n              currentChannel?.members?.find((m) => m?.userId === parentMessage?.sender?.userId)?.profileUrl\n              || parentMessage?.sender?.profileUrl\n            }\n            alt=\"thread message sender\"\n            width=\"40px\"\n            height=\"40px\"\n            onClick={() => {\n              if (!disableUserProfile) {\n                toggleDropdown();\n              }\n            }}\n          />\n        )}\n        menuItems={(closeDropdown) => (\n          <MenuItems\n            parentRef={avatarRef}\n            parentContainRef={avatarRef}\n            closeDropdown={closeDropdown}\n            style={{ paddingTop: '0px', paddingBottom: '0px' }}\n          >\n            {renderUserProfile\n              ? renderUserProfile({ user: parentMessage?.sender, close: closeDropdown })\n              : (\n                <ConnectedUserProfile\n                  user={parentMessage?.sender}\n                  currentUserId={userId}\n                  onSuccess={closeDropdown}\n                />\n              )}\n          </MenuItems>\n        )}\n      />\n      <div className=\"sendbird-parent-message-info__content\">\n        <div className=\"sendbird-parent-message-info__content__info\">\n          <Label\n            className={`sendbird-parent-message-info__content__info__sender-name${usingReaction ? '--use-reaction' : ''}`}\n            type={LabelTypography.CAPTION_2}\n            color={LabelColors.ONBACKGROUND_2}\n          >\n            {\n              currentChannel?.members?.find((member) => member?.userId === parentMessage?.sender?.userId)\n                ?.nickname || getSenderName?.(parentMessage as UserMessage | FileMessage)\n            }\n          </Label>\n          <Label\n            className=\"sendbird-parent-message-info__content__info__sent-at\"\n            type={LabelTypography.CAPTION_3}\n            color={LabelColors.ONBACKGROUND_2}\n          >\n            {format(parentMessage?.createdAt || 0, 'p', { locale: dateLocale })}\n          </Label>\n        </div>\n        {/* message content body */}\n        <ParentMessageInfoItem\n          message={parentMessage}\n          showFileViewer={setShowFileViewer}\n        />\n      </div>\n      {/* context menu */}\n      {!isMobile && (\n        <MessageItemMenu\n          className={`sendbird-parent-message-info__context-menu ${usingReaction ? 'use-reaction' : ''} ${supposedHover ? 'sendbird-mouse-hover' : ''}`}\n          channel={currentChannel}\n          message={parentMessage}\n          isByMe={userId === parentMessage?.sender?.userId}\n          disableDeleteMessage={allThreadMessages.length > 0}\n          replyType={replyType}\n          showEdit={setShowEditInput}\n          showRemove={setShowRemove}\n          setSupposedHover={setSupposedHover}\n          onMoveToParentMessage={() => {\n            onMoveToParentMessage({ message: parentMessage, channel: currentChannel });\n          }}\n        />\n      )}\n      {(usingReaction && !isMobile) && (\n        <MessageItemReactionMenu\n          className={`sendbird-parent-message-info__reaction-menu ${supposedHover ? 'sendbird-mouse-hover' : ''}`}\n          message={parentMessage}\n          userId={userId}\n          emojiContainer={emojiContainer}\n          toggleReaction={toggleReaction}\n          setSupposedHover={setSupposedHover}\n        />\n      )}\n      {showRemove && (\n        <RemoveMessage\n          onCancel={() => setShowRemove(false)}\n          onSubmit={() => {\n            onHeaderActionClick?.();\n          }}\n          message={parentMessage}\n        />\n      )}\n      {showFileViewer && (\n        <FileViewer\n          message={parentMessage as FileMessage}\n          onClose={() => setShowFileViewer(false)}\n          onDelete={() => {\n            deleteMessage(parentMessage)\n              .then(() => {\n                setShowFileViewer(false);\n              });\n          }}\n        />\n      )}\n      {showMobileMenu && (\n        <MobileMenu\n          parentRef={mobileMenuRef}\n          channel={currentChannel}\n          message={parentMessage}\n          userId={userId}\n          replyType={replyType}\n          hideMenu={() => {\n            setShowMobileMenu(false);\n          }}\n          isReactionEnabled={usingReaction}\n          isByMe={isByMe}\n          emojiContainer={emojiContainer}\n          showEdit={setShowEditInput}\n          showRemove={setShowRemove}\n          toggleReaction={toggleReaction}\n          isOpenedFromThread\n        />\n      )}\n    </div>\n  );\n}\n"],"names":["ParentMessageInfo","_ref","_stores$userStore$use","_stores$userStore$use2","_parentMessage$isUser","_currentChannel$membe3","_currentChannel$membe4","_parentMessage$sender4","className","stores","config","useSendbirdStateContext","isMentionEnabled","isReactionEnabled","replyType","isOnline","userMention","logger","userId","userStore","user","dateLocale","useLocalization","currentChannel","parentMessage","allThreadMessages","emojiContainer","toggleReaction","updateMessage","deleteMessage","onMoveToParentMessage","onHeaderActionClick","isMuted","isChannelFrozen","useThreadContext","isMobile","useMediaQueryContext","showRemove","setShowRemove","useState","supposedHover","setSupposedHover","showFileViewer","setShowFileViewer","usingReaction","getIsReactionEnabled","globalLevel","isSuper","isBroadcast","isByMe","sender","mobileMenuRef","useRef","showMobileMenu","setShowMobileMenu","longPress","useLongPress","onLongPress","shouldPreventDefault","showEditInput","setShowEditInput","disabled","myRole","Role","OPERATOR","editMessageInputRef","mentionNickname","setMentionNickname","mentionedUsers","setMentionedUsers","mentionedUserIds","setMentionedUserIds","messageInputEvent","setMessageInputEvent","selectedUser","setSelectedUser","mentionSuggestedUsers","setMentionSuggestedUsers","displaySuggestedMentionList","length","mentionNodes","useDirtyGetMentions","ref","ableMention","maxMentionCount","useEffect","filter","_ref2","i","indexOf","splice","avatarRef","disableUserProfile","renderUserProfile","useContext","UserProfileContext","isUserMessage","call","React","createElement","Fragment","SuggestedMentionList","targetNickname","inputEvent","onUserItemClick","onFocusItemChange","onFetchUsers","users","ableAddMention","maxSuggestionCount","MessageInput","isEdit","mentionSelectedUser","message","onStartTyping","_currentChannel$start","startTyping","onUpdateMessage","_ref3","_currentChannel$endTy","messageId","mentionTemplate","endTyping","onCancelEdit","_currentChannel$endTy2","onUserMentioned","onMentionStringChange","mentionText","onMentionedUserIdsUpdated","userIds","onKeyDown","e","key","MessageInputKeys","Enter","ArrowUp","ArrowDown","_extends","_objectSpread","ContextMenu","menuTrigger","toggleDropdown","_currentChannel$membe","_currentChannel$membe2","_parentMessage$sender2","Avatar","src","members","find","m","_parentMessage$sender","profileUrl","alt","width","height","onClick","menuItems","closeDropdown","MenuItems","parentRef","parentContainRef","style","paddingTop","paddingBottom","close","ConnectedUserProfile","currentUserId","onSuccess","Label","type","LabelTypography","CAPTION_2","color","LabelColors","ONBACKGROUND_2","member","_parentMessage$sender3","nickname","getSenderName","CAPTION_3","format","createdAt","locale","ParentMessageInfoItem","MessageItemMenu","channel","disableDeleteMessage","showEdit","MessageItemReactionMenu","RemoveMessage","onCancel","onSubmit","FileViewer","onClose","onDelete","then","MobileMenu","hideMenu","isOpenedFromThread"],"mappings":"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"}